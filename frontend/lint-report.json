[{"filePath":"D:\\Software\\Create\\Shop\\frontend\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\postcss.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\App.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Accounting\\ChartOfAccounts.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Accounting\\JournalEntry.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\AddExpenseModal.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'useEffect' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":1,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":36,"suggestions":[{"messageId":"removeVar","data":{"varName":"useEffect"},"fix":{"range":[24,35],"text":""},"desc":"Remove unused variable 'useEffect'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { X } from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\nimport api from '../utils/api';\r\n\r\nconst AddExpenseModal = ({ isOpen, onClose, onSuccess }) => {\r\n    const [name, setName] = useState('');\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        setLoading(true);\r\n\r\n        try {\r\n            if (!name) {\r\n                setLoading(false);\r\n                return toast.error('Please enter an expense name');\r\n            }\r\n\r\n            // Create Expense Head (Supplier with type 'Expense')\r\n            await api.post('/suppliers', {\r\n                name,\r\n                type: 'Expense',\r\n                phone: '0000000000', // Dummy phone\r\n            });\r\n\r\n            toast.success('Expense Head Added Successfully');\r\n            if (onSuccess) onSuccess();\r\n            onClose();\r\n            setName('');\r\n\r\n        } catch (error) {\r\n            console.error(error);\r\n            toast.error(error.response?.data?.message || 'Failed to add expense head');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 backdrop-blur-sm\">\r\n            <div className=\"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full border border-gray-100 dark:border-gray-700 animate-scale-in\">\r\n                {/* Header */}\r\n                <div className=\"p-6 border-b-[2.5px] border-black dark:border-white/90 flex items-center justify-between\">\r\n                    <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\r\n                        Add Expense Head\r\n                    </h2>\r\n                    <button\r\n                        onClick={onClose}\r\n                        className=\"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors text-gray-500 dark:text-gray-400\"\r\n                    >\r\n                        <X className=\"w-6 h-6\" />\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Body */}\r\n                <form onSubmit={handleSubmit} className=\"p-6 space-y-4\">\r\n\r\n                    {/* Expense Name */}\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                            Expense Name *\r\n                        </label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={name}\r\n                            onChange={(e) => setName(e.target.value)}\r\n                            className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white outline-none\"\r\n                            placeholder=\"e.g. Office Rent\"\r\n                            autoFocus\r\n                        />\r\n                    </div>\r\n\r\n                    {/* Footer Actions */}\r\n                    <div className=\"flex items-center justify-end space-x-3 pt-4 border-t-[2.5px] border-black dark:border-white/90\">\r\n                        <button\r\n                            type=\"button\"\r\n                            onClick={onClose}\r\n                            className=\"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-gray-700 dark:text-gray-300\"\r\n                        >\r\n                            Cancel\r\n                        </button>\r\n                        <button\r\n                            type=\"submit\"\r\n                            disabled={loading}\r\n                            className=\"px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 font-bold shadow-lg\"\r\n                        >\r\n                            {loading ? 'Adding...' : 'Add Expense'}\r\n                        </button>\r\n                    </div>\r\n\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default AddExpenseModal;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\AdjustBalanceModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\AuthorizeView.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\CategoryManagementModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\ConfirmationModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\DashboardStats.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'Icon' is defined but never used.","line":45,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":45,"endColumn":49,"suggestions":[{"messageId":"removeVar","data":{"varName":"Icon"},"fix":{"range":[1388,1400],"text":""},"desc":"Remove unused variable 'Icon'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Wallet, Building2, Package, RefreshCcw, ArrowUpRight, ArrowDownRight } from 'lucide-react';\r\nimport api from '../utils/api';\r\n\r\nimport MoneyAdjustmentModal from './MoneyAdjustmentModal';\r\n\r\nconst DashboardStats = () => {\r\n    const [stats, setStats] = useState({\r\n        cashInHand: 0,\r\n        cashInBank: 0,\r\n        productValue: 0\r\n    });\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState(null);\r\n    const [showMoneyModal, setShowMoneyModal] = useState(false);\r\n\r\n    const fetchStats = async () => {\r\n        try {\r\n            setLoading(true);\r\n            setError(null);\r\n            const response = await api.get('/reports/dashboard-summary');\r\n            setStats(response.data);\r\n        } catch (error) {\r\n            console.error('Error fetching dashboard stats:', error);\r\n            setError('Failed to load data');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        fetchStats();\r\n    }, []);\r\n\r\n    const formatCurrency = (amount) => {\r\n        const value = Number(amount) || 0;\r\n        return new Intl.NumberFormat('en-IN', {\r\n            style: 'currency',\r\n            currency: 'INR',\r\n            maximumFractionDigits: 0\r\n        }).format(value);\r\n    };\r\n\r\n    const StatCard = ({ title, value, icon: Icon, colorClass, borderClass, bgClass, showAddButton }) => (\r\n        <div className={`relative overflow-hidden rounded-2xl border ${borderClass} ${bgClass} p-6 transition-all duration-300 hover:shadow-lg group`}>\r\n            {/* Background Icon */}\r\n            <div className=\"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity\">\r\n                <Icon size={64} />\r\n            </div>\r\n\r\n            {/* Content */}\r\n            <div className=\"relative z-10\">\r\n                <div className=\"flex justify-between items-start mb-4\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <div className={`p-3 rounded-xl ${colorClass} bg-white/90 shadow-sm`}>\r\n                            <Icon size={24} />\r\n                        </div>\r\n                        <h3 className=\"text-sm font-semibold text-gray-500 uppercase tracking-wider\">{title}</h3>\r\n                    </div>\r\n                    {showAddButton && (\r\n                        <button\r\n                            onClick={() => setShowMoneyModal(true)}\r\n                            className=\"flex items-center gap-2 bg-white/80 hover:bg-white text-gray-700 hover:text-green-600 px-3 py-1.5 rounded-lg shadow-sm border border-gray-100 transition-all transform hover:scale-105\"\r\n                            title=\"Add/Withdraw Money\"\r\n                        >\r\n                            <ArrowUpRight className=\"w-4 h-4\" />\r\n                            <span className=\"text-xs font-bold uppercase\">Add Money</span>\r\n                        </button>\r\n                    )}\r\n                </div>\r\n\r\n                <div className=\"flex items-end gap-2\">\r\n                    <h2 className=\"text-3xl font-bold text-gray-900 dark:text-white\">\r\n                        {loading ? (\r\n                            <div className=\"h-9 w-32 bg-gray-200 dark:bg-gray-700 animate-pulse rounded\"></div>\r\n                        ) : error ? (\r\n                            <span className=\"text-sm text-red-500\">Error loading data</span>\r\n                        ) : (\r\n                            formatCurrency(value)\r\n                        )}\r\n                    </h2>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    return (\r\n        <>\r\n            {/* TEMP DEBUG DISPLAY */}\r\n            <div className=\"bg-black text-green-400 p-2 text-xs font-mono mb-4 rounded overflow-auto hidden\">\r\n                JSON Data: {JSON.stringify(stats)}\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\r\n                <StatCard\r\n                    title=\"Cash In Hand\"\r\n                    value={stats.cashInHand}\r\n                    icon={Wallet}\r\n                    colorClass=\"text-emerald-600\"\r\n                    borderClass=\"border-emerald-100 dark:border-emerald-900/30\"\r\n                    bgClass=\"bg-gradient-to-br from-emerald-50 to-white dark:from-emerald-900/10 dark:to-gray-900\"\r\n                    showAddButton={true}\r\n                />\r\n\r\n                <StatCard\r\n                    title=\"Cash In Bank\"\r\n                    value={stats.cashInBank}\r\n                    icon={Building2}\r\n                    colorClass=\"text-blue-600\"\r\n                    borderClass=\"border-blue-100 dark:border-blue-900/30\"\r\n                    bgClass=\"bg-gradient-to-br from-blue-50 to-white dark:from-blue-900/10 dark:to-gray-900\"\r\n                    showAddButton={true}\r\n                />\r\n\r\n                <StatCard\r\n                    title=\"Total Stock Value\"\r\n                    value={stats.productValue}\r\n                    icon={Package}\r\n                    colorClass=\"text-violet-600\"\r\n                    borderClass=\"border-violet-100 dark:border-violet-900/30\"\r\n                    bgClass=\"bg-gradient-to-br from-violet-50 to-white dark:from-violet-900/10 dark:to-gray-900\"\r\n                />\r\n            </div>\r\n\r\n            <MoneyAdjustmentModal\r\n                isOpen={showMoneyModal}\r\n                onClose={() => setShowMoneyModal(false)}\r\n                onSuccess={fetchStats}\r\n            />\r\n        </>\r\n    );\r\n};\r\n\r\nexport default DashboardStats;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\ErrorBoundary.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":9,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":42,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[244,249],"text":""},"desc":"Remove unused variable 'error'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\n\r\nclass ErrorBoundary extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = { hasError: false, error: null, errorInfo: null };\r\n    }\r\n\r\n    static getDerivedStateFromError(error) {\r\n        return { hasError: true };\r\n    }\r\n\r\n    componentDidCatch(error, errorInfo) {\r\n        this.setState({ error, errorInfo });\r\n        console.error(\"Uncaught error:\", error, errorInfo);\r\n    }\r\n\r\n    render() {\r\n        if (this.state.hasError) {\r\n            return (\r\n                <div className=\"p-8 bg-red-50 text-red-900 border border-red-200 rounded-lg m-4\">\r\n                    <h2 className=\"text-2xl font-bold mb-4\">Something went wrong.</h2>\r\n                    <details className=\"whitespace-pre-wrap\">\r\n                        <summary className=\"cursor-pointer font-semibold mb-2\">View Error Details</summary>\r\n                        {this.state.error && this.state.error.toString()}\r\n                        <br />\r\n                        {this.state.errorInfo && this.state.errorInfo.componentStack}\r\n                    </details>\r\n                    <button\r\n                        onClick={() => window.location.reload()}\r\n                        className=\"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700\"\r\n                    >\r\n                        Reload Page\r\n                    </button>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return this.props.children;\r\n    }\r\n}\r\n\r\nexport default ErrorBoundary;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Inventory\\CategoryFolderView.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Inventory\\ImportModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Invoice\\InvoiceItemRow.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Invoice\\InvoiceTemplates.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Invoice\\ShareInvoiceModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Invoice\\templateList.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Invoice\\templates\\ArcticTemplate.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Invoice\\templates\\BurgundyTemplate.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Invoice\\templates\\CarbonTemplate.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Invoice\\templates\\ClassicTemplate.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Invoice\\templates\\EarthTemplate.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Invoice\\templates\\EmeraldTemplate.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Invoice\\templates\\GradientTemplate.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Invoice\\templates\\LavenderTemplate.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Invoice\\templates\\MidnightTemplate.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Invoice\\templates\\MinimalTemplate.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Invoice\\templates\\NeonTemplate.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Invoice\\templates\\OceanTemplate.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Invoice\\templates\\RoseGoldTemplate.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Invoice\\templates\\RoyalBlueTemplate.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Invoice\\templates\\SunsetTemplate.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Layout\\DeviceModal.jsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchDevices'. Either include it or remove the dependency array.","line":26,"column":8,"nodeType":"ArrayExpression","endLine":26,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [fetchDevices]","fix":{"range":[1015,1017],"text":"[fetchDevices]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Monitor, Smartphone, X, LogOut, Trash2, Loader2, ShieldCheck } from 'lucide-react';\r\nimport api from '../../utils/api';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst DeviceIcon = ({ name }) => {\r\n    const isMobile = name?.toLowerCase().includes('android') || name?.toLowerCase().includes('iphone');\r\n    return isMobile\r\n        ? <Smartphone className=\"w-5 h-5 text-amber-400\" />\r\n        : <Monitor className=\"w-5 h-5 text-amber-400\" />;\r\n};\r\n\r\nconst formatDate = (date) => {\r\n    if (!date) return '';\r\n    return new Date(date).toLocaleDateString('en-IN', { day: '2-digit', month: 'short', year: 'numeric' });\r\n};\r\n\r\nconst DeviceModal = ({ onClose, onLogoutCurrent }) => {\r\n    const [devices, setDevices] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [removing, setRemoving] = useState(null);\r\n    const currentDeviceId = localStorage.getItem('deviceId');\r\n\r\n    useEffect(() => {\r\n        fetchDevices();\r\n    }, []);\r\n\r\n    const fetchDevices = async () => {\r\n        try {\r\n            const { data } = await api.get('/auth/devices', {\r\n                headers: { 'x-device-id': currentDeviceId }\r\n            });\r\n            setDevices(data);\r\n        } catch {\r\n            toast.error('Could not load devices');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleRemove = async (deviceId, isCurrent) => {\r\n        if (isCurrent) {\r\n            // Logging out current device = full logout\r\n            onClose();\r\n            onLogoutCurrent();\r\n            return;\r\n        }\r\n        setRemoving(deviceId);\r\n        try {\r\n            await api.delete(`/auth/devices/${deviceId}`);\r\n            setDevices(prev => prev.filter(d => d.id !== deviceId));\r\n            toast.success('Device removed');\r\n        } catch {\r\n            toast.error('Failed to remove device');\r\n        } finally {\r\n            setRemoving(null);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 z-[100] flex items-center justify-center p-4\" onClick={onClose}>\r\n            <div className=\"absolute inset-0 bg-black/70 backdrop-blur-sm\" />\r\n            <div\r\n                className=\"relative w-full max-w-md bg-zinc-900 border border-amber-500/20 rounded-2xl shadow-2xl overflow-hidden\"\r\n                onClick={e => e.stopPropagation()}\r\n            >\r\n                {/* Header */}\r\n                <div className=\"flex items-center justify-between p-5 border-b border-white/10\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <div className=\"p-2 bg-amber-500/10 rounded-xl\">\r\n                            <ShieldCheck className=\"w-5 h-5 text-amber-400\" />\r\n                        </div>\r\n                        <div>\r\n                            <h2 className=\"text-white font-bold text-base\">Trusted Devices</h2>\r\n                            <p className=\"text-gray-500 text-xs\">Select a device to log out from</p>\r\n                        </div>\r\n                    </div>\r\n                    <button onClick={onClose} className=\"p-1.5 rounded-lg hover:bg-white/10 text-gray-400 hover:text-white transition-colors\">\r\n                        <X className=\"w-4 h-4\" />\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Device List */}\r\n                <div className=\"p-4 space-y-2 max-h-80 overflow-y-auto\">\r\n                    {loading ? (\r\n                        <div className=\"flex items-center justify-center py-8 text-gray-400\">\r\n                            <Loader2 className=\"w-5 h-5 animate-spin mr-2\" />\r\n                            <span className=\"text-sm\">Loading devices...</span>\r\n                        </div>\r\n                    ) : devices.length === 0 ? (\r\n                        <p className=\"text-center text-gray-500 text-sm py-8\">No trusted devices found</p>\r\n                    ) : (\r\n                        devices.map(device => (\r\n                            <div\r\n                                key={device.id}\r\n                                className={`flex items-center gap-3 p-3 rounded-xl border transition-all ${device.isCurrent\r\n                                        ? 'bg-amber-500/10 border-amber-500/30'\r\n                                        : 'bg-white/5 border-white/10 hover:border-white/20'\r\n                                    }`}\r\n                            >\r\n                                <DeviceIcon name={device.name} />\r\n                                <div className=\"flex-1 min-w-0\">\r\n                                    <p className=\"text-white text-sm font-medium truncate\">\r\n                                        {device.name || 'Unknown Device'}\r\n                                        {device.isCurrent && (\r\n                                            <span className=\"ml-2 text-[10px] bg-amber-500/20 text-amber-400 px-1.5 py-0.5 rounded-full font-bold uppercase tracking-wide\">\r\n                                                This device\r\n                                            </span>\r\n                                        )}\r\n                                    </p>\r\n                                    <p className=\"text-gray-500 text-xs\">Trusted on {formatDate(device.addedAt)}</p>\r\n                                </div>\r\n                                <button\r\n                                    onClick={() => handleRemove(device.id, device.isCurrent)}\r\n                                    disabled={removing === device.id}\r\n                                    className={`flex items-center gap-1.5 text-xs font-semibold px-3 py-1.5 rounded-lg transition-all ${device.isCurrent\r\n                                            ? 'bg-red-500/20 text-red-400 hover:bg-red-500/30 border border-red-500/30'\r\n                                            : 'bg-white/5 text-gray-400 hover:bg-red-500/20 hover:text-red-400 border border-white/10'\r\n                                        }`}\r\n                                >\r\n                                    {removing === device.id ? (\r\n                                        <Loader2 className=\"w-3 h-3 animate-spin\" />\r\n                                    ) : device.isCurrent ? (\r\n                                        <><LogOut className=\"w-3 h-3\" /> Logout</>\r\n                                    ) : (\r\n                                        <><Trash2 className=\"w-3 h-3\" /> Remove</>\r\n                                    )}\r\n                                </button>\r\n                            </div>\r\n                        ))\r\n                    )}\r\n                </div>\r\n\r\n                {/* Footer */}\r\n                <div className=\"p-4 border-t border-white/10 flex gap-2\">\r\n                    <button\r\n                        onClick={onClose}\r\n                        className=\"flex-1 py-2.5 rounded-xl text-sm font-semibold text-gray-400 hover:text-white border border-white/10 hover:border-white/20 transition-all\"\r\n                    >\r\n                        Cancel\r\n                    </button>\r\n                    <button\r\n                        onClick={() => { onClose(); onLogoutCurrent(); }}\r\n                        className=\"flex-1 py-2.5 rounded-xl text-sm font-bold text-white bg-red-500/80 hover:bg-red-500 transition-all\"\r\n                    >\r\n                        Logout This Device\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default DeviceModal;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Layout\\Layout.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Layout\\Sidebar.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'isAdmin' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":33,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":33,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"isAdmin"},"fix":{"range":[780,789],"text":""},"desc":"Remove unused variable 'isAdmin'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { NavLink, useNavigate } from 'react-router-dom';\r\nimport { useAuth } from '../../context/AuthContext';\r\nimport { useSettings } from '../../context/SettingsContext';\r\nimport {\r\n    LayoutDashboard,\r\n    Package,\r\n    FileText,\r\n    Users,\r\n    TruckIcon,\r\n    BookOpen,\r\n    Settings,\r\n    LogOut,\r\n    User,\r\n    Eye,\r\n    EyeOff,\r\n    ScrollText,\r\n    Sun,\r\n    Moon,\r\n    Monitor,\r\n    IndianRupee,\r\n    Library,\r\n    Calculator,\r\n    TrendingUp,\r\n    Scale,\r\n    PieChart\r\n} from 'lucide-react';\r\nimport { useClientView } from '../../context/ClientViewContext.jsx';\r\nimport { BACKEND_URL } from '../../utils/api';\r\nimport DeviceModal from './DeviceModal';\r\n\r\nconst Sidebar = ({ isOpen, onClose }) => {\r\n    const { user, logout, isAdmin } = useAuth();\r\n    const { settings, theme, toggleTheme } = useSettings();\r\n    const { isClientView, toggleClientView } = useClientView();\r\n    const navigate = useNavigate();\r\n\r\n    const [showDeviceModal, setShowDeviceModal] = useState(false);\r\n\r\n    const handleLogout = () => {\r\n        logout();\r\n        navigate('/login');\r\n    };\r\n\r\n    const navItems = [\r\n        { name: 'Dashboard', icon: LayoutDashboard, path: '/dashboard', roles: ['Admin', 'Accountant', 'Salesman'] },\r\n        { name: 'Daybook', icon: BookOpen, path: '/daybook', roles: ['Admin', 'Accountant'] },\r\n        { name: 'New Invoice', icon: FileText, path: '/invoice/new', roles: ['Admin', 'Accountant', 'Salesman'] },\r\n        { name: 'Invoice History', icon: BookOpen, path: '/invoices', roles: ['Admin', 'Accountant', 'Salesman'] },\r\n        { name: 'Customers', icon: Users, path: '/customers', roles: ['Admin', 'Accountant', 'Salesman'] },\r\n        { name: 'Suppliers', icon: TruckIcon, path: '/suppliers', roles: ['Admin', 'Accountant', 'Salesman'] },\r\n        { name: 'Expenses', icon: IndianRupee, path: '/expenses', roles: ['Admin', 'Accountant'] },\r\n        { name: 'Inventory', icon: Package, path: '/inventory', roles: ['Admin', 'Accountant', 'Salesman'] },\r\n        { name: 'Letterheads', icon: ScrollText, path: '/letterheads', roles: ['Admin'] },\r\n\r\n\r\n\r\n\r\n\r\n        { name: 'Cash & Bank', icon: Library, path: '/cash-bank', roles: ['Admin', 'Accountant'] },\r\n        { name: 'Settings', icon: Settings, path: '/settings', roles: ['Admin'] },\r\n    ];\r\n\r\n    const filteredNav = navItems.filter(item => user && item.roles.includes(user.role));\r\n\r\n    return (\r\n        <>\r\n            {showDeviceModal && (\r\n                <DeviceModal\r\n                    onClose={() => setShowDeviceModal(false)}\r\n                    onLogoutCurrent={handleLogout}\r\n                />\r\n            )}\r\n            <aside className={`\r\n            fixed inset-y-0 left-0 z-50 w-72 md:w-64 backdrop-blur-xl border-r border-brand-500/20 dark:border-brand-500/30\r\n            transform transition-transform duration-300 ease-out h-screen flex flex-col shadow-2xl md:shadow-none\r\n            md:translate-x-0 md:sticky md:top-0 md:inset-auto md:h-screen\r\n            ${isOpen ? 'translate-x-0' : '-translate-x-full'}\r\n            ${settings?.sidebarStyle === 'glass' ? 'bg-white/40 dark:bg-black/40 backdrop-blur-2xl border-white/20 dark:border-white/10' :\r\n                    settings?.sidebarStyle === 'minimal' ? 'bg-white/95 dark:bg-black/95 backdrop-blur-xl md:bg-transparent md:border-transparent md:shadow-none md:backdrop-blur-none' :\r\n                        'bg-white/95 dark:bg-black/95 backdrop-blur-xl md:bg-white/50 md:dark:bg-black/50'}\r\n        `}>\r\n                {/* Logo & Brand */}\r\n                <div className=\"p-6 border-b border-brand-500/40 dark:border-brand-500/30 relative overflow-hidden\">\r\n                    {/* Gold Glow Effect */}\r\n                    <div className=\"absolute top-0 right-0 w-32 h-32 bg-brand-500/10 blur-3xl rounded-full -translate-y-1/2 translate-x-1/2 pointer-events-none\"></div>\r\n\r\n                    <div className=\"flex items-center space-x-3 relative z-10\">\r\n                        {settings?.logo && (\r\n                            <div className=\"p-1 rounded-xl bg-gradient-to-br from-brand-300 to-brand-600 shadow-gold\">\r\n                                <img src={settings.logo.startsWith('http') ? settings.logo : `${BACKEND_URL}${settings.logo}`} alt=\"Logo\" className=\"w-8 h-8 object-contain bg-black rounded-lg\" />\r\n                            </div>\r\n                        )}\r\n                        <div>\r\n                            <h1 className=\"text-xl font-bold text-gray-900 dark:text-white tracking-tight\">\r\n                                {settings?.shopName || 'Sharogis Digital'}\r\n                            </h1>\r\n                            <p className=\"text-[10px] uppercase tracking-widest text-brand-600 dark:text-brand-400 font-semibold\">{settings?.tagline || 'Inventory & Billing'}</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Navigation */}\r\n                <nav className=\"flex-1 px-3 py-6 space-y-1 overflow-y-auto\">\r\n                    {filteredNav.map((item) => (\r\n                        <NavLink\r\n                            key={item.path}\r\n                            to={item.path}\r\n                            onClick={() => window.innerWidth < 768 && onClose && onClose()}\r\n                            className={({ isActive }) =>\r\n                                `flex items-center space-x-3 px-4 py-3 rounded-xl transition-all duration-200 group relative overflow-hidden ${isActive\r\n                                    ? 'text-white bg-gradient-to-r from-brand-800 to-brand-900 shadow-lg border border-brand-500/20'\r\n                                    : 'text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-white/5 hover:text-gray-900 dark:hover:text-white'\r\n                                }`\r\n                            }\r\n                        >\r\n                            {({ isActive }) => (\r\n                                <>\r\n                                    {isActive && (\r\n                                        <div className=\"absolute inset-0 bg-brand-500/5 mr-auto w-full h-full z-0\"></div>\r\n                                    )}\r\n                                    <item.icon className={`w-5 h-5 relative z-10 transition-transform group-hover:scale-110 ${isActive ? 'text-brand-400' : 'text-gray-400 group-hover:text-brand-500'}`} />\r\n                                    <span className={`relative z-10 ${isActive ? 'font-semibold' : 'font-medium'}`}>{item.name}</span>\r\n                                    {isActive && (\r\n                                        <div className=\"absolute right-0 top-1/2 -translate-y-1/2 w-1 h-8 bg-brand-500 rounded-l-full shadow-[0_0_10px_rgba(212,175,55,0.8)]\"></div>\r\n                                    )}\r\n                                </>\r\n                            )}\r\n                        </NavLink>\r\n                    ))}\r\n                </nav>\r\n\r\n                {/* Bottom Actions */}\r\n                <div className=\"p-4 border-t border-brand-500/40 dark:border-brand-500/30 space-y-2 bg-gray-50/50 dark:bg-black/20\">\r\n                    {/* Theme Toggle */}\r\n                    <button\r\n                        onClick={toggleTheme}\r\n                        className=\"w-full flex items-center justify-between px-4 py-3 rounded-xl transition-colors border bg-white dark:bg-white/5 border-brand-500/40 dark:border-brand-500/30 text-gray-700 dark:text-gray-200 hover:border-brand-500/50\"\r\n                    >\r\n                        <div className=\"flex items-center space-x-3\">\r\n                            {theme === 'dark' ? (\r\n                                <div className=\"p-1.5 rounded-lg bg-gray-800 text-brand-400\">\r\n                                    <Moon className=\"w-4 h-4\" />\r\n                                </div>\r\n                            ) : theme === 'light' ? (\r\n                                <div className=\"p-1.5 rounded-lg bg-orange-100 text-orange-500\">\r\n                                    <Sun className=\"w-4 h-4\" />\r\n                                </div>\r\n                            ) : (\r\n                                <div className=\"p-1.5 rounded-lg bg-blue-100 text-blue-500\">\r\n                                    <Monitor className=\"w-4 h-4\" />\r\n                                </div>\r\n                            )}\r\n                            <span className=\"font-medium text-sm\">Theme</span>\r\n                        </div>\r\n                        <span className=\"text-xs text-brand-600 dark:text-brand-500 font-mono uppercase tracking-wider\">{theme}</span>\r\n                    </button>\r\n\r\n                    {/* Client View Toggle */}\r\n                    <button\r\n                        onClick={toggleClientView}\r\n                        className={`w-full flex items-center justify-between px-4 py-3 rounded-xl transition-all border ${isClientView\r\n                            ? 'bg-brand-900/20 border-brand-500/50 text-brand-600 dark:text-brand-400'\r\n                            : 'bg-white dark:bg-white/5 border-brand-500/40 dark:border-brand-500/30 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-white/10'\r\n                            }`}\r\n                    >\r\n                        <div className=\"flex items-center space-x-3\">\r\n                            {isClientView ? <EyeOff className=\"w-4 h-4\" /> : <Eye className=\"w-4 h-4\" />}\r\n                            <span className=\"font-medium text-sm\">Client View</span>\r\n                        </div>\r\n                        <div className={`w-8 h-4 rounded-full relative transition-colors ${isClientView ? 'bg-brand-500' : 'bg-gray-300 dark:bg-gray-600'}`}>\r\n                            <div className={`absolute top-0.5 w-3 h-3 bg-white rounded-full transition-transform shadow-sm ${isClientView ? 'left-[18px]' : 'left-0.5'}`} />\r\n                        </div>\r\n                    </button>\r\n\r\n                    {/* User Profile */}\r\n                    <div className=\"flex items-center space-x-3 px-4 py-3 rounded-xl bg-white dark:bg-white/5 border border-brand-500/40 dark:border-brand-500/30 hover:border-brand-500/30 transition-all cursor-pointer group\">\r\n                        {(settings?.profilePicture || user?.avatar) ? (\r\n                            <img\r\n                                src={settings?.profilePicture\r\n                                    ? (settings.profilePicture.startsWith('http') ? settings.profilePicture : `${BACKEND_URL}${settings.profilePicture}`)\r\n                                    : user?.avatar}\r\n                                alt=\"Avatar\"\r\n                                className=\"w-9 h-9 rounded-lg object-cover ring-2 ring-transparent group-hover:ring-brand-500 transition-all\"\r\n                            />\r\n                        ) : (\r\n                            <div className=\"w-9 h-9 rounded-lg bg-gradient-to-br from-gray-800 to-black flex items-center justify-center text-brand-500 font-bold border border-white/10 shadow-inner group-hover:shadow-gold-lg transition-all\">\r\n                                {user?.name?.charAt(0).toUpperCase() || 'U'}\r\n                            </div>\r\n                        )}\r\n                        <div className=\"flex-1 min-w-0\">\r\n                            <p className=\"text-sm font-semibold text-gray-900 dark:text-white truncate group-hover:text-brand-400 transition-colors\">{user?.name}</p>\r\n                            <p className=\"text-[10px] text-gray-500 dark:text-gray-400 uppercase tracking-wider\">{settings?.roleBadge || user?.role?.toUpperCase()}</p>\r\n                        </div>\r\n                        <LogOut\r\n                            onClick={(e) => { e.stopPropagation(); setShowDeviceModal(true); }}\r\n                            className=\"w-4 h-4 text-gray-400 hover:text-red-500 transition-colors cursor-pointer\"\r\n                        />\r\n                    </div>\r\n                </div>\r\n            </aside>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default Sidebar;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\MoneyAdjustmentModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\RecordPaymentModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Reports\\BalanceSheet.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Reports\\LedgerVoucherModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Reports\\ProfitAndLoss.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Reports\\TrialBalance.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\Settings\\SettingsInvoicePreview.jsx","messages":[{"ruleId":"no-unsafe-optional-chaining","severity":2,"message":"Unsafe usage of optional chaining. If it short-circuits with 'undefined' the evaluation will throw TypeError.","line":44,"column":132,"nodeType":"ChainExpression","messageId":"unsafeOptionalChain","endLine":44,"endColumn":146},{"ruleId":"no-unsafe-optional-chaining","severity":2,"message":"Unsafe usage of optional chaining. If it short-circuits with 'undefined' the evaluation will throw TypeError.","line":44,"column":189,"nodeType":"ChainExpression","messageId":"unsafeOptionalChain","endLine":44,"endColumn":203}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useMemo, useState, useEffect } from 'react';\r\nimport { InvoiceRenderer } from '../Invoice/InvoiceTemplates';\r\nimport { BACKEND_URL } from '../../utils/api';\r\nimport QRCode from 'qrcode';\r\n\r\nconst SettingsInvoicePreview = ({ settings, formData }) => {\r\n    const [qrCodeUrl, setQrCodeUrl] = useState(null);\r\n\r\n    // 1. Merge Settings + FormData (Live Adjustments)\r\n    const previewSettings = useMemo(() => {\r\n        // Resolve Bank Account (Default or First)\r\n        const bankAccounts = formData.bankAccounts || settings?.bankAccounts || [];\r\n        const defaultBank = bankAccounts.find(acc => acc.isDefault) || bankAccounts[0] || {};\r\n\r\n        // Use form values if edited, else fallback to default bank, else settings\r\n        const bankName = formData.bankName || defaultBank.bankName || settings?.bankName;\r\n        const accountNumber = formData.accountNumber || defaultBank.accountNumber || settings?.accountNumber;\r\n        const ifscCode = formData.ifscCode || defaultBank.ifscCode || settings?.ifscCode;\r\n        const bankBranch = formData.bankBranch || defaultBank.bankBranch || settings?.bankBranch;\r\n        const bankHolderName = formData.bankHolderName || defaultBank.bankHolderName || settings?.bankHolderName;\r\n        const upiId = formData.upiId || defaultBank.upiId || settings?.upiId;\r\n\r\n        // Construct formatted Bank Details string if not explicitly provided\r\n        let formattedBankDetails = settings?.bankDetails;\r\n        if (!formattedBankDetails && (bankName || accountNumber)) {\r\n            const lines = [];\r\n            if (bankName) lines.push(`Bank: ${bankName}`);\r\n            if (accountNumber) lines.push(`A/c No: ${accountNumber}`);\r\n            if (ifscCode) lines.push(`IFSC: ${ifscCode}`);\r\n            if (bankBranch) lines.push(`Branch: ${bankBranch}`);\r\n            if (bankHolderName) lines.push(`Holder: ${bankHolderName}`);\r\n            formattedBankDetails = lines.join('\\n');\r\n        }\r\n\r\n        return {\r\n            ...settings,\r\n            ...formData,\r\n            // Ensure nested objects merge correctly if needed\r\n            invoiceTemplate: {\r\n                ...settings?.invoiceTemplate,\r\n                ...formData.invoiceTemplate\r\n            },\r\n            // Make sure style props are at top level as expected by templates\r\n            logo: (formData.logo || settings?.logo) && typeof (formData.logo || settings?.logo) === 'string' && !(formData.logo || settings?.logo).startsWith('http') && !(formData.logo || settings?.logo).startsWith('data:')\r\n                ? `${BACKEND_URL}${formData.logo || settings?.logo}`\r\n                : (formData.logo || settings?.logo),\r\n\r\n            shopName: formData.shopName || settings?.shopName,\r\n            address: formData.address || settings?.address,\r\n            phone: formData.phone || settings?.phone,\r\n            email: formData.email || settings?.email,\r\n            brandColor: formData.brandColor || settings?.brandColor,\r\n            primaryTextColor: formData.primaryTextColor || settings?.primaryTextColor,\r\n            invoiceFooterText: formData.invoiceFooterText || settings?.invoiceFooterText,\r\n            termsAndConditions: formData.termsAndConditions || settings?.termsAndConditions,\r\n\r\n            // BANKING\r\n            bankName,\r\n            accountNumber,\r\n            bankHolderName,\r\n            ifscCode,\r\n            bankBranch,\r\n            upiId,\r\n            bankDetails: formattedBankDetails, // Pass the formatted string\r\n\r\n            // Signature\r\n            digitalSignature: (settings?.digitalSignature) && typeof settings.digitalSignature === 'string' && !settings.digitalSignature.startsWith('http') && !settings.digitalSignature.startsWith('data:')\r\n                ? `${BACKEND_URL}${settings.digitalSignature}`\r\n                : settings?.digitalSignature,\r\n\r\n            // Config\r\n            fieldVisibility: formData.invoiceTemplate?.fieldVisibility || settings?.invoiceTemplate?.fieldVisibility || {}\r\n        };\r\n    }, [settings, formData]);\r\n\r\n    // 2. Generate QR Code when UPI ID changes\r\n    useEffect(() => {\r\n        const generateQR = async () => {\r\n            if (previewSettings.upiId) {\r\n                try {\r\n                    const upiUrl = `upi://pay?pa=${previewSettings.upiId}&pn=${previewSettings.shopName || 'Merchant'}&cu=INR`;\r\n                    const url = await QRCode.toDataURL(upiUrl, { width: 150, margin: 1 });\r\n                    setQrCodeUrl(url);\r\n                } catch (err) {\r\n                    console.error(\"QR Generation failed\", err);\r\n                    setQrCodeUrl(null);\r\n                }\r\n            } else {\r\n                setQrCodeUrl(null);\r\n            }\r\n        };\r\n        generateQR();\r\n    }, [previewSettings.upiId, previewSettings.shopName]);\r\n\r\n    // 3. Prepare Mock Data (Standard Format)\r\n    const mockData = {\r\n        invoiceNo: 'INV-001',\r\n        date: new Date().toLocaleDateString(),\r\n        customerName: 'John Doe',\r\n        customerPhone: '+91 98765 43210',\r\n        customerAddress: '123, Green Park, New Delhi',\r\n        customerGstin: '07ABCDE1234F1Z5',\r\n        items: [\r\n            { name: 'Wireless Headphones (Sony)', quantity: 2, price: 2500, total: 5000, gstPercent: 18, serialNumber: 'SN8392' },\r\n            { name: 'USB-C Fast Charger', quantity: 5, price: 300, total: 1500, gstPercent: 12 }\r\n        ],\r\n        subtotal: 6500,\r\n        tax: 1170, // Mock tax\r\n        total: 7670,\r\n        totalTaxable: 6500,\r\n        totalGST: 1170,\r\n        terms: previewSettings.termsAndConditions || 'Goods once sold will not be returned.',\r\n        upiId: previewSettings.upiId,\r\n        digitalSignature: previewSettings.digitalSignature,\r\n        authSignLabel: previewSettings.authSignLabel\r\n    };\r\n\r\n    // Inject generated QR code into settings passed to renderer\r\n    const rendererSettings = { ...previewSettings, qrCode: qrCodeUrl };\r\n\r\n    const templateId = previewSettings.invoiceTemplate?.templateId || 'modern';\r\n\r\n    return (\r\n        <div className=\"w-full h-full bg-white shadow-sm overflow-hidden text-gray-800\">\r\n            <InvoiceRenderer\r\n                templateId={templateId}\r\n                data={mockData}\r\n                settings={rendererSettings}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default SettingsInvoicePreview;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\components\\UI\\LiquidBackground.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\context\\AuthContext.jsx","messages":[],"suppressedMessages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":7,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":7,"endColumn":21,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\context\\ClientViewContext.jsx","messages":[],"suppressedMessages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":6,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":6,"endColumn":27,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\context\\SettingsContext.jsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n  42 |\n  43 |     useEffect(() => {\n> 44 |         refreshSettings();\n     |         ^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  45 |     }, [refreshSettings]);\n  46 |\n  47 |     const updateSettings = async (newSettings) => {","line":44,"column":9,"nodeType":null,"endLine":44,"endColumn":24}],"suppressedMessages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":7,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":7,"endColumn":25,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/* eslint-disable react-refresh/only-export-components */\r\nimport React, { createContext, useContext, useState, useEffect, useCallback } from 'react';\r\nimport api from '../utils/api';\r\n\r\nconst SettingsContext = createContext();\r\n\r\nexport const useSettings = () => {\r\n    const context = useContext(SettingsContext);\r\n    if (!context) {\r\n        throw new Error('useSettings must be used within SettingsProvider');\r\n    }\r\n    return context;\r\n};\r\n\r\nexport const SettingsProvider = ({ children }) => {\r\n    const [settings, setSettings] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    const refreshSettings = useCallback(async () => {\r\n        try {\r\n            const { data } = await api.get('/settings');\r\n            setSettings(data);\r\n\r\n\r\n            if (data.brandColor) setThemeVars('--brand-color', data.brandColor);\r\n            if (data.themeColor) setThemeVars('--theme-color', data.themeColor);\r\n            if (data.primaryTextColor) setThemeVars('--primary-text', data.primaryTextColor);\r\n            if (data.loginCardTextColor) setThemeVars('--login-card-text', data.loginCardTextColor);\r\n            if (data.appFontFamily) {\r\n                document.body.style.fontFamily = data.appFontFamily;\r\n            }\r\n\r\n            setLoading(false);\r\n        } catch (error) {\r\n            // If 401 (Unauthorized), just use defaults silently as user might be on login page\r\n            if (error.response?.status !== 401) {\r\n                console.error('Failed to load settings:', error.response || error);\r\n            }\r\n            setLoading(false);\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        refreshSettings();\r\n    }, [refreshSettings]);\r\n\r\n    const updateSettings = async (newSettings) => {\r\n        try {\r\n            const { data } = await api.put('/settings', newSettings);\r\n            setSettings(data);\r\n\r\n\r\n            if (data.brandColor) setThemeVars('--brand-color', data.brandColor);\r\n            if (data.themeColor) setThemeVars('--theme-color', data.themeColor);\r\n            if (data.primaryTextColor) setThemeVars('--primary-text', data.primaryTextColor);\r\n            if (data.loginCardTextColor) setThemeVars('--login-card-text', data.loginCardTextColor);\r\n            if (data.appFontFamily) {\r\n                document.body.style.fontFamily = data.appFontFamily;\r\n            }\r\n\r\n            return { success: true, data };\r\n        } catch (error) {\r\n            return {\r\n                success: false,\r\n                error: error.response?.data?.message || 'Failed to update settings'\r\n            };\r\n        }\r\n    };\r\n\r\n    const [theme, setTheme] = useState(localStorage.getItem('theme') || 'system');\r\n    const [effectiveTheme, setEffectiveTheme] = useState('light');\r\n\r\n    // Handle Theme Change\r\n    useEffect(() => {\r\n        const root = document.documentElement;\r\n        localStorage.setItem('theme', theme);\r\n\r\n        const applyTheme = (isDark) => {\r\n            if (isDark) {\r\n                root.classList.add('dark');\r\n                root.setAttribute('data-theme', 'dark');\r\n                setEffectiveTheme('dark');\r\n            } else {\r\n                root.classList.remove('dark');\r\n                root.setAttribute('data-theme', 'light');\r\n                setEffectiveTheme('light');\r\n            }\r\n        };\r\n\r\n        if (theme === 'system') {\r\n            const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');\r\n            applyTheme(mediaQuery.matches);\r\n\r\n            const handleChange = (e) => applyTheme(e.matches);\r\n            mediaQuery.addEventListener('change', handleChange);\r\n            return () => mediaQuery.removeEventListener('change', handleChange);\r\n        } else {\r\n            applyTheme(theme === 'dark');\r\n        }\r\n    }, [theme]);\r\n\r\n    const toggleTheme = () => {\r\n        // Cycle: Light -> Dark -> System -> Light\r\n        const modes = ['light', 'dark', 'system'];\r\n        const nextIndex = (modes.indexOf(theme) + 1) % modes.length;\r\n        setTheme(modes[nextIndex]);\r\n    };\r\n\r\n    const value = {\r\n        settings: settings || {\r\n            shopName: 'SHOP',\r\n            currency: 'INR',\r\n            address: '',\r\n            phone: '',\r\n            email: '',\r\n            gstin: ''\r\n        }, // Fallback to avoid null\r\n        loading,\r\n        refreshSettings,\r\n        updateSettings,\r\n        theme,\r\n        effectiveTheme,\r\n        toggleTheme\r\n    };\r\n\r\n    return <SettingsContext.Provider value={value}>{children}</SettingsContext.Provider>;\r\n};\r\n\r\n// Helper: Set both hex and rgb variables for opacity support\r\nconst setThemeVars = (name, hex) => {\r\n    document.documentElement.style.setProperty(name, hex);\r\n\r\n    // Convert hex to rgb\r\n    const r = parseInt(hex.slice(1, 3), 16);\r\n    const g = parseInt(hex.slice(3, 5), 16);\r\n    const b = parseInt(hex.slice(5, 7), 16);\r\n\r\n    document.documentElement.style.setProperty(`${name}-rgb`, `${r}, ${g}, ${b}`);\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\context\\ThemeContext.jsx","messages":[],"suppressedMessages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":6,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":6,"endColumn":22,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\hooks\\useDebounce.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\hooks\\useKeyboardNavigation.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\main.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\pages\\Catalog.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\pages\\CustomerLedger.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":66,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":66,"endColumn":23}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport Layout from '../components/Layout/Layout';\r\nimport api from '../utils/api';\r\nimport { formatINR } from '../utils/currency';\r\nimport { formatDate } from '../utils/date';\r\nimport { ArrowLeft, RefreshCw, Printer, Plus, Edit2, Trash2, Paperclip, X, Share2, Mail, MessageCircle } from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\nimport { sharePdf } from '../utils/pdfShare';\r\nimport ConfirmationModal from '../components/ConfirmationModal';\r\n\r\nimport { useSettings } from '../context/SettingsContext';\r\n\r\nconst CustomerLedger = ({ isPublic = false }) => {\r\n    const { id } = useParams();\r\n    const navigate = useNavigate();\r\n    const { settings } = useSettings();\r\n    const [customer, setCustomer] = useState(null);\r\n    const [ledger, setLedger] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [showPaymentModal, setShowPaymentModal] = useState(false);\r\n    const [showDeleteModal, setShowDeleteModal] = useState(false);\r\n    const [entryToDelete, setEntryToDelete] = useState(null);\r\n    const [payment, setPayment] = useState({\r\n        amount: '',\r\n        method: 'Cash',\r\n        date: new Date().toISOString().split('T')[0],\r\n        notes: ''\r\n    });\r\n\r\n    const [showEditModal, setShowEditModal] = useState(false);\r\n    const [editingEntry, setEditingEntry] = useState(null);\r\n\r\n    const loadData = useCallback(async () => {\r\n        try {\r\n            setLoading(true);\r\n            if (isPublic) {\r\n                const res = await api.get(`/public/customers/${id}/ledger`);\r\n                setCustomer(res.data.customer);\r\n                setLedger(res.data.ledger);\r\n            } else {\r\n                const [customerRes, ledgerRes] = await Promise.all([\r\n                    api.get(`/customers/${id}`),\r\n                    api.get(`/ledger/${id}`)\r\n                ]);\r\n                setCustomer(customerRes.data);\r\n                setLedger(ledgerRes.data.ledger);\r\n            }\r\n            setLoading(false);\r\n        } catch (error) {\r\n            console.error('Error loading ledger:', error);\r\n            if (!isPublic) toast.error('Failed to load ledger');\r\n            setLoading(false);\r\n        }\r\n    }, [id, isPublic]);\r\n\r\n    useEffect(() => {\r\n        loadData();\r\n    }, [loadData]);\r\n\r\n    const handleRecalculate = async () => {\r\n        try {\r\n            await api.post(`/ledger/recalculate/${id}`);\r\n            toast.success('Ledger recalculated');\r\n            loadData();\r\n        } catch (error) {\r\n            toast.error('Recalculation failed');\r\n        }\r\n    };\r\n\r\n    const handleRecordPayment = async () => {\r\n        if (!payment.amount || payment.amount <= 0) {\r\n            return toast.error('Please enter a valid amount');\r\n        }\r\n\r\n        try {\r\n            // Create payment via backend\r\n            await api.post('/payments', {\r\n                customerId: id,\r\n                amount: parseFloat(payment.amount),\r\n                method: payment.method,\r\n                date: payment.date,\r\n                notes: payment.notes || 'Direct payment recorded'\r\n            });\r\n\r\n            toast.success('Payment recorded successfully');\r\n            setShowPaymentModal(false);\r\n            setPayment({ amount: '', method: 'Cash', date: new Date().toISOString().split('T')[0], notes: '' });\r\n            loadData();\r\n        } catch (error) {\r\n            console.error('Payment error:', error);\r\n            toast.error(error.response?.data?.message || 'Failed to record payment');\r\n        }\r\n    };\r\n\r\n    const handleEditClick = (entry) => {\r\n        setEditingEntry({ ...entry, deleteAttachment: false });\r\n        setShowEditModal(true);\r\n    };\r\n\r\n    const handleUpdateEntry = async (e) => {\r\n        e.preventDefault();\r\n        try {\r\n            const formData = new FormData();\r\n            formData.append('date', editingEntry.date);\r\n            formData.append('description', editingEntry.description);\r\n            formData.append('refNo', editingEntry.refNo || '');\r\n            formData.append('debit', editingEntry.debit || 0);\r\n            formData.append('credit', editingEntry.credit || 0);\r\n\r\n            if (editingEntry.billFile) {\r\n                formData.append('billFile', editingEntry.billFile);\r\n            }\r\n            if (editingEntry.deleteAttachment) {\r\n                formData.append('deleteAttachment', 'true');\r\n            }\r\n\r\n            await api.put(`/ledger/${editingEntry._id}`, formData);\r\n            toast.success('Entry updated successfully');\r\n            setShowEditModal(false);\r\n            setEditingEntry(null);\r\n            loadData();\r\n        } catch (error) {\r\n            console.error('Update error:', error);\r\n            toast.error('Failed to update entry');\r\n        }\r\n    };\r\n\r\n    const handleDeleteClick = (entry) => {\r\n        setEntryToDelete(entry);\r\n        setShowDeleteModal(true);\r\n    };\r\n\r\n    const confirmDelete = async () => {\r\n        if (!entryToDelete) return;\r\n\r\n        try {\r\n            await api.delete(`/ledger/${entryToDelete._id}`);\r\n            toast.success('Entry deleted successfully');\r\n            loadData();\r\n        } catch (error) {\r\n            console.error('Delete error:', error);\r\n            toast.error('Failed to delete entry');\r\n        } finally {\r\n            setShowDeleteModal(false);\r\n            setEntryToDelete(null);\r\n        }\r\n    };\r\n\r\n    const handleShare = async () => {\r\n        const fileName = `Customer_Ledger_${customer?.name || 'Report'}.pdf`;\r\n        const title = `Ledger Statement - ${customer?.name}`;\r\n        const text = `Please find attached the ledger statement for ${customer?.name}.`;\r\n\r\n        await sharePdf('ledger-content', fileName, title, text);\r\n    };\r\n\r\n    const handleWhatsAppShare = () => {\r\n        const shareUrl = `${window.location.origin}/share/customer/${id}/ledger`;\r\n        const text = `Here is the ledger statement for ${customer?.name || 'Customer'}: ${shareUrl}`;\r\n\r\n        // Use whatsappNumber from settings if available, otherwise open WhatsApp without recipient\r\n        const whatsappNumber = settings?.whatsappNumber || '';\r\n        const waLink = whatsappNumber\r\n            ? `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(text)}`\r\n            : `https://wa.me/?text=${encodeURIComponent(text)}`;\r\n\r\n        window.open(waLink, '_blank');\r\n    };\r\n\r\n    return (\r\n        <Layout>\r\n            <div className=\"p-6\">\r\n                {/* Header */}\r\n                <div className=\"flex items-center justify-between mb-6\">\r\n                    <div className=\"flex items-center space-x-4\">\r\n                        {!isPublic && (\r\n                            <button\r\n                                onClick={() => navigate('/customers')}\r\n                                className=\"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors\"\r\n                            >\r\n                                <ArrowLeft className=\"w-6 h-6 text-gray-600 dark:text-gray-400\" />\r\n                            </button>\r\n                        )}\r\n                        <div>\r\n                            <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\r\n                                {loading ? 'Loading...' : `${customer?.name} - Ledger`}\r\n                            </h1>\r\n                            <p className=\"text-gray-600 dark:text-gray-400\">\r\n                                {customer?.phone} | {customer?.address}\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {isPublic ? (\r\n                        <>\r\n                            <button\r\n                                onClick={handleShare}\r\n                                className=\"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors\"\r\n                            >\r\n                                <Share2 className=\"w-4 h-4\" />\r\n                                <span>Share PDF</span>\r\n                            </button>\r\n                            <button\r\n                                onClick={handleWhatsAppShare}\r\n                                className=\"flex items-center space-x-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors\"\r\n                            >\r\n                                <MessageCircle className=\"w-4 h-4\" />\r\n                                <span>WhatsApp</span>\r\n                            </button>\r\n                        </>\r\n                    ) : (\r\n                        <>\r\n                            <button\r\n                                onClick={handleShare}\r\n                                className=\"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\r\n                            >\r\n                                <Share2 className=\"w-4 h-4\" />\r\n                                <span>Download PDF</span>\r\n                            </button>\r\n                            <button\r\n                                onClick={handleWhatsAppShare}\r\n                                className=\"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors border border-green-200\"\r\n                                title=\"Share on WhatsApp\"\r\n                            >\r\n                                <MessageCircle className=\"w-5 h-5\" />\r\n                            </button>\r\n                            <button\r\n                                onClick={() => setShowPaymentModal(true)}\r\n                                className=\"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors\"\r\n                            >\r\n                                <Plus className=\"w-4 h-4\" />\r\n                                <span>Record Payment</span>\r\n                            </button>\r\n                            <button\r\n                                onClick={handleRecalculate}\r\n                                className=\"flex items-center space-x-2 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 transition-colors\"\r\n                            >\r\n                                <RefreshCw className=\"w-4 h-4\" />\r\n                                <span>Recalculate</span>\r\n                            </button>\r\n                        </>\r\n                    )}\r\n                    <button className=\"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\">\r\n                        <Printer className=\"w-4 h-4\" />\r\n                        <span>Print</span>\r\n                    </button>\r\n                </div>\r\n\r\n            </div>\r\n\r\n            {/* Gold Standard Ledger Content */}\r\n            <div id=\"ledger-content\" className=\"bg-white/80 dark:bg-black/40 backdrop-blur-xl p-4 rounded-[32px] border-[2.5px] border-amber-500/30 shadow-2xl transition-all duration-300\">\r\n                {/* Summary Cards */}\r\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\r\n                    <div className=\"bg-white/50 dark:bg-black/20 p-6 rounded-[24px] border border-red-500/20 box-shadow-sm hover:border-red-500/40 transition-all\">\r\n                        <p className=\"text-[10px] uppercase tracking-widest font-black text-gray-500 dark:text-gray-400 mb-2\">Total Debit (Sales)</p>\r\n                        <p className=\"text-3xl font-black text-red-600 dark:text-red-400 rupee\">\r\n                            {formatINR(ledger.reduce((sum, entry) => sum + (entry.debit || 0), 0))}\r\n                        </p>\r\n                    </div>\r\n                    <div className=\"bg-white/50 dark:bg-black/20 p-6 rounded-[24px] border border-green-500/20 box-shadow-sm hover:border-green-500/40 transition-all\">\r\n                        <p className=\"text-[10px] uppercase tracking-widest font-black text-gray-500 dark:text-gray-400 mb-2\">Total Credit (Received)</p>\r\n                        <p className=\"text-3xl font-black text-green-600 dark:text-green-400 rupee\">\r\n                            {formatINR(ledger.reduce((sum, entry) => sum + (entry.credit || 0), 0))}\r\n                        </p>\r\n                    </div>\r\n                    <div className=\"bg-amber-500/10 dark:bg-amber-500/5 p-6 rounded-[24px] border border-amber-500/30 box-shadow-lg shadow-amber-500/10\">\r\n                        <p className=\"text-[10px] uppercase tracking-widest font-black text-amber-800 dark:text-amber-400 mb-2\">Net Balance Due</p>\r\n                        <p className=\"text-4xl font-black text-amber-700 dark:text-amber-500 rupee tracking-tight\">\r\n                            {formatINR(customer?.balance || 0)}\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Ledger Table */}\r\n                <div className=\"bg-white/50 dark:bg-black/20 rounded-[24px] overflow-hidden border border-gray-100 dark:border-white/5 transition-colors\">\r\n                    <div className=\"overflow-x-auto\">\r\n                        <table className=\"w-full\">\r\n                            <thead>\r\n                                <tr className=\"bg-gray-50/50 dark:bg-white/5 border-b-[2.5px] border-black dark:border-white/90\">\r\n                                    <th className=\"px-6 py-5 text-left text-[10px] font-black text-gray-400 uppercase tracking-[0.2em]\">Date</th>\r\n                                    <th className=\"px-6 py-5 text-left text-[10px] font-black text-gray-400 uppercase tracking-[0.2em]\">Particulars</th>\r\n                                    <th className=\"px-6 py-5 text-left text-[10px] font-black text-gray-400 uppercase tracking-[0.2em]\">Ref No</th>\r\n                                    <th className=\"px-6 py-5 text-center text-[10px] font-black text-gray-400 uppercase tracking-[0.2em]\">Bill</th>\r\n                                    <th className=\"px-6 py-5 text-right text-[10px] font-black uppercase tracking-[0.2em] text-red-600/70 dark:text-red-400/70\">Debit (Dr)</th>\r\n                                    <th className=\"px-6 py-5 text-right text-[10px] font-black uppercase tracking-[0.2em] text-green-600/70 dark:text-green-400/70\">Credit (Cr)</th>\r\n                                    <th className=\"px-6 py-5 text-right text-[10px] font-black text-gray-400 uppercase tracking-[0.2em]\">Balance</th>\r\n                                    {!isPublic && <th className=\"px-6 py-5 text-right text-[10px] font-black text-gray-400 uppercase tracking-[0.2em]\">Actions</th>}\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody className=\"divide-y divide-gray-100 dark:divide-white/5\">\r\n                                {loading ? (\r\n                                    <tr>\r\n                                        <td colSpan=\"8\" className=\"text-center py-8\">Loading ledger...</td>\r\n                                    </tr>\r\n                                ) : ledger.length === 0 ? (\r\n                                    <tr>\r\n                                        <td colSpan=\"8\" className=\"text-center py-8 text-gray-500\">No transactions found</td>\r\n                                    </tr>\r\n                                ) : (\r\n                                    ledger.map((entry) => (\r\n                                        <tr key={entry._id} className=\"hover:bg-amber-500/5 dark:hover:bg-amber-500/10 transition-colors group\">\r\n                                            <td className=\"px-6 py-5 text-xs font-bold text-gray-900 dark:text-gray-100 whitespace-nowrap\">\r\n                                                {formatDate(entry.date)}\r\n                                            </td>\r\n                                            <td className=\"px-6 py-5 text-sm text-gray-900 dark:text-gray-100\">\r\n                                                <div className=\"font-black text-xs uppercase tracking-wide\">{entry.refType}</div>\r\n                                                <div className=\"text-gray-500 dark:text-gray-400 text-[10px] font-medium mt-0.5\">{entry.description}</div>\r\n                                            </td>\r\n                                            <td className=\"px-6 py-4 text-sm text-gray-500 dark:text-gray-400 font-mono\">\r\n                                                {entry.refNo || '-'}\r\n                                            </td>\r\n                                            <td className=\"px-6 py-4 text-center\">\r\n                                                <span className=\"text-gray-300\">-</span>\r\n                                            </td>\r\n                                            <td className=\"px-6 py-4 text-sm text-right font-medium text-red-600 dark:text-red-400\">\r\n                                                {entry.debit > 0 ? formatINR(entry.debit) : '-'}\r\n                                            </td>\r\n                                            <td className=\"px-6 py-4 text-sm text-right font-medium text-green-600 dark:text-green-400\">\r\n                                                {entry.credit > 0 ? formatINR(entry.credit) : '-'}\r\n                                            </td>\r\n                                            <td className=\"px-6 py-5 text-sm text-right font-black text-gray-900 dark:text-white rupee bg-gray-50/50 dark:bg-white/5 rounded-lg m-1\">\r\n                                                {formatINR(entry.balance)}\r\n                                            </td>\r\n                                            {!isPublic && (\r\n                                                <td className=\"px-6 py-4 text-right text-sm font-medium space-x-2\">\r\n                                                    <button\r\n                                                        onClick={() => handleEditClick(entry)}\r\n                                                        className=\"p-1 text-blue-600 hover:bg-blue-50 rounded transition-colors\"\r\n                                                        title=\"Edit Entry\"\r\n                                                    >\r\n                                                        <Edit2 className=\"w-4 h-4\" />\r\n                                                    </button>\r\n                                                    <button\r\n                                                        onClick={() => handleDeleteClick(entry)}\r\n                                                        className=\"p-1 text-red-600 hover:bg-red-50 rounded transition-colors\"\r\n                                                        title=\"Delete Entry\"\r\n                                                    >\r\n                                                        <Trash2 className=\"w-4 h-4\" />\r\n                                                    </button>\r\n                                                </td>\r\n                                            )}\r\n                                        </tr>\r\n                                    ))\r\n                                )}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                </div>\r\n            </div> {/* End of ledger-content */}\r\n\r\n            {/* Payment Recording Modal */}\r\n            {\r\n                showPaymentModal && (\r\n                    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 backdrop-blur-sm\">\r\n                        <div className=\"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full p-6 shadow-2xl transition-colors\">\r\n                            <h3 className=\"text-xl font-bold text-gray-900 dark:text-white mb-4 border-b-[2.5px] border-black dark:border-white/90 pb-2\">Record Payment</h3>\r\n\r\n                            <div className=\"space-y-4\">\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                                        Date *\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"date\"\r\n                                        value={payment.date}\r\n                                        onChange={(e) => setPayment({ ...payment, date: e.target.value })}\r\n                                        className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors\"\r\n                                    />\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                                        Amount *\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        value={payment.amount}\r\n                                        onChange={(e) => setPayment({ ...payment, amount: e.target.value })}\r\n                                        className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors\"\r\n                                        placeholder=\"Enter amount received\"\r\n                                        min=\"0\"\r\n                                        step=\"0.01\"\r\n                                    />\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                                        Payment Method *\r\n                                    </label>\r\n                                    <select\r\n                                        value={payment.method}\r\n                                        onChange={(e) => setPayment({ ...payment, method: e.target.value })}\r\n                                        className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors\"\r\n                                    >\r\n                                        <option value=\"Cash\">Cash</option>\r\n                                        <option value=\"Credit\">Credit</option>\r\n                                        <option value=\"UPI\">UPI</option>\r\n                                        <option value=\"Card\">Card</option>\r\n                                        <option value=\"Cheque\">Cheque</option>\r\n                                        <option value=\"Bank Transfer\">Bank Transfer</option>\r\n                                        <option value=\"Online\">Online</option>\r\n                                    </select>\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                                        Notes (Optional)\r\n                                    </label>\r\n                                    <textarea\r\n                                        value={payment.notes}\r\n                                        onChange={(e) => setPayment({ ...payment, notes: e.target.value })}\r\n                                        className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors\"\r\n                                        rows=\"3\"\r\n                                        placeholder=\"e.g., Payment for Invoice #123\"\r\n                                    ></textarea>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"flex justify-end space-x-3 mt-6\">\r\n                                <button\r\n                                    onClick={() => setShowPaymentModal(false)}\r\n                                    className=\"px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors\"\r\n                                >\r\n                                    Cancel\r\n                                </button>\r\n                                <button\r\n                                    onClick={handleRecordPayment}\r\n                                    className=\"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium\"\r\n                                >\r\n                                    Record Payment\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )\r\n            }\r\n\r\n            {/* Edit Entry Modal */}\r\n            {\r\n                showEditModal && editingEntry && (\r\n                    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 backdrop-blur-sm\">\r\n                        <div className=\"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full p-6 shadow-2xl transition-colors\">\r\n                            <div className=\"flex justify-between items-center mb-4\">\r\n                                <h3 className=\"text-xl font-bold text-gray-900 dark:text-white\">Edit Entry</h3>\r\n                                <button onClick={() => setShowEditModal(false)} className=\"text-gray-500 hover:text-gray-700\">\r\n                                    <X className=\"w-5 h-5\" />\r\n                                </button>\r\n                            </div>\r\n                            <form onSubmit={handleUpdateEntry} className=\"space-y-4\">\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Date</label>\r\n                                    <input\r\n                                        type=\"date\"\r\n                                        value={editingEntry.date ? new Date(editingEntry.date).toLocaleDateString('en-CA') : ''}\r\n                                        onChange={(e) => setEditingEntry({ ...editingEntry, date: e.target.value })}\r\n                                        className=\"mt-1 w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n                                    />\r\n                                </div>\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Description</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={editingEntry.description}\r\n                                        onChange={(e) => setEditingEntry({ ...editingEntry, description: e.target.value })}\r\n                                        className=\"mt-1 w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n                                    />\r\n                                </div>\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Ref No</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={editingEntry.refNo || ''}\r\n                                        onChange={(e) => setEditingEntry({ ...editingEntry, refNo: e.target.value })}\r\n                                        className=\"mt-1 w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n                                    />\r\n                                </div>\r\n                                <div className=\"grid grid-cols-2 gap-4\">\r\n                                    <div>\r\n                                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 text-red-600\">Debit</label>\r\n                                        <input\r\n                                            type=\"number\"\r\n                                            value={editingEntry.debit}\r\n                                            onChange={(e) => setEditingEntry({ ...editingEntry, debit: e.target.value })}\r\n                                            className=\"mt-1 w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n                                            step=\"0.01\"\r\n                                        />\r\n                                    </div>\r\n                                    <div>\r\n                                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 text-green-600\">Credit</label>\r\n                                        <input\r\n                                            type=\"number\"\r\n                                            value={editingEntry.credit}\r\n                                            onChange={(e) => setEditingEntry({ ...editingEntry, credit: e.target.value })}\r\n                                            className=\"mt-1 w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n                                            step=\"0.01\"\r\n                                        />\r\n                                    </div>\r\n                                    <div className=\"flex\">\r\n                                        <div className=\"w-full\">\r\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Bill Attachment</label>\r\n                                            {!editingEntry.billFile && !editingEntry.billAttachment ? (\r\n                                                <input\r\n                                                    type=\"file\"\r\n                                                    accept=\"image/*,.pdf\"\r\n                                                    onChange={(e) => setEditingEntry({ ...editingEntry, billFile: e.target.files[0] })}\r\n                                                    className=\"w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm\"\r\n                                                />\r\n                                            ) : (\r\n                                                <div className=\"flex items-center justify-between p-2 border border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-700/50 rounded-lg\">\r\n                                                    <div className=\"flex items-center space-x-2 overflow-hidden\">\r\n                                                        <Paperclip className=\"w-4 h-4 text-gray-500\" />\r\n                                                        <span className=\"text-sm text-gray-700 dark:text-gray-300 truncate\">\r\n                                                            {editingEntry.billFile ? editingEntry.billFile.name : 'Existing Attachment'}\r\n                                                        </span>\r\n                                                        {!editingEntry.billFile && editingEntry.billAttachment && !editingEntry.deleteAttachment && (\r\n                                                            <a href={`${api.defaults.baseURL}${editingEntry.billAttachment}`} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-xs text-blue-600 hover:underline\">\r\n                                                                (View)\r\n                                                            </a>\r\n                                                        )}\r\n                                                    </div>\r\n                                                    <div className=\"flex items-center\">\r\n                                                        {editingEntry.deleteAttachment ? (\r\n                                                            <span className=\"text-xs text-red-500 font-medium mr-2\">Deleted</span>\r\n                                                        ) : null}\r\n                                                        <button\r\n                                                            type=\"button\"\r\n                                                            onClick={() => {\r\n                                                                if (editingEntry.billFile) {\r\n                                                                    setEditingEntry({ ...editingEntry, billFile: null });\r\n                                                                } else {\r\n                                                                    // Toggle deletion for existing\r\n                                                                    if (editingEntry.deleteAttachment) {\r\n                                                                        setEditingEntry({ ...editingEntry, deleteAttachment: false });\r\n                                                                    } else {\r\n                                                                        setEditingEntry({ ...editingEntry, deleteAttachment: true });\r\n                                                                    }\r\n                                                                }\r\n                                                            }}\r\n                                                            className=\"text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 p-1 rounded-full transition-colors\"\r\n                                                            title=\"Remove/Delete File\"\r\n                                                        >\r\n                                                            <X className=\"w-4 h-4\" />\r\n                                                        </button>\r\n                                                    </div>\r\n                                                </div>\r\n                                            )}\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"flex justify-end space-x-3 mt-6\">\r\n                                    <button\r\n                                        type=\"button\"\r\n                                        onClick={() => setShowEditModal(false)}\r\n                                        className=\"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg dark:text-gray-400 dark:hover:bg-gray-700\"\r\n                                    >\r\n                                        Cancel\r\n                                    </button>\r\n                                    <button\r\n                                        type=\"submit\"\r\n                                        className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\"\r\n                                    >\r\n                                        Update Entry\r\n                                    </button>\r\n                                </div>\r\n                            </form>\r\n                        </div>\r\n                    </div>\r\n                )\r\n            }\r\n            {/* Confirmation Modal */}\r\n            <ConfirmationModal\r\n                isOpen={showDeleteModal}\r\n                onClose={() => setShowDeleteModal(false)}\r\n                onConfirm={confirmDelete}\r\n                title=\"Delete Entry\"\r\n                message=\"Are you sure you want to delete this transaction? This action cannot be undone.\"\r\n                confirmText=\"Delete\"\r\n                cancelText=\"Cancel\"\r\n                isDangerous={true}\r\n            />\r\n        </Layout >\r\n    );\r\n};\r\n\r\nexport default CustomerLedger;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\pages\\Customers.jsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n  45 |\n  46 |     useEffect(() => {\n> 47 |         loadCustomers();\n     |         ^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  48 |     }, [loadCustomers]);\n  49 |\n  50 |     const filteredCustomers = React.useMemo(() => {","line":47,"column":9,"nodeType":null,"endLine":47,"endColumn":22}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport ConfirmationModal from '../components/ConfirmationModal';\r\nimport Layout from '../components/Layout/Layout';\r\nimport api from '../utils/api';\r\nimport { formatINR } from '../utils/currency';\r\nimport {\r\n    Users,\r\n    Search,\r\n    Plus,\r\n    Edit2,\r\n    Trash2,\r\n    BookOpen, // Ledger Icon\r\n    Eye,\r\n    X,\r\n    Phone,\r\n    Mail,\r\n    IndianRupee\r\n} from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst Customers = () => {\r\n    const navigate = useNavigate();\r\n    const [customers, setCustomers] = useState([]);\r\n    const [searchQuery, setSearchQuery] = useState('');\r\n    const [loading, setLoading] = useState(true);\r\n    const [showModal, setShowModal] = useState(false);\r\n    const [editingCustomer, setEditingCustomer] = useState(null);\r\n    const [showDeleteModal, setShowDeleteModal] = useState(false);\r\n    const [customerToDelete, setCustomerToDelete] = useState(null);\r\n\r\n\r\n    const loadCustomers = useCallback(async () => {\r\n        try {\r\n            setLoading(true);\r\n            const { data } = await api.get('/customers');\r\n            setCustomers(data.customers || []);\r\n            setLoading(false);\r\n        } catch (error) {\r\n            console.error('Failed to load customers:', error);\r\n            toast.error('Failed to load customers');\r\n            setLoading(false);\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        loadCustomers();\r\n    }, [loadCustomers]);\r\n\r\n    const filteredCustomers = React.useMemo(() => {\r\n        if (!searchQuery) return customers;\r\n        return customers.filter(c =>\r\n            c.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n            c.phone.includes(searchQuery) ||\r\n            c.email?.toLowerCase().includes(searchQuery.toLowerCase())\r\n        );\r\n    }, [customers, searchQuery]);\r\n\r\n    const handleDeleteClick = (customer) => {\r\n        setCustomerToDelete(customer);\r\n        setShowDeleteModal(true);\r\n    };\r\n\r\n    const confirmDelete = async () => {\r\n        if (!customerToDelete) return;\r\n\r\n        try {\r\n            await api.delete(`/customers/${customerToDelete._id}`);\r\n            toast.success('Customer deleted successfully');\r\n            loadCustomers();\r\n            setCustomerToDelete(null);\r\n        } catch (error) {\r\n            console.error('Delete error:', error);\r\n            toast.error(error.response?.data?.message || 'Failed to delete customer');\r\n        }\r\n    };\r\n\r\n    const handleEdit = (customer) => {\r\n        setEditingCustomer(customer);\r\n        setShowModal(true);\r\n    };\r\n\r\n    const handleAdd = () => {\r\n        setEditingCustomer(null);\r\n        setShowModal(true);\r\n    };\r\n\r\n    return (\r\n        <Layout>\r\n            <div className=\"p-4 md:p-8 min-h-screen bg-gray-50/50 dark:bg-[#050505] transition-colors duration-500\">\r\n                {/* Header Section */}\r\n                <div className=\"mb-10 relative\">\r\n                    <div className=\"absolute -top-24 -left-24 w-96 h-96 bg-blue-500/10 blur-[120px] rounded-full pointer-events-none\"></div>\r\n                    <div className=\"flex flex-col md:flex-row md:items-end justify-between gap-6 relative z-10\">\r\n                        <div>\r\n                            <div className=\"flex items-center space-x-3 mb-2\">\r\n                                <div className=\"p-2 bg-blue-500/10 rounded-lg\">\r\n                                    <Users className=\"w-5 h-5 text-blue-500\" />\r\n                                </div>\r\n                                <span className=\"text-blue-600 dark:text-blue-400 text-xs font-black uppercase tracking-[0.3em]\">Relationship Hub</span>\r\n                            </div>\r\n                            <h1 className=\"text-4xl md:text-5xl font-black text-gray-900 dark:text-white tracking-tight\">\r\n                                <span className=\"text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-sky-500\">Customers</span>\r\n                            </h1>\r\n                            <p className=\"text-gray-500 dark:text-gray-400 mt-2 font-medium max-w-md\">\r\n                                Manage customer information and ledgers\r\n                            </p>\r\n                        </div>\r\n                        <button\r\n                            onClick={handleAdd}\r\n                            className=\"flex items-center space-x-2 px-8 py-4 bg-blue-600 hover:bg-blue-500 text-white rounded-2xl shadow-[0_20px_40px_rgba(37,99,235,0.2)] hover:shadow-[0_25px_50px_rgba(37,99,235,0.3)] transition-all duration-300 transform hover:-translate-y-1 group\"\r\n                        >\r\n                            <Plus className=\"w-6 h-6 group-hover:rotate-90 transition-transform duration-500\" />\r\n                            <span className=\"font-black tracking-tight text-lg\">Add Customer</span>\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Cognitive Search Bar */}\r\n                <div className=\"mb-8 relative z-10 max-w-4xl mx-auto\">\r\n                    <div className=\"bg-white dark:bg-[#0a0a0a] p-2 rounded-2xl border border-blue-500/30 shadow-[0_4px_20px_-8px_rgba(59,130,246,0.3)] transition-all duration-300\">\r\n                        <div className=\"flex items-center px-4\">\r\n                            <Search className=\"w-5 h-5 text-gray-400\" />\r\n                            <input\r\n                                type=\"text\"\r\n                                value={searchQuery}\r\n                                onChange={(e) => setSearchQuery(e.target.value)}\r\n                                placeholder=\"Search by name, phone, or digital ID...\"\r\n                                className=\"w-full pl-4 pr-4 py-3 bg-transparent border-none text-gray-900 dark:text-white placeholder-gray-400 focus:ring-0 text-sm font-medium\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Partners Pulse Grid */}\r\n                {loading ? (\r\n                    <div className=\"bg-white/50 dark:bg-black/20 backdrop-blur-xl rounded-[32px] border border-white dark:border-white/5 p-20 text-center\">\r\n                        <div className=\"relative inline-block\">\r\n                            <div className=\"w-16 h-16 border-t-2 border-blue-500 rounded-full animate-spin mx-auto\"></div>\r\n                            <div className=\"absolute inset-0 bg-blue-500/20 blur-xl rounded-full\"></div>\r\n                        </div>\r\n                        <p className=\"mt-4 text-blue-600 dark:text-blue-400 font-bold tracking-widest uppercase text-xs animate-pulse font-mono\">Syncing Directory...</p>\r\n                    </div>\r\n                ) : filteredCustomers.length === 0 ? (\r\n                    <div className=\"bg-white/50 dark:bg-black/20 backdrop-blur-xl rounded-[32px] border border-white dark:border-white/5 p-20 text-center group\">\r\n                        <div className=\"relative inline-block mb-6\">\r\n                            <div className=\"absolute inset-0 bg-blue-500/10 blur-3xl rounded-full group-hover:bg-blue-500/20 transition-all duration-700\"></div>\r\n                            <Users className=\"w-20 h-20 text-blue-500/20 group-hover:text-blue-500/40 transition-all duration-500 relative z-10 mx-auto\" strokeWidth={1} />\r\n                        </div>\r\n                        <h3 className=\"text-2xl font-black text-gray-900 dark:text-white tracking-tight\">Hub Empty</h3>\r\n                        <p className=\"text-gray-500 dark:text-gray-400 mt-2 font-medium\">No partners found matching your search matrix.</p>\r\n                        <button onClick={handleAdd} className=\"mt-8 px-8 py-3 bg-blue-500/10 text-blue-600 dark:text-blue-400 border border-blue-500/20 rounded-xl hover:bg-blue-500 hover:text-white transition-all duration-300 font-bold uppercase tracking-widest text-xs\">\r\n                            Add Customer\r\n                        </button>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 relative z-10\">\r\n                        {filteredCustomers.map((customer) => (\r\n                            <div\r\n                                key={customer._id}\r\n                                className=\"bg-[#F8FAFF] dark:bg-[#0a0a0a] rounded-[32px] border-[1.5px] border-blue-400/40 p-6 shadow-sm hover:shadow-[0_8px_30px_-10px_rgba(59,130,246,0.2)] transition-all duration-300 group\"\r\n                            >\r\n                                {/* Header Pill */}\r\n                                <div className=\"border border-black/80 dark:border-white/80 rounded-full p-2 flex items-center gap-4 mb-4 bg-white dark:bg-black/40\">\r\n                                    <div className=\"relative\">\r\n                                        <div className=\"w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-500/20 flex items-center justify-center text-blue-600 dark:text-blue-400 font-bold text-lg border border-blue-200 dark:border-blue-500/30\">\r\n                                            {customer.name.charAt(0).toUpperCase()}\r\n                                        </div>\r\n                                        <div className=\"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-emerald-500 border-2 border-white dark:border-black rounded-full\"></div>\r\n                                    </div>\r\n                                    <div className=\"flex flex-col\">\r\n                                        <span className=\"text-base font-bold text-gray-900 dark:text-white leading-tight\">\r\n                                            {customer.name}\r\n                                        </span>\r\n                                        <span className=\"text-[9px] font-bold text-gray-400 dark:text-gray-500 uppercase tracking-widest\">\r\n                                            Level ID: {customer._id.slice(-6).toUpperCase()}\r\n                                        </span>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Contact Pill */}\r\n                                <div className=\"border border-black/80 dark:border-white/80 rounded-full px-5 py-3 mb-6 bg-white dark:bg-black/40 flex items-center gap-3\">\r\n                                    <div className=\"w-6 h-6 rounded-md bg-blue-500/10 flex items-center justify-center\">\r\n                                        <Phone className=\"w-3.5 h-3.5 text-blue-600 dark:text-blue-400\" />\r\n                                    </div>\r\n                                    <span className=\"text-sm font-bold text-gray-700 dark:text-gray-300 tracking-wide\">\r\n                                        +91 {customer.phone}\r\n                                    </span>\r\n                                </div>\r\n\r\n                                {/* Liability/Actions Container */}\r\n                                <div className=\"border border-black/80 dark:border-white/80 rounded-2xl p-4 bg-gray-50/50 dark:bg-white/5 relative overflow-hidden\">\r\n                                    <div className=\"flex justify-between items-start mb-1\">\r\n                                        <span className=\"text-[10px] font-black text-gray-400 dark:text-gray-500 uppercase tracking-widest\">Credit Portfolio</span>\r\n                                        <IndianRupee className=\"w-3 h-3 text-gray-300\" />\r\n                                    </div>\r\n\r\n                                    <div className={`text-xl font-bold font-mono tracking-tighter mb-3 ${customer.balance > 0 ? 'text-red-600 dark:text-red-400' : 'text-emerald-600 dark:text-emerald-400'}`}>\r\n                                        {formatINR(Math.abs(customer.balance))}\r\n                                    </div>\r\n\r\n                                    <div className=\"flex items-center space-x-2 mb-2\">\r\n                                        <div className=\"h-1 flex-1 bg-gray-200 dark:bg-white/10 rounded-full overflow-hidden\">\r\n                                            <div\r\n                                                className={`h-full rounded-full transition-all duration-1000 ${customer.balance > 0 ? 'bg-red-500' : 'bg-emerald-500'}`}\r\n                                                style={{ width: '40%' }}\r\n                                            ></div>\r\n                                        </div>\r\n                                        <span className={`text-[9px] font-bold ${customer.balance > 0 ? 'text-red-500' : 'text-emerald-500'} uppercase`}>\r\n                                            {customer.balance > 0 ? 'DUE' : 'CLEAR'}\r\n                                        </span>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"flex items-center justify-end space-x-2 mt-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300\">\r\n                                    <button\r\n                                        onClick={() => navigate(`/customers/${customer._id}/ledger`)}\r\n                                        className=\"p-2 text-gray-400 hover:text-indigo-500 transition-colors\"\r\n                                        title=\"Ledger\"\r\n                                    >\r\n                                        <BookOpen className=\"w-4 h-4\" />\r\n                                    </button>\r\n                                    <button\r\n                                        onClick={() => handleEdit(customer)}\r\n                                        className=\"p-2 text-gray-400 hover:text-blue-500 transition-colors\"\r\n                                        title=\"Modify\"\r\n                                    >\r\n                                        <Edit2 className=\"w-4 h-4\" />\r\n                                    </button>\r\n                                    <button\r\n                                        onClick={() => handleDeleteClick(customer)}\r\n                                        className=\"p-2 text-gray-400 hover:text-red-500 transition-colors\"\r\n                                        title=\"Expunge\"\r\n                                    >\r\n                                        <Trash2 className=\"w-4 h-4\" />\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Add/Edit Customer Modal */}\r\n            {showModal && (\r\n                <CustomerModal\r\n                    customer={editingCustomer}\r\n                    onClose={() => {\r\n                        setShowModal(false);\r\n                        setEditingCustomer(null);\r\n                    }}\r\n                    onSuccess={() => {\r\n                        setShowModal(false);\r\n                        setEditingCustomer(null);\r\n                        loadCustomers();\r\n                    }}\r\n                />\r\n            )}\r\n\r\n            <ConfirmationModal\r\n                isOpen={showDeleteModal}\r\n                onClose={() => {\r\n                    setShowDeleteModal(false);\r\n                    setCustomerToDelete(null);\r\n                }}\r\n                onConfirm={confirmDelete}\r\n                title=\"Delete Customer\"\r\n                message={`Are you sure you want to delete \"${customerToDelete?.name}\"? This action cannot be undone.`}\r\n                confirmText=\"Delete Customer\"\r\n                isDangerous={true}\r\n            />\r\n        </Layout>\r\n    );\r\n};\r\n\r\n// Customer Modal Component\r\nconst CustomerModal = ({ customer, onClose, onSuccess }) => {\r\n    const [formData, setFormData] = useState({\r\n        name: customer?.name || '',\r\n        phone: customer?.phone || '',\r\n        email: customer?.email || '',\r\n        address: customer?.address || '',\r\n        gstin: customer?.gstin || '',\r\n    });\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        setLoading(true);\r\n\r\n        try {\r\n            if (customer) {\r\n                await api.put(`/customers/${customer._id}`, formData);\r\n                toast.success('Customer updated successfully');\r\n            } else {\r\n                await api.post('/customers', formData);\r\n                toast.success('Customer added successfully');\r\n            }\r\n            onSuccess();\r\n        } catch (error) {\r\n            toast.error(error.response?.data?.message || 'Failed to save customer');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 backdrop-blur-sm\">\r\n            <div className=\"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full border border-gray-100 dark:border-gray-700\">\r\n                <div className=\"p-6 border-b-[2.5px] border-black dark:border-white/90 flex items-center justify-between\">\r\n                    <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\r\n                        {customer ? 'Edit Customer' : 'Add New Customer'}\r\n                    </h2>\r\n                    <button\r\n                        onClick={onClose}\r\n                        className=\"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors text-gray-500 dark:text-gray-400\"\r\n                    >\r\n                        <X className=\"w-6 h-6\" />\r\n                    </button>\r\n                </div>\r\n\r\n                <form onSubmit={handleSubmit} className=\"p-6 space-y-4\">\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                            Full Name *\r\n                        </label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={formData.name}\r\n                            onChange={(e) => setFormData({ ...formData, name: e.target.value })}\r\n                            className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400\"\r\n                            required\r\n                        />\r\n                    </div>\r\n\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                            Phone *\r\n                        </label>\r\n                        <input\r\n                            type=\"tel\"\r\n                            value={formData.phone}\r\n                            onChange={(e) => setFormData({ ...formData, phone: e.target.value })}\r\n                            className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400\"\r\n                            required\r\n                        />\r\n                    </div>\r\n\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                            Email\r\n                        </label>\r\n                        <input\r\n                            type=\"email\"\r\n                            value={formData.email}\r\n                            onChange={(e) => setFormData({ ...formData, email: e.target.value })}\r\n                            className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400\"\r\n                        />\r\n                    </div>\r\n\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                            Address\r\n                        </label>\r\n                        <textarea\r\n                            value={formData.address}\r\n                            onChange={(e) => setFormData({ ...formData, address: e.target.value })}\r\n                            className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400\"\r\n                            rows={3}\r\n                        />\r\n                    </div>\r\n\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                            GSTIN (Optional)\r\n                        </label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={formData.gstin}\r\n                            onChange={(e) => setFormData({ ...formData, gstin: e.target.value })}\r\n                            className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400\"\r\n                            placeholder=\"22AAAAA0000A1Z5\"\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center justify-end space-x-3 pt-4 border-t-[2.5px] border-black dark:border-white/90\">\r\n                        <button\r\n                            type=\"button\"\r\n                            onClick={onClose}\r\n                            className=\"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-gray-700 dark:text-gray-300\"\r\n                        >\r\n                            Cancel\r\n                        </button>\r\n                        <button\r\n                            type=\"submit\"\r\n                            disabled={loading}\r\n                            className=\"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50\"\r\n                        >\r\n                            {loading ? 'Saving...' : customer ? 'Update Customer' : 'Add Customer'}\r\n                        </button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Customers;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\pages\\Dashboard.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'expiringCount' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":43,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":43,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"expiringCount"},"fix":{"range":[1290,1303],"text":""},"desc":"Remove unused variable 'expiringCount'."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n  65 |\n  66 |     useEffect(() => {\n> 67 |         loadDashboardData();\n     |         ^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  68 |     }, [loadDashboardData]);\n  69 |\n  70 |     const getStatusColor = (status) => {","line":67,"column":9,"nodeType":null,"endLine":67,"endColumn":26}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport { useClientView } from '../context/ClientViewContext.jsx';\r\nimport Layout from '../components/Layout/Layout';\r\nimport api from '../utils/api';\r\nimport { formatINR } from '../utils/currency';\r\nimport LiquidBackground from '../components/UI/LiquidBackground';\r\nimport {\r\n    ShoppingCart,\r\n    Package,\r\n    IndianRupee,\r\n    AlertCircle,\r\n    TrendingUp,\r\n    Users,\r\n    FileText,\r\n    Wallet,\r\n    CreditCard,\r\n    History,\r\n    Activity,\r\n    Box,\r\n    Sparkles,\r\n    AlertTriangle\r\n} from 'lucide-react';\r\n\r\nconst Dashboard = () => {\r\n    const navigate = useNavigate();\r\n    const { user } = useAuth();\r\n    const { isClientView } = useClientView();\r\n    const [stats, setStats] = useState({\r\n        totalParties: 0,\r\n        totalItems: 0,\r\n        totalSales: 0,\r\n        totalInvoices: 0,\r\n        cashCollection: 0,\r\n        totalCollections: 0,\r\n        totalReceivables: 0,\r\n        totalPayables: 0,\r\n        recentInvoices: []\r\n    });\r\n    const [loading, setLoading] = useState(true);\r\n    const [lowStockProducts, setLowStockProducts] = useState([]); // Keep this if it's still used later\r\n    const [expiringCount, setExpiringCount] = useState(0);\r\n\r\n    const { recentInvoices } = stats;\r\n\r\n    const loadDashboardData = useCallback(async () => {\r\n        try {\r\n            setLoading(true);\r\n            const [statsRes, expiryRes] = await Promise.all([\r\n                api.get('/dashboard/stats'),\r\n                api.get('/products/expiry-alert?days=30')\r\n            ]);\r\n\r\n            setStats(statsRes.data);\r\n            setLowStockProducts(statsRes.data.lowStockProducts || []);\r\n            setExpiringCount(expiryRes.data.length);\r\n\r\n            setLoading(false);\r\n        } catch (error) {\r\n            console.error('Failed to load dashboard data:', error);\r\n            setLoading(false);\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        loadDashboardData();\r\n    }, [loadDashboardData]);\r\n\r\n    const getStatusColor = (status) => {\r\n        switch (status) {\r\n            case 'Paid':\r\n                return 'border-emerald-500/20 text-emerald-600 dark:text-emerald-400 bg-emerald-500/10';\r\n            case 'Partial':\r\n                return 'border-amber-500/20 text-amber-600 dark:text-amber-400 bg-amber-500/10';\r\n            case 'Due':\r\n            case 'Overdue':\r\n                return 'border-red-500/20 text-red-600 dark:text-red-400 bg-red-500/10';\r\n            default:\r\n                return 'border-gray-500/20 text-gray-600 dark:text-gray-400 bg-gray-500/10';\r\n        }\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <Layout>\r\n                <div className=\"flex items-center justify-center h-screen\">\r\n                    <div className=\"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-500\"></div>\r\n                </div>\r\n            </Layout>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <Layout>\r\n            <div className=\"p-8 relative\">\r\n                <LiquidBackground />\r\n                {/* Header */}\r\n                <div className=\"mb-8 relative\">\r\n                    <h1 className=\"text-4xl font-bold text-gray-900 dark:text-white tracking-tight\">Dashboard</h1>\r\n                    <p className=\"text-gray-600 dark:text-brand-300 mt-2 font-light\">\r\n                        Welcome back, <span className=\"font-semibold text-brand-600 dark:text-brand-400\">{user?.name}</span>.\r\n                    </p>\r\n                    {/* Decorative Dash */}\r\n                    <div className=\"w-24 h-1 bg-gradient-to-r from-brand-500 to-transparent mt-4 rounded-full\"></div>\r\n                </div>\r\n\r\n                {/* Top 4 Stat Cards - Premium Industrial Style */}\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6 mb-8\">\r\n                    {/* Total Parties (Blue) */}\r\n                    <div className=\"bg-blue-100 dark:bg-gradient-to-br dark:from-blue-950 dark:via-black dark:to-black rounded-2xl p-6 box-outline shadow-sm dark:shadow-[0_0_20px_rgba(59,130,246,0.15)] relative overflow-hidden group transition-all duration-300\">\r\n                        <div className=\"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-5 dark:opacity-20 bg-repeat\"></div>\r\n                        <div className=\"relative z-10 w-full\">\r\n                            <div className=\"flex items-start justify-between\">\r\n                                <div>\r\n                                    <p className=\"text-sm font-bold text-black dark:text-blue-200 uppercase tracking-widest\">Total Parties</p>\r\n                                    <p className=\"text-3xl lg:text-4xl font-black mt-2 text-black dark:text-transparent dark:bg-clip-text dark:bg-gradient-to-r dark:from-blue-100 dark:via-blue-300 dark:to-blue-500 font-mono\">\r\n                                        {stats.totalParties}\r\n                                    </p>\r\n                                </div>\r\n                                <div className=\"p-3 bg-white/80 dark:bg-blue-500/20 rounded-xl border border-brand-500/20 dark:border-brand-500/10 text-blue-500 dark:text-blue-300 group-hover:text-white group-hover:bg-blue-600 dark:group-hover:bg-blue-500 transition-all duration-300 shadow-sm dark:shadow-[0_0_15px_rgba(59,130,246,0.3)]\">\r\n                                    <Users className=\"w-6 h-6\" />\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"mt-4 h-1 w-full bg-blue-50 dark:bg-blue-900/30 rounded-full overflow-hidden\">\r\n                                <div className=\"h-full bg-blue-500 w-3/4 rounded-full shadow-[0_0_10px_rgba(59,130,246,0.5)]\"></div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Total Items (Green) */}\r\n                    <div className=\"bg-emerald-100 dark:bg-gradient-to-br dark:from-emerald-950 dark:via-black dark:to-black rounded-2xl p-6 box-outline shadow-sm dark:shadow-[0_0_20px_rgba(16,185,129,0.15)] relative overflow-hidden group transition-all duration-300\">\r\n                        <div className=\"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-5 dark:opacity-20 bg-repeat\"></div>\r\n                        <div className=\"relative z-10 w-full\">\r\n                            <div className=\"flex items-start justify-between\">\r\n                                <div>\r\n                                    <p className=\"text-sm font-bold text-black dark:text-emerald-200 uppercase tracking-widest\">Total Items</p>\r\n                                    <p className=\"text-3xl lg:text-4xl font-black mt-2 text-black dark:text-transparent dark:bg-clip-text dark:bg-gradient-to-r dark:from-emerald-100 dark:via-emerald-300 dark:to-emerald-500 font-mono\">\r\n                                        {stats.totalItems}\r\n                                    </p>\r\n                                </div>\r\n                                <div className=\"p-3 bg-white/80 dark:bg-emerald-500/20 rounded-xl border border-brand-500/20 dark:border-brand-500/10 text-emerald-500 dark:text-emerald-300 group-hover:text-white group-hover:bg-emerald-600 dark:group-hover:bg-emerald-500 transition-all duration-300 shadow-sm dark:shadow-[0_0_15px_rgba(16,185,129,0.3)]\">\r\n                                    <Package className=\"w-6 h-6\" />\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"mt-4 h-1 w-full bg-emerald-50 dark:bg-emerald-900/30 rounded-full overflow-hidden\">\r\n                                <div className=\"h-full bg-emerald-500 w-1/2 rounded-full shadow-[0_0_10px_rgba(16,185,129,0.5)]\"></div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Total Invoices (Fuchsia) */}\r\n                    <div className=\"bg-fuchsia-100 dark:bg-gradient-to-br dark:from-fuchsia-950 dark:via-black dark:to-black rounded-2xl p-6 box-outline shadow-sm dark:shadow-[0_0_20px_rgba(217,70,239,0.15)] relative overflow-hidden group transition-all duration-300\">\r\n                        <div className=\"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-5 dark:opacity-20 bg-repeat\"></div>\r\n                        <div className=\"relative z-10 w-full\">\r\n                            <div className=\"flex items-start justify-between\">\r\n                                <div>\r\n                                    <p className=\"text-sm font-bold text-black dark:text-fuchsia-200 uppercase tracking-widest\">Total Invoices</p>\r\n                                    <p className=\"text-3xl lg:text-4xl font-black mt-2 text-black dark:text-transparent dark:bg-clip-text dark:bg-gradient-to-r dark:from-fuchsia-100 dark:via-fuchsia-300 dark:to-fuchsia-500 font-mono\">\r\n                                        {stats.totalInvoices}\r\n                                    </p>\r\n                                </div>\r\n                                <div className=\"p-3 bg-white/80 dark:bg-fuchsia-500/20 rounded-xl border border-brand-500/20 dark:border-brand-500/10 text-fuchsia-500 dark:text-fuchsia-300 group-hover:text-white group-hover:bg-fuchsia-600 dark:group-hover:bg-fuchsia-500 transition-all duration-300 shadow-sm dark:shadow-[0_0_15px_rgba(217,70,239,0.3)]\">\r\n                                    <FileText className=\"w-6 h-6\" />\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"mt-4 h-1 w-full bg-fuchsia-50 dark:bg-fuchsia-900/30 rounded-full overflow-hidden\">\r\n                                <div className=\"h-full bg-fuchsia-500 w-2/3 rounded-full shadow-[0_0_10px_rgba(217,70,239,0.5)]\"></div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Total Sales (Indigo) */}\r\n                    <div className=\"bg-indigo-100 dark:bg-gradient-to-br dark:from-indigo-950 dark:via-black dark:to-black rounded-2xl p-6 box-outline shadow-sm dark:shadow-[0_0_20px_rgba(99,102,241,0.15)] relative overflow-hidden group transition-all duration-300\">\r\n                        <div className=\"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-5 dark:opacity-20 bg-repeat\"></div>\r\n                        <div className=\"relative z-10\">\r\n                            <div className=\"flex items-start justify-between\">\r\n                                <div>\r\n                                    <p className=\"text-sm font-bold text-black dark:text-indigo-200 uppercase tracking-widest\">Total Sales</p>\r\n                                    <p className=\"text-3xl lg:text-4xl font-black mt-2 text-black dark:text-transparent dark:bg-clip-text dark:bg-gradient-to-r dark:from-indigo-100 dark:via-indigo-300 dark:to-indigo-500 rupee font-mono\">\r\n                                        {formatINR(stats.totalSales)}\r\n                                    </p>\r\n                                </div>\r\n                                <div className=\"p-3 bg-white/80 dark:bg-indigo-500/20 rounded-xl border border-brand-500/20 dark:border-brand-500/10 text-indigo-500 dark:text-indigo-300 group-hover:text-white group-hover:bg-indigo-600 dark:group-hover:bg-indigo-500 transition-all duration-300 shadow-sm dark:shadow-[0_0_15px_rgba(99,102,241,0.3)]\">\r\n                                    <TrendingUp className=\"w-6 h-6\" />\r\n                                </div>\r\n                            </div>\r\n                            {(() => {\r\n                                const growth = stats.yesterdaySales > 0\r\n                                    ? ((stats.todaySales - stats.yesterdaySales) / stats.yesterdaySales) * 100\r\n                                    : (stats.todaySales > 0 ? 100 : 0);\r\n                                const isPositive = growth >= 0;\r\n\r\n                                return (\r\n                                    <div className=\"mt-6 flex items-center text-xs\">\r\n                                        <span className={`${isPositive ? 'bg-emerald-500/10 text-emerald-600 dark:text-emerald-400' : 'bg-red-500/10 text-red-600 dark:text-red-400'} px-2 py-1 rounded mr-2 font-bold`}>\r\n                                            {isPositive ? '+' : ''}{growth.toFixed(1)}%\r\n                                        </span>\r\n                                        <span className=\"font-bold uppercase tracking-tight text-indigo-600 dark:text-indigo-400\">\r\n                                            {isPositive ? 'Growth vs Yesterday' : 'Decrease vs Yesterday'}\r\n                                        </span>\r\n                                    </div>\r\n                                );\r\n                            })()}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Today's Collection Breakdown */}\r\n                <div className=\"mb-8\">\r\n                    <h2 className=\"text-xl font-bold text-gray-800 dark:text-white mb-6 flex items-center\">\r\n                        <span className=\"w-1 h-6 bg-brand-500 rounded-full mr-3\"></span>\r\n                        Today's Overview\r\n                    </h2>\r\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n                        {/* Cash Collection (Green) */}\r\n                        <div className=\"bg-gradient-to-br from-emerald-200 via-emerald-100 to-white dark:bg-gradient-to-br dark:from-emerald-950 dark:via-black dark:to-black rounded-xl p-5 box-outline shadow-lg shadow-emerald-200/50 dark:shadow-[0_0_15px_rgba(16,185,129,0.15)] relative overflow-hidden group transition-all duration-300\">\r\n                            <div className=\"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-5 dark:opacity-20 bg-repeat\"></div>\r\n                            <div className=\"relative z-10\">\r\n                                <div className=\"flex items-start justify-between\">\r\n                                    <div>\r\n                                        <p className=\"text-xs font-black text-black dark:text-emerald-200 uppercase tracking-wider\">Cash In Hand</p>\r\n                                        <p className=\"text-2xl font-black text-black dark:text-transparent dark:bg-clip-text dark:bg-gradient-to-r dark:from-emerald-100 dark:via-emerald-300 dark:to-emerald-500 mt-1 rupee font-mono\">\r\n                                            {formatINR(stats.cashCollection)}\r\n                                        </p>\r\n                                    </div>\r\n                                    <div className=\"p-2 bg-white/80 dark:bg-emerald-500/20 rounded-lg border border-brand-500/20 dark:border-brand-500/10 text-emerald-500 dark:text-emerald-300 group-hover:text-white group-hover:bg-emerald-600 dark:group-hover:bg-emerald-500 transition-all duration-300 shadow-sm dark:shadow-[0_0_10px_rgba(16,185,129,0.3)]\">\r\n                                        <Wallet className=\"w-4 h-4\" />\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"mt-4 absolute bottom-0 left-0 w-full h-1 bg-emerald-200/30 dark:bg-emerald-500/10\">\r\n                                    <div className=\"h-full bg-emerald-500/50 w-2/3 shadow-[0_0_10px_rgba(16,185,129,0.5)]\"></div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Online (UPI) (Yellow) */}\r\n                        <div className=\"bg-gradient-to-br from-amber-200 via-amber-100 to-white dark:bg-gradient-to-br dark:from-yellow-950 dark:via-black dark:to-black rounded-xl p-5 box-outline shadow-lg shadow-amber-200/50 dark:shadow-[0_0_15px_rgba(234,179,8,0.15)] relative overflow-hidden group transition-all duration-300\">\r\n                            <div className=\"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-5 dark:opacity-20 bg-repeat\"></div>\r\n                            <div className=\"relative z-10\">\r\n                                <div className=\"flex items-start justify-between\">\r\n                                    <div>\r\n                                        <p className=\"text-xs font-black text-black dark:text-yellow-200 uppercase tracking-wider\">Online (UPI)</p>\r\n                                        <p className=\"text-2xl font-black text-black dark:text-transparent dark:bg-clip-text dark:bg-gradient-to-r dark:from-yellow-100 dark:via-yellow-300 dark:to-yellow-500 mt-1 rupee font-mono\">\r\n                                            {formatINR(stats.onlineCollection)}\r\n                                        </p>\r\n                                    </div>\r\n                                    <div className=\"p-2 bg-white/80 dark:bg-yellow-500/20 rounded-lg border border-brand-500/20 dark:border-brand-500/10 text-amber-600 dark:text-yellow-300 group-hover:text-white group-hover:bg-yellow-500 transition-all duration-300 shadow-sm dark:shadow-[0_0_10px_rgba(234,179,8,0.3)]\">\r\n                                        <CreditCard className=\"w-4 h-4\" />\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"mt-4 absolute bottom-0 left-0 w-full h-1 bg-amber-200/30 dark:bg-yellow-50 dark:bg-yellow-500/10\">\r\n                                    <div className=\"h-full bg-yellow-500/50 w-3/4 shadow-[0_0_10px_rgba(234,179,8,0.5)]\"></div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Total Sale (Indigo) */}\r\n                        <div className=\"bg-gradient-to-br from-indigo-200 via-indigo-100 to-white dark:bg-gradient-to-br dark:from-indigo-950 dark:via-black dark:to-black rounded-xl p-5 box-outline shadow-lg shadow-indigo-200/50 dark:shadow-[0_0_15px_rgba(99,102,241,0.15)] relative overflow-hidden group transition-all duration-300\">\r\n                            <div className=\"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-5 dark:opacity-20 bg-repeat\"></div>\r\n                            <div className=\"relative z-10\">\r\n                                <div className=\"flex items-start justify-between\">\r\n                                    <div>\r\n                                        <p className=\"text-xs font-black text-black dark:text-indigo-200 uppercase tracking-wider\">Total Sales Today</p>\r\n                                        <p className=\"text-2xl font-black text-black dark:text-transparent dark:bg-clip-text dark:bg-gradient-to-r dark:from-indigo-100 dark:via-indigo-300 dark:to-indigo-500 mt-1 rupee font-mono\">\r\n                                            {formatINR(stats.todaySales)}\r\n                                        </p>\r\n                                    </div>\r\n                                    <div className=\"p-2 bg-white/80 dark:bg-indigo-500/20 rounded-lg border border-brand-500/20 dark:border-brand-500/10 text-indigo-500 dark:text-indigo-300 group-hover:bg-indigo-600 dark:group-hover:bg-indigo-500 group-hover:text-white transition-all duration-300 shadow-sm dark:shadow-[0_0_10px_rgba(99,102,241,0.3)]\">\r\n                                        <ShoppingCart className=\"w-4 h-4\" />\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"mt-4 absolute bottom-0 left-0 w-full h-1 bg-indigo-200/30 dark:bg-indigo-50 dark:bg-indigo-500/10\">\r\n                                    <div className=\"h-full bg-indigo-500/50 w-1/2 shadow-[0_0_10px_rgba(99,102,241,0.3)]\"></div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Credit (Udhaar) (Red) */}\r\n                        <div className=\"bg-gradient-to-br from-red-200 via-red-100 to-white dark:bg-gradient-to-br dark:from-red-950 dark:via-black dark:to-black rounded-xl p-5 box-outline shadow-lg shadow-red-200/50 dark:shadow-[0_0_15px_rgba(239,68,68,0.15)] relative overflow-hidden group transition-all duration-300\">\r\n                            <div className=\"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-5 dark:opacity-20 bg-repeat\"></div>\r\n                            <div className=\"relative z-10\">\r\n                                <div className=\"flex items-start justify-between\">\r\n                                    <div>\r\n                                        <p className=\"text-xs font-black text-black dark:text-red-200 uppercase tracking-wider\">Pending (Udhaar)</p>\r\n                                        <div className=\"mt-2 space-y-1\">\r\n                                            <div className=\"flex justify-between items-center text-sm\">\r\n                                                <span className=\"text-emerald-600 dark:text-emerald-400 font-bold\">To Take:</span>\r\n                                                <span className=\"font-mono font-black text-emerald-700 dark:text-emerald-300 rupee\">{formatINR(stats.totalReceivables)}</span>\r\n                                            </div>\r\n                                            <div className=\"flex justify-between items-center text-sm\">\r\n                                                <span className=\"text-red-600 dark:text-red-400 font-bold\">To Give:</span>\r\n                                                <span className=\"font-mono font-black text-red-700 dark:text-red-300 rupee\">{formatINR(stats.totalPayables || 0)}</span>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"p-2 bg-white/80 dark:bg-red-500/20 rounded-lg border border-brand-500/20 dark:border-brand-500/10 text-red-500 dark:text-red-300 group-hover:text-white group-hover:bg-red-600 dark:group-hover:bg-red-500 transition-all duration-300 shadow-sm dark:shadow-[0_0_10px_rgba(239,68,68,0.5)]\">\r\n                                        <AlertCircle className=\"w-4 h-4\" />\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"mt-4 absolute bottom-0 left-0 w-full h-1 bg-red-200/30 dark:bg-red-50 dark:bg-red-500/10\">\r\n                                    <div className=\"h-full bg-red-500/50 w-full shadow-[0_0_10px_rgba(239,68,68,0.5)]\"></div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Stock Widgets */}\r\n                {!isClientView && (\r\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6 mb-8\">\r\n                        {/* Stock Value Widget */}\r\n                        <div className=\"bg-sky-100 dark:bg-gradient-to-br dark:from-sky-950 dark:via-black dark:to-black p-6 rounded-2xl box-outline shadow-sm relative overflow-hidden group transition-all duration-300\">\r\n                            <div className=\"absolute -right-10 -top-10 w-40 h-40 bg-sky-500/10 rounded-full blur-3xl\"></div>\r\n                            <div className=\"flex items-center space-x-2\">\r\n                                <div className=\"p-2 bg-sky-500/20 rounded-lg text-sky-600 dark:text-sky-400 group-hover:text-white group-hover:bg-sky-600 dark:group-hover:bg-sky-500 transition-all duration-300 shadow-sm\">\r\n                                    <Box className=\"w-4 h-4\" />\r\n                                </div>\r\n                                <h3 className=\"text-black dark:text-sky-400 text-sm font-bold uppercase tracking-wider relative z-10\">Total Stock Value</h3>\r\n                            </div>\r\n                            <div className=\"mt-4 flex items-baseline relative z-10\">\r\n                                <span className=\"text-4xl font-black text-black dark:text-white rupee font-mono\">{formatINR(stats.totalStockValue)}</span>\r\n                                <span className=\"ml-2 text-sm text-sky-900 dark:text-sky-400 font-medium opacity-60\">asset value</span>\r\n                            </div>\r\n                            {/* Progress Bar (Visual only) */}\r\n                            <div className=\"mt-6 flex space-x-1\">\r\n                                {[...Array(10)].map((_, i) => (\r\n                                    <div key={i} className={`h-2 flex-1 rounded-full ${i < 7 ? 'bg-sky-500 shadow-[0_0_8px_rgba(14,165,233,0.4)]' : 'bg-sky-200/30 dark:bg-white/5'}`}></div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Profit Widget */}\r\n                        <div className=\"bg-emerald-100 dark:bg-gradient-to-br dark:from-emerald-950 dark:via-black dark:to-black p-6 rounded-2xl box-outline shadow-sm relative overflow-hidden group transition-all duration-300\">\r\n                            <div className=\"absolute -right-10 -bottom-10 w-40 h-40 bg-emerald-500/10 rounded-full blur-3xl\"></div>\r\n                            <div className=\"flex items-center space-x-2\">\r\n                                <div className=\"p-2 bg-emerald-500/20 rounded-lg text-emerald-600 dark:text-emerald-400 group-hover:text-white group-hover:bg-emerald-600 dark:group-hover:bg-emerald-500 transition-all duration-300 shadow-sm\">\r\n                                    <Sparkles className=\"w-4 h-4\" />\r\n                                </div>\r\n                                <h3 className=\"text-black dark:text-emerald-400 text-sm font-bold uppercase tracking-wider relative z-10\">Projected Profit</h3>\r\n                            </div>\r\n                            <div className=\"mt-4 flex items-baseline relative z-10\">\r\n                                <span className=\"text-4xl font-black text-black dark:text-white rupee font-mono\">{formatINR(stats.potentialProfit)}</span>\r\n                                <span className=\"ml-2 text-sm text-emerald-900 dark:text-emerald-400 font-medium opacity-60\">gross margin</span>\r\n                            </div>\r\n                            {/* Glow Line */}\r\n                            {(() => {\r\n                                const profitEfficiency = stats.totalSales > 0\r\n                                    ? Math.round((stats.potentialProfit / stats.totalSales) * 100)\r\n                                    : 0;\r\n\r\n                                return (\r\n                                    <>\r\n                                        <div className=\"mt-6 flex items-center justify-between text-xs\">\r\n                                            <span className=\"text-emerald-800/60 dark:text-gray-400 uppercase tracking-tighter font-bold\">Profit Efficiency</span>\r\n                                            <span className=\"text-emerald-600 dark:text-emerald-400 font-bold\">{profitEfficiency}%</span>\r\n                                        </div>\r\n                                        <div className=\"mt-2 h-1 bg-emerald-200/30 dark:bg-emerald-900/30 rounded-full overflow-hidden\">\r\n                                            <div className=\"h-full bg-emerald-500 rounded-full shadow-[0_0_10px_rgba(16,185,129,0.5)]\" style={{ width: `${Math.min(profitEfficiency, 100)}%` }}></div>\r\n                                        </div>\r\n                                    </>\r\n                                );\r\n                            })()}\r\n                        </div>\r\n\r\n\r\n                    </div>\r\n                )}\r\n\r\n                {/* Recent Invoices and Low Stock Items */}\r\n                <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6\">\r\n                    {/* Recent Invoices */}\r\n                    <div className=\"bg-violet-100 dark:bg-gray-900 rounded-2xl box-outline shadow-sm overflow-hidden transition-all duration-300\">\r\n                        <div className=\"p-6 border-b-[2.5px] border-black dark:border-white/90 flex items-center justify-between bg-violet-200/50 dark:bg-violet-950/10\">\r\n                            <div className=\"flex items-center space-x-3\">\r\n                                <div className=\"p-2 bg-violet-500/10 rounded-lg\">\r\n                                    <TrendingUp className=\"w-5 h-5 text-violet-500\" />\r\n                                </div>\r\n                                <h2 className=\"text-xl font-bold text-gray-900 dark:text-white\">Live Transactions</h2>\r\n                            </div>\r\n                            <button\r\n                                onClick={() => navigate('/invoices')}\r\n                                className=\"text-xs font-bold text-violet-600 dark:text-violet-400 hover:text-violet-500 uppercase tracking-widest border border-violet-500/20 px-4 py-2 rounded-lg hover:bg-violet-500/10 transition-all duration-300\"\r\n                            >\r\n                                View All\r\n                            </button>\r\n                        </div>\r\n                        <div className=\"p-4\">\r\n                            {recentInvoices.length === 0 ? (\r\n                                <div className=\"text-center py-20 text-gray-400 dark:text-gray-500 relative group\">\r\n                                    <div className=\"relative inline-block mb-6\">\r\n                                        <div className=\"absolute inset-0 bg-violet-500/20 blur-2xl rounded-full scale-150 group-hover:bg-violet-500/30 transition-all duration-700\"></div>\r\n                                        <div className=\"relative z-10 w-24 h-24 bg-white dark:bg-violet-950/20 rounded-full flex items-center justify-center border border-violet-100 dark:border-violet-500/20 shadow-lg group-hover:scale-110 transition-transform duration-500\">\r\n                                            <History className=\"w-12 h-12 text-violet-500/40 group-hover:text-violet-500 transition-colors duration-500\" />\r\n                                        </div>\r\n                                    </div>\r\n                                    <h3 className=\"text-lg font-bold text-gray-900 dark:text-white tracking-tight\">System Ready</h3>\r\n                                    <p className=\"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-[0.2em] mt-2\">Waiting for new transactions</p>\r\n                                </div>\r\n                            ) : (\r\n                                <div className=\"space-y-2\">\r\n                                    {recentInvoices.map((invoice) => (\r\n                                        <div\r\n                                            key={invoice._id}\r\n                                            className=\"flex items-center justify-between p-4 bg-white/60 dark:bg-white/5 hover:bg-white dark:hover:bg-violet-500/5 rounded-xl transition-all duration-300 cursor-pointer border border-violet-200/50 hover:border-violet-500/50 hover:shadow-md group\"\r\n                                            onClick={() => navigate(`/invoices`)}\r\n                                        >\r\n                                            <div className=\"flex items-center space-x-4\">\r\n                                                <div className=\"w-12 h-12 rounded-xl bg-violet-50 dark:bg-white/5 border border-violet-200 dark:border-brand-500/30 flex items-center justify-center text-violet-400 group-hover:text-violet-600 transition-colors shadow-sm\">\r\n                                                    <FileText className=\"w-6 h-6\" />\r\n                                                </div>\r\n                                                <div>\r\n                                                    <p className=\"font-black text-black dark:text-white font-mono text-sm tracking-tight\">{invoice.invoiceNo}</p>\r\n                                                    <p className=\"text-xs font-medium text-gray-500 dark:text-gray-400\">\r\n                                                        {invoice.customer?.name || 'Walk-in Customer'}\r\n                                                    </p>\r\n                                                </div>\r\n                                            </div>\r\n                                            <div className=\"text-right\">\r\n                                                <p className=\"font-black text-black dark:text-white rupee text-base font-mono tracking-tighter\">\r\n                                                    {formatINR(invoice.grandTotal)}\r\n                                                </p>\r\n                                                <span className={`mt-1 inline-flex items-center px-2.5 py-0.5 rounded-full text-[10px] font-bold uppercase tracking-widest border ${getStatusColor(invoice.status)}`}>\r\n                                                    {invoice.status}\r\n                                                </span>\r\n                                            </div>\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Low Stock Items */}\r\n                    <div className=\"bg-red-100 dark:bg-gray-900 rounded-2xl box-outline shadow-sm overflow-hidden transition-all duration-300\">\r\n                        <div className=\"p-6 border-b-[2.5px] border-black dark:border-white/90 flex items-center justify-between bg-red-200/50 dark:bg-red-950/20\">\r\n                            <div className=\"flex items-center space-x-3\">\r\n                                <div className={`p-2 rounded-lg ${lowStockProducts.length > 0 ? 'bg-red-500/20 text-red-500 animate-pulse' : 'bg-emerald-500/20 text-emerald-500'}`}>\r\n                                    <AlertCircle className=\"w-5 h-5\" />\r\n                                </div>\r\n                                <h2 className=\"text-xl font-bold text-gray-900 dark:text-white\">Stock Alerts</h2>\r\n                            </div>\r\n                            {lowStockProducts.length > 0 && (\r\n                                <span className=\"bg-red-600 text-white text-[10px] font-black px-2 py-1 rounded-full animate-bounce\">\r\n                                    {lowStockProducts.length} CRITICAL\r\n                                </span>\r\n                            )}\r\n                        </div>\r\n                        <div className=\"p-4\">\r\n                            {lowStockProducts.length === 0 ? (\r\n                                <div className=\"py-12 bg-red-50/50 dark:bg-red-950/10 rounded-xl border border-red-200 dark:border-brand-500/70 flex flex-col items-center justify-center relative overflow-hidden group\">\r\n                                    <div className=\"absolute inset-0 bg-gradient-to-br from-red-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-700\"></div>\r\n                                    <div className=\"relative z-10 w-20 h-20 bg-white dark:bg-red-500/20 rounded-full flex items-center justify-center shadow-lg border border-red-100 dark:border-red-500/30 mb-4 transition-transform duration-500 group-hover:scale-110\">\r\n                                        <Package className=\"w-10 h-10 text-red-500\" />\r\n                                    </div>\r\n                                    <h3 className=\"text-xl font-bold text-red-700 dark:text-red-400 tracking-tight relative z-10\">All Systems Optimal</h3>\r\n                                    <p className=\"text-red-600/60 dark:text-red-400/40 text-xs mt-1 font-medium uppercase tracking-widest relative z-10\">Inventory secure</p>\r\n                                </div>\r\n                            ) : (\r\n                                <div className=\"space-y-2\">\r\n                                    {lowStockProducts.map((product) => (\r\n                                        <div\r\n                                            key={product._id}\r\n                                            className=\"flex items-center justify-between p-4 bg-white/60 dark:bg-red-900/10 hover:bg-white dark:hover:bg-red-900/20 rounded-xl border border-red-200 hover:border-red-500/50 transition-all duration-300 group\"\r\n                                        >\r\n                                            <div className=\"flex items-center space-x-4\">\r\n                                                {product.image ? (\r\n                                                    <img\r\n                                                        src={product.image}\r\n                                                        alt={product.name}\r\n                                                        className=\"w-12 h-12 rounded-xl bg-gray-900 object-cover shadow-sm group-hover:scale-110 transition-transform duration-300\"\r\n                                                    />\r\n                                                ) : (\r\n                                                    <div className=\"w-12 h-12 rounded-xl bg-white dark:bg-gray-800 border border-gray-100 dark:border-white/10 flex items-center justify-center shadow-sm\">\r\n                                                        <Package className=\"w-6 h-6 text-red-500/50\" />\r\n                                                    </div>\r\n                                                )}\r\n                                                <div>\r\n                                                    <p className=\"font-black text-black dark:text-white text-sm tracking-tight\">{product.name}</p>\r\n                                                    <p className=\"text-[10px] font-bold text-red-500/60 dark:text-red-400/40 uppercase tracking-widest\">{product.category}</p>\r\n                                                </div>\r\n                                            </div>\r\n                                            <div className=\"text-right\">\r\n                                                <p className=\"text-xl font-black text-red-700 dark:text-red-500 font-mono tracking-tighter\">\r\n                                                    {product.stock}\r\n                                                </p>\r\n                                                <p className=\"text-[10px] font-bold text-gray-400 dark:text-gray-500 uppercase tracking-tighter\">remaining</p>\r\n                                            </div>\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </Layout>\r\n    );\r\n};\r\n\r\nexport default Dashboard;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\pages\\Daybook.jsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n  58 |\n  59 |     useEffect(() => {\n> 60 |         loadDaybook();\n     |         ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  61 |     }, [loadDaybook]);\n  62 |\n  63 |     const handleDelete = (id) => {","line":60,"column":9,"nodeType":null,"endLine":60,"endColumn":20}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport Layout from '../components/Layout/Layout';\r\nimport ConfirmationModal from '../components/ConfirmationModal';\r\nimport api from '../utils/api';\r\nimport { formatINR } from '../utils/currency';\r\nimport { formatDate } from '../utils/date';\r\nimport {\r\n    BookOpen,\r\n    Calendar,\r\n    TrendingUp,\r\n    TrendingDown,\r\n    IndianRupee,\r\n    ArrowUpCircle,\r\n    ArrowDownCircle,\r\n    Trash2,\r\n    ChevronDown,\r\n    ChevronRight,\r\n    Eye,\r\n    Banknote,\r\n    CreditCard,\r\n    Smartphone,\r\n    Building2,\r\n    Wallet,\r\n    Edit\r\n} from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\nimport RecordPaymentModal from '../components/RecordPaymentModal';\r\nimport AdjustBalanceModal from '../components/AdjustBalanceModal';\r\n\r\n\r\nconst Daybook = () => {\r\n    const navigate = useNavigate();\r\n    const [selectedDate, setSelectedDate] = useState(new Date().toLocaleDateString('en-CA'));\r\n    const [daybookData, setDaybookData] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [expandedRows, setExpandedRows] = useState(new Set());\r\n\r\n    const [isDeleteModalOpen, setIsDeleteModalOpen] = useState(false);\r\n    const [isPaymentModalOpen, setIsPaymentModalOpen] = useState(false);\r\n    const [isAdjustModalOpen, setIsAdjustModalOpen] = useState(false);\r\n    const [transactionToDelete, setTransactionToDelete] = useState(null);\r\n\r\n    const loadDaybook = useCallback(async () => {\r\n        try {\r\n            setLoading(true);\r\n            // Safety check: use today's date if selectedDate is empty\r\n            const dateToFetch = selectedDate || new Date().toLocaleDateString('en-CA');\r\n            const { data } = await api.get(`/ledger/daybook?date=${dateToFetch}`);\r\n            setDaybookData(data);\r\n            setLoading(false);\r\n        } catch (error) {\r\n            console.error('Failed to load daybook:', error);\r\n            toast.error('Failed to load daybook');\r\n            setLoading(false);\r\n        }\r\n    }, [selectedDate]);\r\n\r\n    useEffect(() => {\r\n        loadDaybook();\r\n    }, [loadDaybook]);\r\n\r\n    const handleDelete = (id) => {\r\n        setTransactionToDelete(id);\r\n        setIsDeleteModalOpen(true);\r\n    };\r\n\r\n    const confirmDelete = async () => {\r\n        if (!transactionToDelete) return;\r\n\r\n        try {\r\n            await api.delete(`/payments/${transactionToDelete}`);\r\n            toast.success('Transaction deleted');\r\n            loadDaybook();\r\n            setIsDeleteModalOpen(false);\r\n            setTransactionToDelete(null);\r\n        } catch (error) {\r\n            console.error(error);\r\n            toast.error('Failed to delete transaction');\r\n        }\r\n    };\r\n\r\n    const getTotalCashIn = () => {\r\n        if (!daybookData?.transactions) return 0;\r\n        return daybookData.transactions\r\n            .filter(t => t.type === 'Sale' || t.type === 'Invoice')\r\n            .reduce((sum, t) => sum + t.amount, 0);\r\n    };\r\n\r\n    const getTotalCashOut = () => {\r\n        if (!daybookData?.transactions) return 0;\r\n        return daybookData.transactions\r\n            .filter(t => t.type === 'Purchase' || t.type === 'Expense' || t.type === 'Drawing')\r\n            .reduce((sum, t) => sum + t.amount, 0);\r\n    };\r\n\r\n    const getClosingBalance = () => {\r\n        const opening = daybookData?.openingBalance || 0;\r\n        const cashIn = getTotalCashIn();\r\n        const cashOut = getTotalCashOut();\r\n        return opening + cashIn - cashOut;\r\n    };\r\n\r\n    const toggleRowExpand = (transactionId) => {\r\n        const newExpanded = new Set(expandedRows);\r\n        if (newExpanded.has(transactionId)) {\r\n            newExpanded.delete(transactionId);\r\n        } else {\r\n            newExpanded.add(transactionId);\r\n        }\r\n        setExpandedRows(newExpanded);\r\n    };\r\n\r\n    const getPaymentModeIcon = (mode) => {\r\n        switch (mode?.toLowerCase()) {\r\n            case 'cash':\r\n                return <Banknote className=\"w-4 h-4\" />;\r\n            case 'bank transfer':\r\n            case 'bank':\r\n                return <Building2 className=\"w-4 h-4\" />;\r\n            case 'card':\r\n            case 'credit card':\r\n            case 'debit card':\r\n                return <CreditCard className=\"w-4 h-4\" />;\r\n            case 'upi':\r\n            case 'online':\r\n                return <Smartphone className=\"w-4 h-4\" />;\r\n            default:\r\n                return <Wallet className=\"w-4 h-4\" />;\r\n        }\r\n    };\r\n\r\n    const getPaymentModeColor = (mode) => {\r\n        switch (mode?.toLowerCase()) {\r\n            case 'cash':\r\n                return 'bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400';\r\n            case 'bank transfer':\r\n            case 'bank':\r\n                return 'bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400';\r\n            case 'card':\r\n            case 'credit card':\r\n            case 'debit card':\r\n                return 'bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400';\r\n            case 'upi':\r\n            case 'online':\r\n                return 'bg-indigo-100 text-indigo-700 dark:bg-indigo-900/30 dark:text-indigo-400';\r\n            default:\r\n                return 'bg-gray-100 text-gray-700 dark:bg-gray-900/30 dark:text-gray-400';\r\n        }\r\n    };\r\n\r\n    const navigateToPartyLedger = (party, type) => {\r\n        if (!party?._id) return;\r\n\r\n        if (type === 'Customer') {\r\n            navigate(`/customers/${party._id}/ledger`);\r\n        } else if (type === 'Supplier' || type === 'Expense') {\r\n            navigate(`/expenses/${party._id}/ledger`);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Layout>\r\n            <div className=\"p-6\">\r\n                {/* Header */}\r\n                <div className=\"flex items-center justify-between mb-6\">\r\n                    <div>\r\n                        <h1 className=\"text-3xl font-bold text-gray-900 dark:text-white\">Daybook</h1>\r\n                        <p className=\"text-gray-600 dark:text-gray-400 mt-1\">Daily cash flow and transactions</p>\r\n                    </div>\r\n                    <div className=\"flex items-center space-x-3\">\r\n                        <button\r\n                            onClick={() => setIsPaymentModalOpen(true)}\r\n                            className=\"bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-700 transition\"\r\n                        >\r\n                            + Record Payment\r\n                        </button>\r\n                        <Calendar className=\"w-5 h-5 text-gray-400\" />\r\n                        <input\r\n                            type=\"date\"\r\n                            value={selectedDate}\r\n                            onChange={(e) => setSelectedDate(e.target.value)}\r\n                            className=\"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\r\n                        />\r\n                    </div>\r\n                </div>\r\n\r\n                {loading ? (\r\n                    <div className=\"text-center py-12\">\r\n                        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto\"></div>\r\n                    </div>\r\n                ) : (\r\n                    <>\r\n                        {/* Summary Cards - Kept vibrant but could add dark shadows/borders if needed */}\r\n                        {/* Summary Cards - Premium Dashboard Style */}\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8\">\r\n                            {/* Opening Balance (Blue) */}\r\n                            <div className=\"bg-gradient-to-r from-blue-50 via-white to-white dark:bg-gradient-to-br dark:from-blue-950 dark:via-black dark:to-black rounded-2xl p-6 border-4 border-blue-200 dark:border-blue-500/30 shadow-sm dark:shadow-[0_0_20px_rgba(59,130,246,0.15)] relative overflow-hidden group transition-all duration-300\">\r\n                                <div className=\"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-5 dark:opacity-20 bg-repeat\"></div>\r\n                                <div className=\"relative z-10 w-full\">\r\n                                    <div className=\"flex items-start justify-between\">\r\n                                        <div>\r\n                                            <div className=\"flex items-center gap-2\">\r\n                                                <p className=\"text-sm font-medium text-blue-800/60 dark:text-blue-200 uppercase tracking-widest\">Opening Balance</p>\r\n                                                <button\r\n                                                    onClick={(e) => { e.stopPropagation(); setIsAdjustModalOpen(true); }}\r\n                                                    className=\"p-1 hover:bg-blue-100 dark:hover:bg-blue-900 rounded text-blue-500 transition-colors\"\r\n                                                    title=\"Adjust Opening Balance\"\r\n                                                >\r\n                                                    <Edit className=\"w-3.5 h-3.5\" />\r\n                                                </button>\r\n                                            </div>\r\n                                            <p className=\"text-2xl lg:text-3xl font-bold mt-2 text-blue-600 dark:text-transparent dark:bg-clip-text dark:bg-gradient-to-r dark:from-blue-100 dark:via-blue-300 dark:to-blue-500 font-mono\">\r\n                                                {formatINR(daybookData?.openingBalance || 0)}\r\n                                            </p>\r\n                                        </div>\r\n                                        <div className=\"p-3 bg-white/80 dark:bg-blue-500/20 rounded-xl border border-blue-100 dark:border-blue-500/30 text-blue-500 dark:text-blue-300 group-hover:text-white group-hover:bg-blue-600 dark:group-hover:bg-blue-500 transition-all duration-300 shadow-sm dark:shadow-[0_0_15px_rgba(59,130,246,0.3)]\">\r\n                                            <IndianRupee className=\"w-6 h-6\" />\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"mt-4 h-1 w-full bg-blue-50 dark:bg-blue-900/30 rounded-full overflow-hidden\">\r\n                                        <div className=\"h-full bg-blue-500 w-full rounded-full shadow-[0_0_10px_rgba(59,130,246,0.5)]\"></div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Total Cash In (Green) */}\r\n                            <div className=\"bg-gradient-to-r from-emerald-50 via-white to-white dark:bg-gradient-to-br dark:from-emerald-950 dark:via-black dark:to-black rounded-2xl p-6 border-4 border-emerald-200 dark:border-emerald-500/30 shadow-sm dark:shadow-[0_0_20px_rgba(16,185,129,0.15)] relative overflow-hidden group transition-all duration-300\">\r\n                                <div className=\"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-5 dark:opacity-20 bg-repeat\"></div>\r\n                                <div className=\"relative z-10 w-full\">\r\n                                    <div className=\"flex items-start justify-between\">\r\n                                        <div>\r\n                                            <p className=\"text-sm font-medium text-emerald-800/60 dark:text-emerald-200 uppercase tracking-widest\">Total Cash In</p>\r\n                                            <p className=\"text-2xl lg:text-3xl font-bold mt-2 text-emerald-600 dark:text-transparent dark:bg-clip-text dark:bg-gradient-to-r dark:from-emerald-100 dark:via-emerald-300 dark:to-emerald-500 font-mono\">\r\n                                                {formatINR(getTotalCashIn())}\r\n                                            </p>\r\n                                        </div>\r\n                                        <div className=\"p-3 bg-white/80 dark:bg-emerald-500/20 rounded-xl border border-emerald-100 dark:border-emerald-500/30 text-emerald-500 dark:text-emerald-300 group-hover:text-white group-hover:bg-emerald-600 dark:group-hover:bg-emerald-500 transition-all duration-300 shadow-sm dark:shadow-[0_0_15px_rgba(16,185,129,0.3)]\">\r\n                                            <ArrowDownCircle className=\"w-6 h-6\" />\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"mt-4 h-1 w-full bg-emerald-50 dark:bg-emerald-900/30 rounded-full overflow-hidden\">\r\n                                        <div className=\"h-full bg-emerald-500 w-3/4 rounded-full shadow-[0_0_10px_rgba(16,185,129,0.5)]\"></div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Total Cash Out (Red) */}\r\n                            <div className=\"bg-gradient-to-r from-red-50 via-white to-white dark:bg-gradient-to-br dark:from-red-950 dark:via-black dark:to-black rounded-2xl p-6 border-4 border-red-200 dark:border-red-500/30 shadow-sm dark:shadow-[0_0_20px_rgba(239,68,68,0.15)] relative overflow-hidden group transition-all duration-300\">\r\n                                <div className=\"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-5 dark:opacity-20 bg-repeat\"></div>\r\n                                <div className=\"relative z-10 w-full\">\r\n                                    <div className=\"flex items-start justify-between\">\r\n                                        <div>\r\n                                            <p className=\"text-sm font-medium text-red-800/60 dark:text-red-200 uppercase tracking-widest\">Total Cash Out</p>\r\n                                            <p className=\"text-2xl lg:text-3xl font-bold mt-2 text-red-600 dark:text-transparent dark:bg-clip-text dark:bg-gradient-to-r dark:from-red-100 dark:via-red-300 dark:to-red-500 font-mono\">\r\n                                                {formatINR(getTotalCashOut())}\r\n                                            </p>\r\n                                        </div>\r\n                                        <div className=\"p-3 bg-white/80 dark:bg-red-500/20 rounded-xl border border-red-100 dark:border-red-500/30 text-red-500 dark:text-red-300 group-hover:text-white group-hover:bg-red-600 dark:group-hover:bg-red-500 transition-all duration-300 shadow-sm dark:shadow-[0_0_15px_rgba(239,68,68,0.3)]\">\r\n                                            <ArrowUpCircle className=\"w-6 h-6\" />\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"mt-4 h-1 w-full bg-red-50 dark:bg-red-900/30 rounded-full overflow-hidden\">\r\n                                        <div className=\"h-full bg-red-500 w-3/4 rounded-full shadow-[0_0_10px_rgba(239,68,68,0.5)]\"></div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Closing Balance (Purple) */}\r\n                            <div className=\"bg-gradient-to-r from-purple-50 via-white to-white dark:bg-gradient-to-br dark:from-purple-950 dark:via-black dark:to-black rounded-2xl p-6 border-4 border-purple-200 dark:border-purple-500/30 shadow-sm dark:shadow-[0_0_20px_rgba(168,85,247,0.15)] relative overflow-hidden group transition-all duration-300\">\r\n                                <div className=\"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-5 dark:opacity-20 bg-repeat\"></div>\r\n                                <div className=\"relative z-10 w-full\">\r\n                                    <div className=\"flex items-start justify-between\">\r\n                                        <div>\r\n                                            <p className=\"text-sm font-medium text-purple-800/60 dark:text-purple-200 uppercase tracking-widest\">Closing Balance</p>\r\n                                            <p className=\"text-2xl lg:text-3xl font-bold mt-2 text-purple-600 dark:text-transparent dark:bg-clip-text dark:bg-gradient-to-r dark:from-purple-100 dark:via-purple-300 dark:to-purple-500 font-mono\">\r\n                                                {formatINR(getClosingBalance())}\r\n                                            </p>\r\n                                        </div>\r\n                                        <div className=\"p-3 bg-white/80 dark:bg-purple-500/20 rounded-xl border border-purple-100 dark:border-purple-500/30 text-purple-500 dark:text-purple-300 group-hover:text-white group-hover:bg-purple-600 dark:group-hover:bg-purple-500 transition-all duration-300 shadow-sm dark:shadow-[0_0_15px_rgba(168,85,247,0.3)]\">\r\n                                            <TrendingUp className=\"w-6 h-6\" />\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"mt-4 h-1 w-full bg-purple-50 dark:bg-purple-900/30 rounded-full overflow-hidden\">\r\n                                        <div className=\"h-full bg-purple-500 w-full rounded-full shadow-[0_0_10px_rgba(168,85,247,0.5)]\"></div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Transactions Table */}\r\n                        <div className=\"bg-blue-50/40 dark:bg-blue-900/10 box-outline p-6 transition-all duration-300\">\r\n                            <div className=\"flex flex-wrap gap-4 items-center justify-between border-b-[2.5px] border-black dark:border-white/90 pb-4 mb-4\">\r\n                                <h2 className=\"text-xl font-semibold text-gray-900 dark:text-white flex items-center\">\r\n                                    <BookOpen className=\"w-5 h-5 mr-2 text-blue-500\" />\r\n                                    Transactions for {formatDate(selectedDate)}\r\n                                </h2>\r\n                            </div>\r\n\r\n                            {!daybookData?.transactions || daybookData.transactions.length === 0 ? (\r\n                                <div className=\"text-center py-12 text-gray-500 dark:text-gray-400\">\r\n                                    <BookOpen className=\"w-16 h-16 mx-auto mb-4 opacity-50\" />\r\n                                    <p className=\"text-lg\">No transactions for this date</p>\r\n                                </div>\r\n                            ) : (\r\n                                <div className=\"overflow-x-auto max-h-[600px] overflow-y-auto custom-scrollbar\">\r\n                                    <table className=\"w-full relative\">\r\n                                        <thead className=\"bg-gray-50 dark:bg-gray-700/50 border-b-[2.5px] border-black dark:border-white/90 sticky top-0 z-10 shadow-sm\">\r\n                                            <tr>\r\n                                                <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider bg-gray-50 dark:bg-gray-700 w-12\">\r\n                                                    {/* Expand icon */}\r\n                                                </th>\r\n                                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider bg-gray-50 dark:bg-gray-700\">\r\n                                                    Type\r\n                                                </th>\r\n                                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider bg-gray-50 dark:bg-gray-700\">\r\n                                                    Description\r\n                                                </th>\r\n                                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider bg-gray-50 dark:bg-gray-700\">\r\n                                                    Party\r\n                                                </th>\r\n                                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider bg-gray-50 dark:bg-gray-700\">\r\n                                                    Payment Mode\r\n                                                </th>\r\n                                                <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider bg-gray-50 dark:bg-gray-700\">\r\n                                                    Cash In\r\n                                                </th>\r\n                                                <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider bg-gray-50 dark:bg-gray-700\">\r\n                                                    Cash Out\r\n                                                </th>\r\n                                                <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider bg-gray-50 dark:bg-gray-700\">\r\n                                                    Balance\r\n                                                </th>\r\n                                                <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider bg-gray-50 dark:bg-gray-700\">\r\n                                                    Actions\r\n                                                </th>\r\n                                            </tr>\r\n                                        </thead>\r\n                                        <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\r\n                                            {daybookData.transactions.map((transaction, index) => {\r\n                                                const isCashIn = transaction.type === 'Sale' || transaction.type === 'Invoice';\r\n                                                const runningBalance = daybookData.openingBalance +\r\n                                                    daybookData.transactions\r\n                                                        .slice(0, index + 1)\r\n                                                        .reduce((sum, t) => {\r\n                                                            const isInc = t.type === 'Sale' || t.type === 'Invoice';\r\n                                                            return sum + (isInc ? t.amount : -t.amount);\r\n                                                        }, 0);\r\n                                                const isExpanded = expandedRows.has(transaction._id);\r\n                                                const hasDetails = transaction.notes || transaction.billNumber;\r\n\r\n                                                return (\r\n                                                    <React.Fragment key={transaction._id}>\r\n                                                        <tr className=\"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors\">\r\n                                                            {/* Expand Icon */}\r\n                                                            <td className=\"px-4 py-4\">\r\n                                                                {hasDetails && (\r\n                                                                    <button\r\n                                                                        onClick={() => toggleRowExpand(transaction._id)}\r\n                                                                        className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors\"\r\n                                                                        title={isExpanded ? \"Collapse details\" : \"View details\"}\r\n                                                                    >\r\n                                                                        {isExpanded ? (\r\n                                                                            <ChevronDown className=\"w-4 h-4\" />\r\n                                                                        ) : (\r\n                                                                            <ChevronRight className=\"w-4 h-4\" />\r\n                                                                        )}\r\n                                                                    </button>\r\n                                                                )}\r\n                                                            </td>\r\n\r\n                                                            {/* Type */}\r\n                                                            <td className=\"px-6 py-4\">\r\n                                                                <span className={`inline-block px-3 py-1 rounded-full text-xs font-semibold ${transaction.type === 'Sale' || transaction.type === 'Invoice'\r\n                                                                    ? 'bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400'\r\n                                                                    : transaction.type === 'Purchase' || transaction.type === 'Expense' || transaction.type === 'Drawing'\r\n                                                                        ? 'bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400'\r\n                                                                        : 'bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400'\r\n                                                                    }`}>\r\n                                                                    {transaction.type}\r\n                                                                </span>\r\n                                                            </td>\r\n\r\n                                                            {/* Description */}\r\n                                                            <td className=\"px-6 py-4 text-sm text-gray-900 dark:text-white\">\r\n                                                                {transaction.description}\r\n                                                            </td>\r\n\r\n                                                            {/* Party - Clickable */}\r\n                                                            <td className=\"px-6 py-4 text-sm\">\r\n                                                                {transaction.party?.name ? (\r\n                                                                    <button\r\n                                                                        onClick={() => navigateToPartyLedger(transaction.party, transaction.partyType)}\r\n                                                                        className=\"text-blue-600 dark:text-blue-400 hover:underline font-medium\"\r\n                                                                        title={`View ${transaction.party.name}'s ledger`}\r\n                                                                    >\r\n                                                                        {transaction.party.name}\r\n                                                                    </button>\r\n                                                                ) : (\r\n                                                                    <span className=\"text-gray-400\">-</span>\r\n                                                                )}\r\n                                                            </td>\r\n\r\n                                                            {/* Payment Mode */}\r\n                                                            <td className=\"px-6 py-4\">\r\n                                                                {transaction.paymentMode ? (\r\n                                                                    <span className={`inline-flex items-center space-x-2 px-3 py-1 rounded-full text-xs font-semibold ${getPaymentModeColor(transaction.paymentMode)}`}>\r\n                                                                        {getPaymentModeIcon(transaction.paymentMode)}\r\n                                                                        <span>{transaction.paymentMode}</span>\r\n                                                                    </span>\r\n                                                                ) : (\r\n                                                                    <span className=\"text-gray-400 text-xs\">-</span>\r\n                                                                )}\r\n                                                            </td>\r\n\r\n                                                            {/* Cash In */}\r\n                                                            <td className=\"px-6 py-4 text-right text-sm font-semibold text-green-600 dark:text-green-400 rupee\">\r\n                                                                {isCashIn ? formatINR(transaction.amount) : '-'}\r\n                                                            </td>\r\n\r\n                                                            {/* Cash Out */}\r\n                                                            <td className=\"px-6 py-4 text-right text-sm font-semibold text-red-600 dark:text-red-400 rupee\">\r\n                                                                {!isCashIn ? formatINR(transaction.amount) : '-'}\r\n                                                            </td>\r\n\r\n                                                            {/* Balance */}\r\n                                                            <td className=\"px-6 py-4 text-right text-sm font-bold text-gray-900 dark:text-white rupee\">\r\n                                                                {formatINR(runningBalance)}\r\n                                                            </td>\r\n\r\n                                                            {/* Actions */}\r\n                                                            <td className=\"px-6 py-4 text-right\">\r\n                                                                <div className=\"flex items-center justify-end space-x-2\">\r\n                                                                    {hasDetails && (\r\n                                                                        <button\r\n                                                                            onClick={() => toggleRowExpand(transaction._id)}\r\n                                                                            className=\"text-gray-400 hover:text-indigo-500 p-1 rounded hover:bg-indigo-50 dark:hover:bg-indigo-900/20 transition-colors\"\r\n                                                                            title=\"View Details\"\r\n                                                                        >\r\n                                                                            <Eye className=\"w-4 h-4\" />\r\n                                                                        </button>\r\n                                                                    )}\r\n                                                                    <button\r\n                                                                        onClick={() => handleDelete(transaction._id)}\r\n                                                                        className=\"text-red-500 hover:text-red-700 p-1 rounded hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors\"\r\n                                                                        title=\"Delete Transaction\"\r\n                                                                    >\r\n                                                                        <Trash2 className=\"w-4 h-4\" />\r\n                                                                    </button>\r\n                                                                </div>\r\n                                                            </td>\r\n                                                        </tr>\r\n\r\n                                                        {/* Expandable Detail Row */}\r\n                                                        {isExpanded && hasDetails && (\r\n                                                            <tr className=\"bg-gray-50 dark:bg-gray-800/50\">\r\n                                                                <td colSpan=\"9\" className=\"px-6 py-4\">\r\n                                                                    <div className=\"bg-white dark:bg-gray-700/30 rounded-lg p-4 border border-gray-200 dark:border-gray-600\">\r\n                                                                        <h4 className=\"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3 flex items-center\">\r\n                                                                            <Eye className=\"w-4 h-4 mr-2\" />\r\n                                                                            Transaction Details\r\n                                                                        </h4>\r\n                                                                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                                                                            {transaction.billNumber && (\r\n                                                                                <div>\r\n                                                                                    <p className=\"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1\">\r\n                                                                                        Bill Number\r\n                                                                                    </p>\r\n                                                                                    <p className=\"text-sm text-gray-900 dark:text-white font-mono\">\r\n                                                                                        {transaction.billNumber}\r\n                                                                                    </p>\r\n                                                                                </div>\r\n                                                                            )}\r\n                                                                            {transaction.notes && (\r\n                                                                                <div className={transaction.billNumber ? '' : 'md:col-span-2'}>\r\n                                                                                    <p className=\"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1\">\r\n                                                                                        Notes / Remarks\r\n                                                                                    </p>\r\n                                                                                    <p className=\"text-sm text-gray-900 dark:text-white\">\r\n                                                                                        {transaction.notes}\r\n                                                                                    </p>\r\n                                                                                </div>\r\n                                                                            )}\r\n                                                                        </div>\r\n                                                                    </div>\r\n                                                                </td>\r\n                                                            </tr>\r\n                                                        )}\r\n                                                    </React.Fragment>\r\n                                                );\r\n                                            })}\r\n\r\n                                            {/* Closing Balance Row */}\r\n                                            <tr className=\"bg-gray-100 dark:bg-gray-700 font-bold\">\r\n                                                <td colSpan=\"5\" className=\"px-6 py-4 text-right text-gray-900 dark:text-white\">\r\n                                                    Closing Balance:\r\n                                                </td>\r\n                                                <td className=\"px-6 py-4 text-right text-green-600 dark:text-green-400 rupee\">\r\n                                                    {formatINR(getTotalCashIn())}\r\n                                                </td>\r\n                                                <td className=\"px-6 py-4 text-right text-red-600 dark:text-red-400 rupee\">\r\n                                                    {formatINR(getTotalCashOut())}\r\n                                                </td>\r\n                                                <td className=\"px-6 py-4 text-right text-purple-600 dark:text-purple-400 rupee\">\r\n                                                    {formatINR(getClosingBalance())}\r\n                                                </td>\r\n                                                <td></td>\r\n                                            </tr>\r\n                                        </tbody>\r\n                                    </table>\r\n                                </div >\r\n                            )}\r\n                        </div >\r\n                    </>\r\n                )}\r\n            </div >\r\n\r\n            <ConfirmationModal\r\n                isOpen={isDeleteModalOpen}\r\n                onClose={() => {\r\n                    setIsDeleteModalOpen(false);\r\n                    setTransactionToDelete(null);\r\n                }}\r\n                onConfirm={confirmDelete}\r\n                title=\"Delete Transaction\"\r\n                message=\"Are you sure you want to delete this transaction? This will reverse the balance adjustment and cannot be undone.\"\r\n                confirmText=\"Delete Transaction\"\r\n                cancelText=\"Cancel\"\r\n            />\r\n\r\n            <RecordPaymentModal\r\n                isOpen={isPaymentModalOpen}\r\n                onClose={() => setIsPaymentModalOpen(false)}\r\n                onSuccess={loadDaybook}\r\n                defaultDate={selectedDate}\r\n            />\r\n\r\n            {isAdjustModalOpen && (\r\n                <AdjustBalanceModal\r\n                    isOpen={isAdjustModalOpen}\r\n                    onClose={() => setIsAdjustModalOpen(false)}\r\n                    onSuccess={loadDaybook}\r\n                    currentBalance={daybookData?.openingBalance || 0}\r\n                    date={selectedDate}\r\n                />\r\n            )}\r\n        </Layout >\r\n    );\r\n};\r\n\r\nexport default Daybook;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\pages\\Expenses.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":73,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":73,"endColumn":23}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport Layout from '../components/Layout/Layout';\r\nimport api from '../utils/api';\r\nimport { formatINR } from '../utils/currency';\r\nimport {\r\n    IndianRupee,\r\n    Search,\r\n    Plus,\r\n    Edit2,\r\n    Trash2,\r\n    X,\r\n    BookOpen\r\n} from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\nimport ConfirmationModal from '../components/ConfirmationModal';\r\n\r\nconst Expenses = () => {\r\n    const navigate = useNavigate();\r\n    const [expenseHeads, setExpenseHeads] = useState([]);\r\n    const [filteredExpenseHeads, setFilteredExpenseHeads] = useState([]);\r\n    const [searchQuery, setSearchQuery] = useState('');\r\n    const [loading, setLoading] = useState(true);\r\n    const [showModal, setShowModal] = useState(false);\r\n    const [editingExpense, setEditingExpense] = useState(null);\r\n    const [showDeleteModal, setShowDeleteModal] = useState(false);\r\n    const [expenseToDelete, setExpenseToDelete] = useState(null);\r\n\r\n    const fetchExpenseHeads = useCallback(async () => {\r\n        try {\r\n            setLoading(true);\r\n            const { data } = await api.get('/suppliers');\r\n            // Filter for type 'Expense'\r\n            const heads = data.filter(s => s.type === 'Expense');\r\n            setExpenseHeads(heads);\r\n            setFilteredExpenseHeads(heads);\r\n        } catch (error) {\r\n            console.error('Error fetching expense heads:', error);\r\n            toast.error('Failed to load expense heads');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        fetchExpenseHeads();\r\n    }, [fetchExpenseHeads]);\r\n\r\n    useEffect(() => {\r\n        if (searchQuery) {\r\n            const filtered = expenseHeads.filter(e =>\r\n                e.name.toLowerCase().includes(searchQuery.toLowerCase())\r\n            );\r\n            setFilteredExpenseHeads(filtered);\r\n        } else {\r\n            setFilteredExpenseHeads(expenseHeads);\r\n        }\r\n    }, [searchQuery, expenseHeads]);\r\n\r\n    const handleDeleteClick = (expense) => {\r\n        setExpenseToDelete(expense);\r\n        setShowDeleteModal(true);\r\n    };\r\n\r\n    const confirmDelete = async () => {\r\n        if (!expenseToDelete) return;\r\n\r\n        try {\r\n            await api.delete(`/suppliers/${expenseToDelete._id}`);\r\n            toast.success('Expense head deleted successfully');\r\n            fetchExpenseHeads();\r\n            setExpenseToDelete(null);\r\n        } catch (error) {\r\n            toast.error('Failed to delete expense head');\r\n        }\r\n    };\r\n\r\n    const handleEdit = (expense) => {\r\n        setEditingExpense(expense);\r\n        setShowModal(true);\r\n    };\r\n\r\n    const handleAdd = () => {\r\n        setEditingExpense(null);\r\n        setShowModal(true);\r\n    };\r\n\r\n    return (\r\n        <Layout>\r\n            <div className=\"p-4 md:p-8 min-h-screen bg-gray-50/50 dark:bg-[#050505] transition-colors duration-500\">\r\n                {/* Header Section */}\r\n                <div className=\"mb-10 relative\">\r\n                    <div className=\"absolute -top-24 -left-24 w-96 h-96 bg-red-500/10 blur-[120px] rounded-full pointer-events-none\"></div>\r\n                    <div className=\"flex flex-col md:flex-row md:items-end justify-between gap-6 relative z-10\">\r\n                        <div>\r\n                            <div className=\"flex items-center space-x-3 mb-2\">\r\n                                <div className=\"p-2 bg-red-500/10 rounded-lg\">\r\n                                    <IndianRupee className=\"w-5 h-5 text-red-500\" />\r\n                                </div>\r\n                                <span className=\"text-red-600 dark:text-red-400 text-xs font-black uppercase tracking-[0.3em]\">Expense Management</span>\r\n                            </div>\r\n                            <h1 className=\"text-4xl md:text-5xl font-black text-gray-900 dark:text-white tracking-tight\">\r\n                                <span className=\"text-transparent bg-clip-text bg-gradient-to-r from-red-600 to-rose-500\">Expense Heads</span>\r\n                            </h1>\r\n                            <p className=\"text-gray-500 dark:text-gray-400 mt-2 font-medium max-w-md\">\r\n                                Manage expense categories and track total spending\r\n                            </p>\r\n                        </div>\r\n                        <button\r\n                            onClick={handleAdd}\r\n                            className=\"flex items-center space-x-2 px-8 py-4 bg-red-600 hover:bg-red-500 text-white rounded-2xl shadow-[0_20px_40px_rgba(220,38,38,0.2)] hover:shadow-[0_25px_50px_rgba(220,38,38,0.3)] transition-all duration-300 transform hover:-translate-y-1 group\"\r\n                        >\r\n                            <Plus className=\"w-6 h-6 group-hover:rotate-90 transition-transform duration-500\" />\r\n                            <span className=\"font-black tracking-tight text-lg\">Add Expense Head</span>\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Search Bar */}\r\n                <div className=\"mb-8 relative z-10 max-w-4xl mx-auto\">\r\n                    <div className=\"bg-white dark:bg-[#0a0a0a] p-2 rounded-2xl border border-red-500/30 shadow-[0_4px_20px_-8px_rgba(220,38,38,0.3)] transition-all duration-300\">\r\n                        <div className=\"flex items-center px-4\">\r\n                            <Search className=\"w-5 h-5 text-gray-400\" />\r\n                            <input\r\n                                type=\"text\"\r\n                                value={searchQuery}\r\n                                onChange={(e) => setSearchQuery(e.target.value)}\r\n                                placeholder=\"Search expense categories by name...\"\r\n                                className=\"w-full pl-4 pr-4 py-3 bg-transparent border-none text-gray-900 dark:text-white placeholder-gray-400 focus:ring-0 text-sm font-medium\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Expense Grid */}\r\n                {loading ? (\r\n                    <div className=\"bg-white/50 dark:bg-black/20 backdrop-blur-xl rounded-[32px] border border-white dark:border-white/5 p-20 text-center\">\r\n                        <div className=\"relative inline-block\">\r\n                            <div className=\"w-16 h-16 border-t-2 border-red-500 rounded-full animate-spin mx-auto\"></div>\r\n                            <div className=\"absolute inset-0 bg-red-500/20 blur-xl rounded-full\"></div>\r\n                        </div>\r\n                        <p className=\"mt-4 text-red-600 dark:text-red-400 font-bold tracking-widest uppercase text-xs animate-pulse font-mono\">Loading Expenses...</p>\r\n                    </div>\r\n                ) : filteredExpenseHeads.length === 0 ? (\r\n                    <div className=\"bg-white/50 dark:bg-black/20 backdrop-blur-xl rounded-[32px] border border-white dark:border-white/5 p-20 text-center group\">\r\n                        <div className=\"relative inline-block mb-6\">\r\n                            <div className=\"absolute inset-0 bg-red-500/10 blur-3xl rounded-full group-hover:bg-red-500/20 transition-all duration-700\"></div>\r\n                            <IndianRupee className=\"w-20 h-20 text-red-500/20 group-hover:text-red-500/40 transition-all duration-500 relative z-10 mx-auto\" strokeWidth={1} />\r\n                        </div>\r\n                        <h3 className=\"text-2xl font-black text-gray-900 dark:text-white tracking-tight\">No Expense Heads Found</h3>\r\n                        <p className=\"text-gray-500 dark:text-gray-400 mt-2 font-medium\">Create your first expense category to start tracking spending.</p>\r\n                        <button onClick={handleAdd} className=\"mt-8 px-8 py-3 bg-red-500/10 text-red-600 dark:text-red-400 border border-red-500/20 rounded-xl hover:bg-red-500 hover:text-white transition-all duration-300 font-bold uppercase tracking-widest text-xs\">\r\n                            Add Expense Head\r\n                        </button>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 relative z-10\">\r\n                        {filteredExpenseHeads.map((expense) => (\r\n                            <div\r\n                                key={expense._id}\r\n                                className=\"bg-[#FFF5F5] dark:bg-[#0a0a0a] rounded-[32px] border-[1.5px] border-red-400/40 p-6 shadow-sm hover:shadow-[0_8px_30px_-10px_rgba(220,38,38,0.2)] transition-all duration-300 group\"\r\n                            >\r\n                                {/* Header Pill */}\r\n                                <div className=\"border border-black/80 dark:border-white/80 rounded-full p-2 flex items-center gap-4 mb-4 bg-white dark:bg-black/40\">\r\n                                    <div className=\"relative\">\r\n                                        <div className=\"w-10 h-10 rounded-full bg-red-100 dark:bg-red-500/20 flex items-center justify-center text-red-600 dark:text-red-400 font-bold text-lg border border-red-200 dark:border-red-500/30\">\r\n                                            {expense.name.charAt(0).toUpperCase()}\r\n                                        </div>\r\n                                        <div className=\"absolute -top-0.5 -right-0.5 w-3 h-3 bg-red-500 rounded-full border-2 border-white dark:border-black\"></div>\r\n                                    </div>\r\n                                    <div className=\"flex flex-col\">\r\n                                        <span className=\"text-base font-bold text-gray-900 dark:text-white leading-tight\">\r\n                                            {expense.name}\r\n                                        </span>\r\n                                        <span className=\"text-[9px] font-bold text-gray-400 dark:text-gray-500 uppercase tracking-widest\">\r\n                                            ID: {expense._id.slice(-6).toUpperCase()}\r\n                                        </span>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Total Spent Container */}\r\n                                <div className=\"border border-black/80 dark:border-white/80 rounded-2xl p-4 bg-gray-50/50 dark:bg-white/5 relative overflow-hidden\">\r\n                                    <div className=\"flex justify-between items-start mb-1\">\r\n                                        <span className=\"text-[10px] font-black text-gray-400 dark:text-gray-500 uppercase tracking-widest\">Total Spent</span>\r\n                                        <IndianRupee className=\"w-3 h-3 text-gray-300\" />\r\n                                    </div>\r\n\r\n                                    <div className=\"text-xl font-bold font-mono tracking-tighter mb-3 text-red-600 dark:text-red-400\">\r\n                                        {formatINR(Math.abs(expense.balance || 0))}\r\n                                    </div>\r\n\r\n                                    <div className=\"flex items-center space-x-2 mb-2\">\r\n                                        <div className=\"h-1 flex-1 bg-gray-200 dark:bg-white/10 rounded-full overflow-hidden\">\r\n                                            <div\r\n                                                className=\"h-full rounded-full transition-all duration-1000 bg-red-500\"\r\n                                                style={{ width: expense.balance === 0 ? '0%' : '65%' }}\r\n                                            ></div>\r\n                                        </div>\r\n                                        <span className=\"text-[9px] font-bold text-red-500 uppercase\">\r\n                                            EXP\r\n                                        </span>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Hover Actions */}\r\n                                <div className=\"flex items-center justify-end space-x-2 mt-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300\">\r\n                                    <button\r\n                                        onClick={() => navigate(`/expenses/${expense._id}/ledger`)}\r\n                                        className=\"p-2 text-gray-400 hover:text-indigo-500 transition-colors\"\r\n                                        title=\"View Ledger\"\r\n                                    >\r\n                                        <BookOpen className=\"w-4 h-4\" />\r\n                                    </button>\r\n                                    <button\r\n                                        onClick={() => handleEdit(expense)}\r\n                                        className=\"p-2 text-gray-400 hover:text-red-500 transition-colors\"\r\n                                        title=\"Edit\"\r\n                                    >\r\n                                        <Edit2 className=\"w-4 h-4\" />\r\n                                    </button>\r\n                                    <button\r\n                                        onClick={() => handleDeleteClick(expense)}\r\n                                        className=\"p-2 text-gray-400 hover:text-red-600 transition-colors\"\r\n                                        title=\"Delete\"\r\n                                    >\r\n                                        <Trash2 className=\"w-4 h-4\" />\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Add/Edit Expense Modal */}\r\n            {showModal && (\r\n                <ExpenseModal\r\n                    expense={editingExpense}\r\n                    onClose={() => {\r\n                        setShowModal(false);\r\n                        setEditingExpense(null);\r\n                    }}\r\n                    onSuccess={() => {\r\n                        setShowModal(false);\r\n                        setEditingExpense(null);\r\n                        fetchExpenseHeads();\r\n                    }}\r\n                />\r\n            )}\r\n\r\n            <ConfirmationModal\r\n                isOpen={showDeleteModal}\r\n                onClose={() => {\r\n                    setShowDeleteModal(false);\r\n                    setExpenseToDelete(null);\r\n                }}\r\n                onConfirm={confirmDelete}\r\n                title=\"Delete Expense Head\"\r\n                message={`Are you sure you want to delete \"${expenseToDelete?.name}\"? This action cannot be undone.`}\r\n                confirmText=\"Delete Expense Head\"\r\n                isDangerous={true}\r\n            />\r\n        </Layout>\r\n    );\r\n};\r\n\r\n// Expense Modal Component\r\nconst ExpenseModal = ({ expense, onClose, onSuccess }) => {\r\n    const [formData, setFormData] = useState({\r\n        name: expense?.name || '',\r\n    });\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        setLoading(true);\r\n\r\n        try {\r\n            if (expense) {\r\n                await api.put(`/suppliers/${expense._id}`, { ...formData, type: 'Expense' });\r\n                toast.success('Expense head updated successfully');\r\n            } else {\r\n                await api.post('/suppliers', { ...formData, type: 'Expense', phone: '0000000000' });\r\n                toast.success('Expense head added successfully');\r\n            }\r\n            onSuccess();\r\n        } catch (error) {\r\n            toast.error(error.response?.data?.message || 'Failed to save expense head');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 backdrop-blur-sm\">\r\n            <div className=\"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full border border-gray-100 dark:border-gray-700\">\r\n                <div className=\"p-6 border-b-[2.5px] border-black dark:border-white/90 flex items-center justify-between\">\r\n                    <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\r\n                        {expense ? 'Edit Expense Head' : 'Add New Expense Head'}\r\n                    </h2>\r\n                    <button\r\n                        onClick={onClose}\r\n                        className=\"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors text-gray-500 dark:text-gray-400\"\r\n                    >\r\n                        <X className=\"w-6 h-6\" />\r\n                    </button>\r\n                </div>\r\n\r\n                <form onSubmit={handleSubmit} className=\"p-6 space-y-4\">\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                            Expense Category Name *\r\n                        </label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={formData.name}\r\n                            onChange={(e) => setFormData({ ...formData, name: e.target.value })}\r\n                            className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400\"\r\n                            placeholder=\"e.g., Internet Bill, Office Rent, Electricity\"\r\n                            required\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center justify-end space-x-3 pt-4 border-t-[2.5px] border-black dark:border-white/90\">\r\n                        <button\r\n                            type=\"button\"\r\n                            onClick={onClose}\r\n                            className=\"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-gray-700 dark:text-gray-300\"\r\n                        >\r\n                            Cancel\r\n                        </button>\r\n                        <button\r\n                            type=\"submit\"\r\n                            disabled={loading}\r\n                            className=\"px-6 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors disabled:opacity-50\"\r\n                        >\r\n                            {loading ? 'Saving...' : expense ? 'Update Expense Head' : 'Add Expense Head'}\r\n                        </button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Expenses;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\pages\\ExpiryReport.jsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchExpiringBatches'. Either include it or remove the dependency array.","line":28,"column":8,"nodeType":"ArrayExpression","endLine":28,"endColumn":14,"suggestions":[{"desc":"Update the dependencies array to be: [days, fetchExpiringBatches]","fix":{"range":[958,964],"text":"[days, fetchExpiringBatches]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport Layout from '../components/Layout/Layout';\r\nimport api from '../utils/api';\r\nimport { formatINR } from '../utils/currency';\r\nimport { AlertTriangle, Calendar, Package } from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst ExpiryReport = () => {\r\n    const [batches, setBatches] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [days, setDays] = useState(30);\r\n\r\n    const fetchExpiringBatches = async () => {\r\n        try {\r\n            setLoading(true);\r\n            const res = await api.get(`/products/expiry-alert?days=${days}`);\r\n            setBatches(res.data);\r\n        } catch (error) {\r\n            console.error('Failed to fetch expiry report:', error);\r\n            toast.error('Failed to load report');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        fetchExpiringBatches();\r\n    }, [days]);\r\n\r\n    const getExpiryStatus = (date) => {\r\n        const today = new Date();\r\n        const expiry = new Date(date);\r\n        const diffTime = expiry - today;\r\n        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\r\n\r\n        if (diffDays < 0) return { label: 'EXPIRED', color: 'text-red-600 bg-red-100', days: diffDays };\r\n        if (diffDays <= 30) return { label: 'CRITICAL', color: 'text-red-500 bg-red-50', days: diffDays };\r\n        return { label: 'WARNING', color: 'text-orange-500 bg-orange-50', days: diffDays };\r\n    };\r\n\r\n    return (\r\n        <Layout>\r\n            <div className=\"p-8 bg-gray-50 min-h-screen\">\r\n                <div className=\"flex justify-between items-center mb-8\">\r\n                    <div>\r\n                        <h1 className=\"text-3xl font-black text-gray-900 tracking-tight\">Expiry <span className=\"text-rose-600\">Report</span></h1>\r\n                        <p className=\"text-gray-500 mt-1 font-medium\">Track products nearing expiration</p>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-4\">\r\n                        <select\r\n                            value={days}\r\n                            onChange={(e) => setDays(Number(e.target.value))}\r\n                            className=\"px-4 py-2 border border-gray-200 rounded-xl font-bold text-gray-700 focus:outline-none focus:ring-2 focus:ring-rose-500/20\"\r\n                        >\r\n                            <option value={30}>Next 30 Days</option>\r\n                            <option value={60}>Next 60 Days</option>\r\n                            <option value={90}>Next 90 Days</option>\r\n                            <option value={180}>Next 6 Months</option>\r\n                        </select>\r\n                        <button\r\n                            onClick={fetchExpiringBatches}\r\n                            className=\"p-2 bg-rose-50 text-rose-600 rounded-xl hover:bg-rose-100 transition-colors\"\r\n                        >\r\n                            <Calendar className=\"w-5 h-5\" />\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                {loading ? (\r\n                    <div className=\"flex justify-center py-20\">\r\n                        <div className=\"w-8 h-8 border-4 border-rose-500 border-t-transparent rounded-full animate-spin\"></div>\r\n                    </div>\r\n                ) : batches.length === 0 ? (\r\n                    <div className=\"bg-white rounded-[24px] p-12 text-center border border-gray-100 shadow-xl\">\r\n                        <Package className=\"w-16 h-16 text-gray-200 mx-auto mb-4\" />\r\n                        <h3 className=\"text-xl font-bold text-gray-900\">No Expiring Items Found</h3>\r\n                        <p className=\"text-gray-500 mt-2\">Good news! No items are expiring in the selected range.</p>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"bg-white rounded-[24px] overflow-hidden border border-gray-100 shadow-xl\">\r\n                        <table className=\"w-full text-left\">\r\n                            <thead className=\"bg-gray-50/50 border-b border-gray-100\">\r\n                                <tr>\r\n                                    <th className=\"px-6 py-4 text-xs font-black uppercase tracking-widest text-gray-400\">Status</th>\r\n                                    <th className=\"px-6 py-4 text-xs font-black uppercase tracking-widest text-gray-400\">Product Name</th>\r\n                                    <th className=\"px-6 py-4 text-xs font-black uppercase tracking-widest text-gray-400\">Batch No</th>\r\n                                    <th className=\"px-6 py-4 text-xs font-black uppercase tracking-widest text-gray-400 text-center\">Qty</th>\r\n                                    <th className=\"px-6 py-4 text-xs font-black uppercase tracking-widest text-gray-400 text-right\">MRP</th>\r\n                                    <th className=\"px-6 py-4 text-xs font-black uppercase tracking-widest text-gray-400 text-right\">Expiry Date</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody className=\"divide-y divide-gray-100\">\r\n                                {batches.map((batch) => {\r\n                                    const status = getExpiryStatus(batch.expiryDate);\r\n                                    return (\r\n                                        <tr key={batch._id} className=\"hover:bg-gray-50 transition-colors\">\r\n                                            <td className=\"px-6 py-4\">\r\n                                                <span className={`text-[10px] font-black px-2 py-1 rounded-full uppercase tracking-wider ${status.color}`}>\r\n                                                    {status.label}\r\n                                                </span>\r\n                                            </td>\r\n                                            <td className=\"px-6 py-4\">\r\n                                                <div className=\"font-bold text-gray-900\">{batch.product?.name || 'Unknown Product'}</div>\r\n                                                <div className=\"text-xs text-gray-500 font-medium\">{batch.product?.sku}</div>\r\n                                            </td>\r\n                                            <td className=\"px-6 py-4 text-sm font-bold text-gray-700\">{batch.batchNumber}</td>\r\n                                            <td className=\"px-6 py-4 text-center font-bold text-gray-900\">{batch.quantity}</td>\r\n                                            <td className=\"px-6 py-4 text-right font-bold text-gray-900\">{formatINR(batch.mrp)}</td>\r\n                                            <td className=\"px-6 py-4 text-right\">\r\n                                                <div className=\"font-bold text-gray-900\">{new Date(batch.expiryDate).toLocaleDateString()}</div>\r\n                                                <div className={`text-xs font-bold mt-0.5 ${status.days < 0 ? 'text-red-500' : 'text-orange-500'}`}>\r\n                                                    {status.days < 0 ? `${Math.abs(status.days)} days ago` : `in ${status.days} days`}\r\n                                                </div>\r\n                                            </td>\r\n                                        </tr>\r\n                                    );\r\n                                })}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </Layout>\r\n    );\r\n};\r\n\r\nexport default ExpiryReport;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\pages\\Inventory\\FilterBar.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\pages\\Inventory\\Header.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\pages\\Inventory\\InventoryCards.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\pages\\Inventory\\InventoryTable.jsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n   8 |     // Clear selection if products change (e.g., after filter or delete)\n   9 |     useEffect(() => {\n> 10 |         setSelectedIds(new Set());\n     |         ^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  11 |     }, [products]);\n  12 |\n  13 |     const handleSelectAll = () => {","line":10,"column":9,"nodeType":null,"endLine":10,"endColumn":23},{"ruleId":"no-unused-vars","severity":2,"message":"'getClassNamesFor' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":54,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":54,"endColumn":27}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Edit2, Trash2, ArrowUpDown, CheckSquare, Square } from 'lucide-react';\r\nimport { formatINR } from '../../utils/currency';\r\n\r\nconst InventoryTable = ({ products, loading, onEdit, onDelete, onBulkDelete, sortConfig, onSort }) => {\r\n    const [selectedIds, setSelectedIds] = useState(new Set());\r\n\r\n    // Clear selection if products change (e.g., after filter or delete)\r\n    useEffect(() => {\r\n        setSelectedIds(new Set());\r\n    }, [products]);\r\n\r\n    const handleSelectAll = () => {\r\n        if (selectedIds.size === products.length) {\r\n            setSelectedIds(new Set());\r\n        } else {\r\n            setSelectedIds(new Set(products.map(p => p._id)));\r\n        }\r\n    };\r\n\r\n    const handleSelectOne = (id) => {\r\n        const newSelected = new Set(selectedIds);\r\n        if (newSelected.has(id)) {\r\n            newSelected.delete(id);\r\n        } else {\r\n            newSelected.add(id);\r\n        }\r\n        setSelectedIds(newSelected);\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-brand-100 dark:border-gray-700 p-12 text-center\">\r\n                <div className=\"w-12 h-12 border-4 border-brand-500 border-t-transparent rounded-full animate-spin mx-auto mb-4\"></div>\r\n                <p className=\"text-gray-500 dark:text-gray-400\">Loading inventory...</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (products.length === 0) {\r\n        return (\r\n            <div className=\"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-brand-100 dark:border-gray-700 p-12 text-center\">\r\n                <div className=\"w-16 h-16 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-4\">\r\n                    <span className=\"text-3xl\"></span>\r\n                </div>\r\n                <h3 className=\"text-lg font-bold text-gray-900 dark:text-white mb-2\">No Products Found</h3>\r\n                <p className=\"text-gray-500 dark:text-gray-400 max-w-sm mx-auto\">\r\n                    Try adjusting your search or filters, or add a new product to your inventory.\r\n                </p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const getClassNamesFor = (name) => {\r\n        if (!sortConfig) return;\r\n        return sortConfig.key === name ? sortConfig.direction : undefined;\r\n    };\r\n\r\n    return (\r\n        <div className=\"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-brand-100 dark:border-gray-700 overflow-hidden hidden md:block\">\r\n            {selectedIds.size > 0 && (\r\n                <div className=\"bg-brand-50 dark:bg-brand-900/20 p-4 flex items-center justify-between border-b border-brand-100 dark:border-brand-500/20\">\r\n                    <span className=\"text-sm font-semibold text-brand-700 dark:text-brand-300\">\r\n                        {selectedIds.size} product{selectedIds.size > 1 ? 's' : ''} selected\r\n                    </span>\r\n                    <button\r\n                        onClick={() => onBulkDelete(Array.from(selectedIds))}\r\n                        className=\"flex items-center space-x-2 px-4 py-2 bg-red-100 hover:bg-red-200 text-red-700 dark:bg-red-900/40 dark:hover:bg-red-900/60 dark:text-red-300 rounded-lg transition-colors text-sm font-medium\"\r\n                    >\r\n                        <Trash2 className=\"w-4 h-4\" />\r\n                        <span>Delete Selected</span>\r\n                    </button>\r\n                </div>\r\n            )}\r\n            <div className=\"overflow-x-auto\">\r\n                <table className=\"w-full\">\r\n                    <thead>\r\n                        <tr className=\"bg-gray-50 dark:bg-gray-700/50 border-b border-gray-100 dark:border-gray-700\">\r\n                            <th className=\"px-6 py-4 text-left\">\r\n                                <button onClick={handleSelectAll} className=\"text-gray-400 hover:text-brand-500 transition-colors\">\r\n                                    {selectedIds.size === products.length && products.length > 0 ? (\r\n                                        <CheckSquare className=\"w-5 h-5 text-brand-500\" />\r\n                                    ) : (\r\n                                        <Square className=\"w-5 h-5\" />\r\n                                    )}\r\n                                </button>\r\n                            </th>\r\n                            <th className=\"px-6 py-4 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\r\n                                Product\r\n                            </th>\r\n                            <th className=\"px-6 py-4 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\r\n                                Category\r\n                            </th>\r\n                            <th\r\n                                className=\"px-6 py-4 text-right text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider cursor-pointer hover:text-brand-600 dark:hover:text-brand-400 group\"\r\n                                onClick={() => onSort('stock')}\r\n                            >\r\n                                <div className=\"flex items-center justify-end gap-1\">\r\n                                    Stock\r\n                                    <ArrowUpDown className={`w-3 h-3 transition-opacity ${sortConfig.key === 'stock' ? 'opacity-100 text-brand-600' : 'opacity-0 group-hover:opacity-50'}`} />\r\n                                </div>\r\n                            </th>\r\n                            <th\r\n                                className=\"px-6 py-4 text-right text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider cursor-pointer hover:text-brand-600 dark:hover:text-brand-400 group\"\r\n                                onClick={() => onSort('sellingPrice')}\r\n                            >\r\n                                <div className=\"flex items-center justify-end gap-1\">\r\n                                    Price\r\n                                    <ArrowUpDown className={`w-3 h-3 transition-opacity ${sortConfig.key === 'sellingPrice' ? 'opacity-100 text-brand-600' : 'opacity-0 group-hover:opacity-50'}`} />\r\n                                </div>\r\n                            </th>\r\n                            <th className=\"px-6 py-4 text-right text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\r\n                                Value\r\n                            </th>\r\n                            <th className=\"px-6 py-4 text-right text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\r\n                                Actions\r\n                            </th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody className=\"divide-y divide-gray-100 dark:divide-gray-700\">\r\n                        {products.map((product) => {\r\n                            const isLowStock = product.stock <= (product.minStockAlert || 5);\r\n                            const isSelected = selectedIds.has(product._id);\r\n\r\n                            return (\r\n                                <tr\r\n                                    key={product._id}\r\n                                    className={`transition-colors ${isSelected ? 'bg-brand-50/50 dark:bg-brand-900/10' : 'hover:bg-gray-50 dark:hover:bg-gray-700/30'}`}\r\n                                >\r\n                                    <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                                        <button\r\n                                            onClick={() => handleSelectOne(product._id)}\r\n                                            className=\"text-gray-400 hover:text-brand-500 transition-colors\"\r\n                                        >\r\n                                            {isSelected ? (\r\n                                                <CheckSquare className=\"w-5 h-5 text-brand-500\" />\r\n                                            ) : (\r\n                                                <Square className=\"w-5 h-5\" />\r\n                                            )}\r\n                                        </button>\r\n                                    </td>\r\n                                    <td className=\"px-6 py-4 cursor-pointer\" onClick={() => handleSelectOne(product._id)}>\r\n                                        <div className=\"flex items-center\">\r\n                                            <div className=\"h-10 w-10 flex-shrink-0 rounded-lg bg-gray-100 dark:bg-gray-700 flex items-center justify-center text-lg shadow-inner overflow-hidden\">\r\n                                                {product.image ? (\r\n                                                    <img src={product.image} alt={product.name} className=\"w-full h-full object-cover\" />\r\n                                                ) : (\r\n                                                    <span>{product.name.charAt(0)}</span>\r\n                                                )}\r\n                                            </div>\r\n                                            <div className=\"ml-4\">\r\n                                                <div className=\"text-sm font-medium text-gray-900 dark:text-white\">{product.name}</div>\r\n                                                <div className=\"text-xs text-gray-500 dark:text-gray-400 font-mono mt-0.5\">\r\n                                                    {product.sku || 'No SKU'}\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </td>\r\n                                    <td className=\"px-6 py-4 cursor-pointer\" onClick={() => handleSelectOne(product._id)}>\r\n                                        <div className=\"flex flex-col\">\r\n                                            <span className=\"text-sm text-gray-700 dark:text-gray-300\">\r\n                                                {product.category}\r\n                                            </span>\r\n                                            {product.subCategory && (\r\n                                                <span className=\"text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1 mt-0.5\">\r\n                                                    <span className=\"w-1.5 h-1.5 rounded-full bg-gray-300 dark:bg-gray-600\"></span>\r\n                                                    {product.subCategory}\r\n                                                </span>\r\n                                            )}\r\n                                        </div>\r\n                                    </td>\r\n                                    <td className=\"px-6 py-4 text-right cursor-pointer\" onClick={() => handleSelectOne(product._id)}>\r\n                                        <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${isLowStock\r\n                                            ? 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400'\r\n                                            : 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400'\r\n                                            }`}>\r\n                                            {product.stock} {isLowStock ? 'Low' : ''}\r\n                                        </span>\r\n                                    </td>\r\n                                    <td className=\"px-6 py-4 text-right cursor-pointer\" onClick={() => handleSelectOne(product._id)}>\r\n                                        <div className=\"text-sm font-medium text-gray-900 dark:text-white\">\r\n                                            {formatINR(product.sellingPrice)}\r\n                                        </div>\r\n                                    </td>\r\n                                    <td className=\"px-6 py-4 text-right cursor-pointer\" onClick={() => handleSelectOne(product._id)}>\r\n                                        <div className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                                            {formatINR(product.stock * product.sellingPrice)}\r\n                                        </div>\r\n                                    </td>\r\n                                    <td className=\"px-6 py-4 text-right whitespace-nowrap text-sm font-medium\">\r\n                                        <div className=\"flex items-center justify-end space-x-2\">\r\n                                            <button\r\n                                                onClick={(e) => { e.stopPropagation(); onEdit(product); }}\r\n                                                className=\"p-2 text-gray-400 hover:text-brand-600 hover:bg-brand-50 dark:hover:bg-brand-900/20 rounded-lg transition-all\"\r\n                                                title=\"Edit Product\"\r\n                                            >\r\n                                                <Edit2 className=\"w-4 h-4\" />\r\n                                            </button>\r\n                                            <button\r\n                                                onClick={(e) => { e.stopPropagation(); onDelete(product); }}\r\n                                                className=\"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-all\"\r\n                                                title=\"Delete Product\"\r\n                                            >\r\n                                                <Trash2 className=\"w-4 h-4\" />\r\n                                            </button>\r\n                                        </div>\r\n                                    </td>\r\n                                </tr>\r\n                            );\r\n                        })}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default InventoryTable;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\pages\\Inventory\\ProductForm.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\pages\\Inventory\\index.jsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchCategories'. Either include it or remove the dependency array.","line":104,"column":8,"nodeType":"ArrayExpression","endLine":104,"endColumn":23,"suggestions":[{"desc":"Update the dependencies array to be: [fetchCategories, fetchProducts]","fix":{"range":[4733,4748],"text":"[fetchCategories, fetchProducts]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState, useEffect, useMemo, useCallback } from 'react';\r\nimport api from '../../utils/api';\r\nimport toast from 'react-hot-toast';\r\nimport * as XLSX from 'xlsx';\r\n\r\n// Components\r\nimport Header from './Header';\r\nimport FilterBar from './FilterBar';\r\nimport InventoryTable from './InventoryTable';\r\nimport InventoryCards from './InventoryCards';\r\nimport ProductForm from './ProductForm';\r\nimport ImportModal from '../../components/Inventory/ImportModal';\r\nimport ConfirmationModal from '../../components/ConfirmationModal';\r\nimport CategoryManagementModal from '../../components/CategoryManagementModal';\r\n\r\nimport CategoryFolderView from '../../components/Inventory/CategoryFolderView';\r\nimport Layout from '../../components/Layout/Layout';\r\n\r\nconst Inventory = () => {\r\n    const [products, setProducts] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [searchQuery, setSearchQuery] = useState('');\r\n    const [selectedCategory, setSelectedCategory] = useState('All');\r\n    const [showModal, setShowModal] = useState(false);\r\n    const [showImportModal, setShowImportModal] = useState(false);\r\n    const [showCategoryModal, setShowCategoryModal] = useState(false);\r\n    const [editingProduct, setEditingProduct] = useState(null);\r\n    const [showDeleteModal, setShowDeleteModal] = useState(false);\r\n    const [showBulkDeleteModal, setShowBulkDeleteModal] = useState(false);\r\n    const [productToDelete, setProductToDelete] = useState(null);\r\n    const [productsToBulkDelete, setProductsToBulkDelete] = useState([]);\r\n    const [categories, setCategories] = useState([]);\r\n    const [stockFilter, setStockFilter] = useState('all'); // all, low, out\r\n    const [sortConfig, setSortConfig] = useState({ key: 'name', direction: 'asc' });\r\n\r\n    // Folder View State\r\n    const [viewMode, setViewMode] = useState(() => {\r\n        return localStorage.getItem('inventoryViewMode') || 'folder';\r\n    }); // 'folder' | 'list'\r\n    const [categoryPath, setCategoryPath] = useState([]); // Array of {id, name}\r\n    const [currentSubCategories, setCurrentSubCategories] = useState([]);\r\n\r\n    // Save view mode preference\r\n    useEffect(() => {\r\n        localStorage.setItem('inventoryViewMode', viewMode);\r\n    }, [viewMode]);\r\n\r\n    // Debounce search query\r\n    // In original code, useDebounce might not be imported from a hook file but defined inline or imported.\r\n    // Checking original code imports...\r\n    // import { Search, Plus, Edit2, Trash2, X, Filter, Download, ChevronDown, RefreshCw, Upload, Package, Layers, Tag, TrendingUp, ArrowUpDown, AlertCircle } from 'lucide-react';\r\n    // import { formatINR } from '../utils/currency';\r\n    // No useDebounce hook import found in original file view.\r\n    // I will implement a simple debounce effect or just use the query directly if performance isn't critical yet,\r\n    // or copy the debounce logic if it was there.\r\n    // The original code had:\r\n    // const debouncedSearch = useDebounce(searchQuery, 300);\r\n    // So there IS a useDebounce hook. I should check where it comes from.\r\n    // \"import useDebounce from '../hooks/useDebounce';\" - likely.\r\n\r\n    // START OF DEBOUNCE IMPLEMENTATION IF HOOK MISSING\r\n    // Actually, I'll assume the hook exists in ../hooks/useDebounce based on common patterns.\r\n    // If not, I'll add a simple debounce here.\r\n    const [debouncedSearch, setDebouncedSearch] = useState(searchQuery);\r\n    useEffect(() => {\r\n        const handler = setTimeout(() => {\r\n            setDebouncedSearch(searchQuery);\r\n        }, 300);\r\n        return () => clearTimeout(handler);\r\n    }, [searchQuery]);\r\n\r\n    // Fetch Categories for Filter & Folder View\r\n    const fetchCategories = async () => {\r\n        try {\r\n            const { data } = await api.get('/categories?parent=null');\r\n            setCategories(data);\r\n            // Initial load for folder view (root categories)\r\n            if (categoryPath.length === 0) {\r\n                setCurrentSubCategories(data);\r\n            }\r\n        } catch (error) {\r\n            console.error('Failed to load categories', error);\r\n        }\r\n    };\r\n\r\n    // Fetch Products\r\n    const fetchProducts = useCallback(async () => {\r\n        try {\r\n            setLoading(true);\r\n            const { data } = await api.get('/products?limit=2000');\r\n            setProducts(data.products || data); // Handle filtered response structure if API changes\r\n        } catch (error) {\r\n            console.error('Failed to fetch products', error);\r\n            toast.error('Failed to load inventory');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        fetchProducts();\r\n        fetchCategories();\r\n    }, [fetchProducts]);\r\n\r\n\r\n    // Folder View Logic\r\n    const handleCategoryClick = async (category) => {\r\n        setCategoryPath([...categoryPath, { id: category._id, name: category.name }]);\r\n        setLoading(true);\r\n        try {\r\n            // Fetch sub-categories for the clicked category\r\n            const { data } = await api.get(`/categories/${category._id}`);\r\n            setCurrentSubCategories(data.subCategories || []);\r\n        } catch (error) {\r\n            console.error('Failed to load sub-categories', error);\r\n            toast.error('Failed to load sub-categories');\r\n            setCurrentSubCategories([]);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleNavigateBack = async (index = -1) => {\r\n        if (index === -1) {\r\n            // Go back one level\r\n            if (categoryPath.length > 0) {\r\n                const newPath = categoryPath.slice(0, -1);\r\n                setCategoryPath(newPath);\r\n                await loadFolderContent(newPath);\r\n            }\r\n        } else {\r\n            // Go to specific level\r\n            const newPath = categoryPath.slice(0, index + 1);\r\n            setCategoryPath(newPath);\r\n            await loadFolderContent(newPath);\r\n        }\r\n    };\r\n\r\n    const handleNavigateHome = async () => {\r\n        setCategoryPath([]);\r\n        await loadFolderContent([]);\r\n    };\r\n\r\n    const loadFolderContent = async (path) => {\r\n        setLoading(true);\r\n        try {\r\n            if (path.length === 0) {\r\n                // Load root categories\r\n                const { data } = await api.get('/categories?parent=null');\r\n                setCurrentSubCategories(data);\r\n            } else {\r\n                // Load sub-categories of the last item in path\r\n                const lastItem = path[path.length - 1];\r\n                const { data } = await api.get(`/categories/${lastItem.id}`);\r\n                setCurrentSubCategories(data.subCategories || []);\r\n            }\r\n        } catch (error) {\r\n            console.error('Failed to load folder content', error);\r\n            toast.error('Failed to update view');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    const handleMoveProduct = async (productId, targetCategory) => {\r\n        try {\r\n            const product = products.find(p => p._id === productId);\r\n            if (!product) return;\r\n\r\n            let updatedFields = {};\r\n            if (categoryPath.length === 0) {\r\n                // Moving to a root Category\r\n                updatedFields = { category: targetCategory.name, subCategory: '', subSubCategory: '' };\r\n            } else if (categoryPath.length === 1) {\r\n                // Moving to a Sub-Category\r\n                updatedFields = { category: categoryPath[0].name, subCategory: targetCategory.name, subSubCategory: '' };\r\n            } else if (categoryPath.length === 2) {\r\n                // Moving to a Sub-Sub-Category\r\n                updatedFields = { category: categoryPath[0].name, subCategory: categoryPath[1].name, subSubCategory: targetCategory.name };\r\n            } else {\r\n                return; // Can't move deeper than 3 levels currently\r\n            }\r\n\r\n            // Optimistic UI update\r\n            setProducts(prev => prev.map(p => p._id === productId ? { ...p, ...updatedFields } : p));\r\n\r\n            // API Call\r\n            await api.put(`/products/${productId}`, { ...product, ...updatedFields });\r\n            toast.success(`Moved to ${targetCategory.name}`);\r\n\r\n            // Re-fetch to ensure sync\r\n            fetchProducts();\r\n        } catch (error) {\r\n            console.error('Failed to move product:', error);\r\n            toast.error('Failed to move product');\r\n            fetchProducts(); // Revert optimistic update\r\n        }\r\n    };\r\n\r\n\r\n    // Delete Product\r\n    const handleDeleteClick = (product) => {\r\n        setProductToDelete(product);\r\n        setShowDeleteModal(true);\r\n    };\r\n\r\n    const confirmDelete = async () => {\r\n        if (!productToDelete) return;\r\n\r\n        try {\r\n            await api.delete(`/products/${productToDelete._id}`);\r\n            toast.success('Product deleted successfully');\r\n            fetchProducts();\r\n        } catch (error) {\r\n            toast.error(error.response?.data?.message || 'Failed to delete product');\r\n        } finally {\r\n            setProductToDelete(null);\r\n            setShowDeleteModal(false);\r\n        }\r\n    };\r\n\r\n    const handleBulkDeleteClick = (selectedIds) => {\r\n        if (!selectedIds || selectedIds.length === 0) return;\r\n        setProductsToBulkDelete(selectedIds);\r\n        setShowBulkDeleteModal(true);\r\n    };\r\n\r\n    const confirmBulkDelete = async () => {\r\n        if (!productsToBulkDelete || productsToBulkDelete.length === 0) return;\r\n\r\n        try {\r\n            // Use proper bulk delete API\r\n            await api.post(`/products/bulk-delete`, { productIds: productsToBulkDelete });\r\n            toast.success(`Successfully deleted ${productsToBulkDelete.length} products`);\r\n            fetchProducts();\r\n        } catch (error) {\r\n            console.error('Bulk delete error:', error);\r\n            toast.error(error.response?.data?.message || 'Failed to delete some or all selected products');\r\n        } finally {\r\n            setProductsToBulkDelete([]);\r\n            setShowBulkDeleteModal(false);\r\n        }\r\n    };\r\n\r\n    // Export to Excel\r\n    const handleExport = async () => {\r\n        try {\r\n            const toastId = toast.loading('Preparing export...');\r\n\r\n            // Fetch all categories to include empty ones\r\n            const { data: allCategories } = await api.get('/categories');\r\n\r\n            const catMap = new Map(allCategories.map(c => [String(c._id), c]));\r\n            const pathsToExport = new Set();\r\n\r\n            allCategories.forEach(cat => {\r\n                let current = cat;\r\n                const path = [];\r\n                while (current) {\r\n                    path.unshift(current.name);\r\n                    const parentId = typeof current.parentCategory === 'object' ? current.parentCategory?._id : current.parentCategory;\r\n                    current = parentId ? catMap.get(String(parentId)) : null;\r\n                }\r\n                if (path.length > 0) {\r\n                    pathsToExport.add(JSON.stringify([path[0] || '', path[1] || '', path[2] || '']));\r\n                }\r\n            });\r\n\r\n            const pathsWithProducts = new Set();\r\n            const exportData = products.map(p => {\r\n                const cat = p.category || '';\r\n                const sub = p.subCategory || '';\r\n                const subSub = p.subSubCategory || '';\r\n                pathsWithProducts.add(JSON.stringify([cat, sub, subSub]));\r\n\r\n                return {\r\n                    Name: p.name,\r\n                    SKU: p.sku || '',\r\n                    Category: cat,\r\n                    SubCategory: sub,\r\n                    SubSubCategory: subSub,\r\n                    CostPrice: p.costPrice,\r\n                    SellingPrice: p.sellingPrice,\r\n                    Stock: p.stock,\r\n                    Value: p.stock * p.sellingPrice\r\n                };\r\n            });\r\n\r\n            // Add empty categories\r\n            pathsToExport.forEach(pathStr => {\r\n                if (!pathsWithProducts.has(pathStr)) {\r\n                    const pathArr = JSON.parse(pathStr);\r\n                    exportData.push({\r\n                        Name: '', // Blank\r\n                        SKU: '',\r\n                        Category: pathArr[0],\r\n                        SubCategory: pathArr[1],\r\n                        SubSubCategory: pathArr[2],\r\n                        CostPrice: '',\r\n                        SellingPrice: '',\r\n                        Stock: '',\r\n                        Value: ''\r\n                    });\r\n                }\r\n            });\r\n\r\n            // Sort logically: Category -> SubCategory -> SubSubCategory -> Name\r\n            exportData.sort((a, b) => {\r\n                if (a.Category !== b.Category) return (a.Category || '').localeCompare(b.Category || '');\r\n                if (a.SubCategory !== b.SubCategory) return (a.SubCategory || '').localeCompare(b.SubCategory || '');\r\n                if (a.SubSubCategory !== b.SubSubCategory) return (a.SubSubCategory || '').localeCompare(b.SubSubCategory || '');\r\n                return (a.Name || '').localeCompare(b.Name || '');\r\n            });\r\n\r\n            const ws = XLSX.utils.json_to_sheet(exportData);\r\n            const wb = XLSX.utils.book_new();\r\n            XLSX.utils.book_append_sheet(wb, ws, \"Inventory\");\r\n            XLSX.writeFile(wb, \"Inventory_Report.xlsx\");\r\n\r\n            toast.success('Export downloaded', { id: toastId });\r\n        } catch (error) {\r\n            console.error('Export error:', error);\r\n            toast.error('Failed to export data');\r\n        }\r\n    };\r\n\r\n    // Sorting Logic\r\n    const handleSort = (key) => {\r\n        let direction = 'asc';\r\n        if (sortConfig.key === key && sortConfig.direction === 'asc') {\r\n            direction = 'desc';\r\n        }\r\n        setSortConfig({ key, direction });\r\n    };\r\n\r\n    // Filtering & Sorting Logic\r\n    const filteredProducts = useMemo(() => {\r\n        let result = [...products];\r\n\r\n        // 1. Search\r\n        if (debouncedSearch) {\r\n            const query = debouncedSearch.toLowerCase();\r\n            result = result.filter(p =>\r\n                p.name.toLowerCase().includes(query) ||\r\n                (p.sku && p.sku.toLowerCase().includes(query)) ||\r\n                (p.category && p.category.toLowerCase().includes(query))\r\n            );\r\n        }\r\n\r\n        // 2. Category Filter (Sidebar/Dropdown)\r\n        if (selectedCategory !== 'All') {\r\n            result = result.filter(p => p.category === selectedCategory);\r\n        }\r\n\r\n        const hasActiveFilter = debouncedSearch || selectedCategory !== 'All' || stockFilter !== 'all';\r\n\r\n        // 2.5 Folder View Filter (Overrides Sidebar if in folder mode)\r\n        if (viewMode === 'folder') {\r\n            if (!hasActiveFilter) {\r\n                if (categoryPath.length === 0) {\r\n                    // Root: do not show any products, only folders\r\n                    result = [];\r\n                } else if (categoryPath.length === 1) {\r\n                    // Category level: only show products with this category, and NO subcategory\r\n                    result = result.filter(p => p.category === categoryPath[0].name && (!p.subCategory || p.subCategory === ''));\r\n                } else if (categoryPath.length === 2) {\r\n                    // SubCategory level: only show products in this subCategory, and NO subSubCategory\r\n                    result = result.filter(p => p.category === categoryPath[0].name && p.subCategory === categoryPath[1].name && (!p.subSubCategory || p.subSubCategory === ''));\r\n                } else if (categoryPath.length >= 3) {\r\n                    // SubSubCategory level: show products in this subSubCategory\r\n                    result = result.filter(p => p.category === categoryPath[0].name && p.subCategory === categoryPath[1].name && p.subSubCategory === categoryPath[2].name);\r\n                }\r\n            } else {\r\n                // If there are filters active, restrict to current path but show ALL nested matching products\r\n                if (categoryPath.length > 0) {\r\n                    result = result.filter(p => p.category === categoryPath[0].name);\r\n                }\r\n                if (categoryPath.length > 1) {\r\n                    result = result.filter(p => p.subCategory === categoryPath[1].name);\r\n                }\r\n                if (categoryPath.length > 2) {\r\n                    result = result.filter(p => p.subSubCategory === categoryPath[2].name);\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n        // 3. Stock Filter\r\n        if (stockFilter !== 'all') {\r\n            if (stockFilter === 'low') {\r\n                result = result.filter(p => p.stock <= (p.minStockAlert || 5) && p.stock > 0);\r\n            } else if (stockFilter === 'out') {\r\n                result = result.filter(p => p.stock === 0);\r\n            }\r\n        }\r\n\r\n        // 4. Sorting\r\n        result.sort((a, b) => {\r\n            if (a[sortConfig.key] < b[sortConfig.key]) {\r\n                return sortConfig.direction === 'asc' ? -1 : 1;\r\n            }\r\n            if (a[sortConfig.key] > b[sortConfig.key]) {\r\n                return sortConfig.direction === 'asc' ? 1 : -1;\r\n            }\r\n            return 0;\r\n        });\r\n\r\n        return result;\r\n    }, [products, debouncedSearch, selectedCategory, stockFilter, sortConfig, viewMode, categoryPath]);\r\n\r\n    // Filtered Folders\r\n    const filteredFolders = useMemo(() => {\r\n        let result = [...currentSubCategories];\r\n\r\n        if (debouncedSearch) {\r\n            const query = debouncedSearch.toLowerCase();\r\n            result = result.filter(c => c.name.toLowerCase().includes(query));\r\n        }\r\n\r\n        if (selectedCategory !== 'All') {\r\n            if (categoryPath.length === 0) {\r\n                result = result.filter(c => c.name === selectedCategory);\r\n            }\r\n        }\r\n\r\n        if (stockFilter !== 'all') {\r\n            result = []; // Folders themselves don't have stock status in this view context\r\n        }\r\n\r\n        // Attach product count to each folder to fix the \"0 sub-folders\" UX issue\r\n        return result.map(folder => {\r\n            let count = 0;\r\n            if (categoryPath.length === 0) {\r\n                count = products.filter(p => p.category === folder.name).length;\r\n            } else if (categoryPath.length === 1) {\r\n                count = products.filter(p => p.category === categoryPath[0].name && p.subCategory === folder.name).length;\r\n            } else if (categoryPath.length === 2) {\r\n                count = products.filter(p => p.category === categoryPath[0].name && p.subCategory === categoryPath[1].name && p.subSubCategory === folder.name).length;\r\n            }\r\n            return {\r\n                ...folder,\r\n                productCount: count\r\n            }\r\n        });\r\n    }, [currentSubCategories, debouncedSearch, selectedCategory, stockFilter, categoryPath, products]);\r\n\r\n    const summaryProducts = useMemo(() => {\r\n        let result = [...products];\r\n\r\n        // Apply search and category filters first\r\n        if (debouncedSearch) {\r\n            const query = debouncedSearch.toLowerCase();\r\n            result = result.filter(p => p.name.toLowerCase().includes(query) || p.sku?.toLowerCase().includes(query));\r\n        }\r\n        if (selectedCategory !== 'All') {\r\n            result = result.filter(p => p.category === selectedCategory);\r\n        }\r\n        if (stockFilter !== 'all') {\r\n            if (stockFilter === 'low') {\r\n                result = result.filter(p => p.stock <= (p.minStockAlert || 5) && p.stock > 0);\r\n            } else if (stockFilter === 'out') {\r\n                result = result.filter(p => p.stock === 0);\r\n            }\r\n        }\r\n\r\n        // Apply folder path filter (include all nested products)\r\n        if (viewMode === 'folder' && categoryPath.length > 0) {\r\n            if (categoryPath.length > 0) {\r\n                result = result.filter(p => p.category === categoryPath[0].name);\r\n            }\r\n            if (categoryPath.length > 1) {\r\n                result = result.filter(p => p.subCategory === categoryPath[1].name);\r\n            }\r\n            if (categoryPath.length > 2) {\r\n                result = result.filter(p => p.subSubCategory === categoryPath[2].name);\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }, [products, debouncedSearch, selectedCategory, stockFilter, categoryPath, viewMode]);\r\n\r\n    const totalValue = useMemo(() => {\r\n        return summaryProducts.reduce((sum, p) => sum + ((p.stock || 0) * (p.sellingPrice || 0)), 0);\r\n    }, [summaryProducts]);\r\n\r\n    return (\r\n        <Layout>\r\n            <div className=\"p-8 relative space-y-6\">\r\n                <Header\r\n                    totalProducts={summaryProducts.length}\r\n                    totalValue={totalValue}\r\n                    onAddProduct={() => { setEditingProduct(null); setShowModal(true); }}\r\n                    onImport={() => setShowImportModal(true)}\r\n                    onExport={handleExport}\r\n                    onManageCategories={() => setShowCategoryModal(true)}\r\n                />\r\n\r\n                <FilterBar\r\n                    searchQuery={searchQuery}\r\n                    setSearchQuery={setSearchQuery}\r\n                    selectedCategory={selectedCategory}\r\n                    setSelectedCategory={setSelectedCategory}\r\n                    stockFilter={stockFilter}\r\n                    setStockFilter={setStockFilter}\r\n                    categories={categories}\r\n                    totalProducts={filteredProducts.length}\r\n                    onRefresh={fetchProducts}\r\n                    viewMode={viewMode}\r\n                    setViewMode={setViewMode}\r\n                />\r\n\r\n                {viewMode === 'list' ? (\r\n                    <>\r\n                        <InventoryTable\r\n                            products={filteredProducts}\r\n                            loading={loading}\r\n                            onEdit={(product) => { setEditingProduct(product); setShowModal(true); }}\r\n                            onDelete={handleDeleteClick}\r\n                            onBulkDelete={handleBulkDeleteClick}\r\n                            sortConfig={sortConfig}\r\n                            onSort={handleSort}\r\n                        />\r\n                        <InventoryCards\r\n                            products={filteredProducts}\r\n                            loading={loading}\r\n                            onEdit={(product) => { setEditingProduct(product); setShowModal(true); }}\r\n                            onDelete={handleDeleteClick}\r\n                        />\r\n                    </>\r\n                ) : (\r\n                    <CategoryFolderView\r\n                        categories={filteredFolders}\r\n                        products={filteredProducts} // In folder view, filteredProducts is filtered by current path\r\n                        currentPath={categoryPath}\r\n                        onCategoryClick={handleCategoryClick}\r\n                        onProductClick={(product) => { setEditingProduct(product); setShowModal(true); }}\r\n                        onNavigateBack={() => handleNavigateBack(-1)}\r\n                        onNavigateHome={handleNavigateHome}\r\n                        onMoveProduct={handleMoveProduct}\r\n                        onDeleteCategory={async (category) => {\r\n                            if (window.confirm(`Are you sure you want to delete the folder \"${category.name}\"?\\n\\nProducts inside it will not be deleted, but they will lose this category tag.`)) {\r\n                                try {\r\n                                    await api.delete(`/categories/${category._id}`);\r\n                                    toast.success('Category folder deleted successfully');\r\n                                    fetchCategories();\r\n                                    fetchProducts(); // Refresh products as their category might have changed\r\n                                } catch (error) {\r\n                                    console.error('Failed to delete category:', error);\r\n                                    toast.error(error.response?.data?.message || 'Failed to delete category');\r\n                                }\r\n                            }\r\n                        }}\r\n                        onDeleteProduct={handleDeleteClick}\r\n                        loading={loading}\r\n                    />\r\n                )}\r\n\r\n                {showModal && (\r\n                    <ProductForm\r\n                        product={editingProduct}\r\n                        onClose={() => { setShowModal(false); setEditingProduct(null); }}\r\n                        onSuccess={() => { setShowModal(false); fetchProducts(); }}\r\n                    />\r\n                )}\r\n\r\n                {showCategoryModal && (\r\n                    <CategoryManagementModal\r\n                        onClose={() => { setShowCategoryModal(false); fetchCategories(); }}\r\n                    />\r\n                )}\r\n\r\n                <ConfirmationModal\r\n                    isOpen={showDeleteModal}\r\n                    onClose={() => setShowDeleteModal(false)}\r\n                    onConfirm={confirmDelete}\r\n                    title=\"Delete Product\"\r\n                    message={`Are you sure you want to delete \"${productToDelete?.name}\"? This action cannot be undone.`}\r\n                    confirmText=\"Delete\"\r\n                    cancelText=\"Cancel\"\r\n                    isDangerous={true}\r\n                />\r\n                <ConfirmationModal\r\n                    isOpen={showBulkDeleteModal}\r\n                    onClose={() => setShowBulkDeleteModal(false)}\r\n                    onConfirm={confirmBulkDelete}\r\n                    title=\"Delete Selected Products\"\r\n                    message={`Are you sure you want to delete ${productsToBulkDelete.length} selected products? This action cannot be undone.`}\r\n                    confirmText=\"Delete All\"\r\n                    cancelText=\"Cancel\"\r\n                    isDangerous={true}\r\n                />\r\n                {showImportModal && (\r\n                    <ImportModal\r\n                        isOpen={showImportModal}\r\n                        onClose={() => setShowImportModal(false)}\r\n                        onImportSuccess={() => {\r\n                            fetchProducts();\r\n                            if (viewMode === 'folder') {\r\n                                loadFolderContent(categoryPath);\r\n                            }\r\n                        }}\r\n                    />\r\n                )}\r\n            </div>\r\n        </Layout>\r\n    );\r\n};\r\n\r\nexport default Inventory;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\pages\\InvoiceCreator.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\pages\\InvoiceHistory.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'voidReason' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":29,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"voidReason"},"fix":{"range":[968,978],"text":""},"desc":"Remove unused variable 'voidReason'."}]},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`loadInvoices` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\n  30 |\n  31 |     useEffect(() => {\n> 32 |         loadInvoices();\n     |         ^^^^^^^^^^^^ `loadInvoices` accessed before it is declared\n  33 |     }, []);\n  34 |\n  35 |     useEffect(() => {\n\n  60 |     }, [searchQuery, statusFilter, invoices]);\n  61 |\n> 62 |     const loadInvoices = async () => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 63 |         try {\n     | ^^^^^^^^^^^^^\n> 64 |             setLoading(true);\n     \n     | ^^^^^^^^^^^^^\n> 73 |         }\n     | ^^^^^^^^^^^^^\n> 74 |     };\n     | ^^^^^^^ `loadInvoices` is declared here\n  75 |\n  76 |     const handleVoidClick = (invoice) => {\n  77 |         setSelectedInvoice(invoice);","line":32,"column":9,"nodeType":null,"endLine":32,"endColumn":21},{"ruleId":"no-unused-vars","severity":2,"message":"'res' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":85,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":85,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"res"},"fix":{"range":[2975,3040],"text":""},"desc":"Remove unused variable 'res'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'getStatusColor' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":97,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":97,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"getStatusColor"},"fix":{"range":[3472,3964],"text":""},"desc":"Remove unused variable 'getStatusColor'."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport Layout from '../components/Layout/Layout';\r\nimport api from '../utils/api';\r\nimport { formatINR } from '../utils/currency';\r\nimport { formatDate } from '../utils/date';\r\nimport {\r\n    FileText,\r\n    Search,\r\n    Filter,\r\n    Download,\r\n    Eye,\r\n    Trash2,\r\n    Plus\r\n} from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst InvoiceHistory = () => {\r\n    const navigate = useNavigate();\r\n    const [invoices, setInvoices] = useState([]);\r\n    const [filteredInvoices, setFilteredInvoices] = useState([]);\r\n    const [searchQuery, setSearchQuery] = useState('');\r\n    const [statusFilter, setStatusFilter] = useState('All');\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    // Void Modal State\r\n    const [showVoidModal, setShowVoidModal] = useState(false);\r\n    const [selectedInvoice, setSelectedInvoice] = useState(null);\r\n    const [voidReason, setVoidReason] = useState('');\r\n\r\n    useEffect(() => {\r\n        loadInvoices();\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        let filtered = invoices;\r\n\r\n        // Search filter\r\n        if (searchQuery) {\r\n            const query = searchQuery.toLowerCase();\r\n            filtered = filtered.filter(inv =>\r\n                inv.invoiceNo.toLowerCase().includes(query) ||\r\n                (inv.customer?.name || inv.customerName || '').toLowerCase().includes(query) ||\r\n                (inv.customer?.phone || inv.customerPhone || '').includes(query) ||\r\n                // Search by IMEI (1 or 2) or Serial\r\n                inv.items?.some(item =>\r\n                    item.imei?.toLowerCase().includes(query) ||\r\n                    item.imei2?.toLowerCase().includes(query) ||\r\n                    item.serialNumber?.toLowerCase().includes(query)\r\n                )\r\n            );\r\n        }\r\n\r\n        // Status filter\r\n        if (statusFilter !== 'All') {\r\n            filtered = filtered.filter(inv => inv.status === statusFilter);\r\n        }\r\n\r\n        setFilteredInvoices(filtered);\r\n    }, [searchQuery, statusFilter, invoices]);\r\n\r\n    const loadInvoices = async () => {\r\n        try {\r\n            setLoading(true);\r\n            const { data } = await api.get('/invoices');\r\n            setInvoices(data.invoices || []);\r\n            setFilteredInvoices(data.invoices || []);\r\n            setLoading(false);\r\n        } catch (error) {\r\n            console.error('Failed to load invoices:', error);\r\n            toast.error('Failed to load invoices');\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleVoidClick = (invoice) => {\r\n        setSelectedInvoice(invoice);\r\n        setVoidReason(''); // We can keep reason for our own tracking if we add 'reason' to delete endpoint later, but for now standard delete.\r\n        setShowVoidModal(true);\r\n    };\r\n\r\n    const confirmDelete = async () => {\r\n        try {\r\n            // Hard Delete API Call\r\n            const res = await api.delete(`/invoices/${selectedInvoice._id}`);\r\n            // alert('Response: ' + JSON.stringify(res.data)); // Optional Debug\r\n            toast.success('Invoice deleted successfully');\r\n            setShowVoidModal(false);\r\n            loadInvoices();\r\n        } catch (error) {\r\n            console.error('Delete error:', error);\r\n            const msg = error.response?.data?.message || 'Failed to delete invoice';\r\n            toast.error(msg);\r\n        }\r\n    };\r\n\r\n    const getStatusColor = (status) => {\r\n        switch (status) {\r\n            case 'Paid':\r\n                return 'bg-green-100 text-green-700';\r\n            case 'Partial':\r\n                return 'bg-yellow-100 text-yellow-700';\r\n            case 'Due':\r\n                return 'bg-red-100 text-red-700';\r\n            case 'Void':\r\n                return 'bg-gray-200 text-gray-500 line-through';\r\n            default:\r\n                return 'bg-gray-100 text-gray-700';\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Layout>\r\n            <div className=\"p-4 md:p-8 min-h-screen bg-gray-50/50 dark:bg-[#050505] transition-colors duration-500\">\r\n                {/* Header Section */}\r\n                <div className=\"mb-10 relative\">\r\n                    <div className=\"absolute -top-24 -left-24 w-96 h-96 bg-indigo-500/10 blur-[120px] rounded-full pointer-events-none\"></div>\r\n                    <div className=\"flex flex-col md:flex-row md:items-end justify-between gap-6 relative z-10\">\r\n                        <div>\r\n                            <div className=\"flex items-center space-x-3 mb-2\">\r\n                                <div className=\"p-2 bg-indigo-500/10 rounded-lg\">\r\n                                    <FileText className=\"w-5 h-5 text-indigo-500\" />\r\n                                </div>\r\n                                <span className=\"text-indigo-600 dark:text-indigo-400 text-xs font-black uppercase tracking-[0.3em]\">Transaction Vault</span>\r\n                            </div>\r\n                            <h1 className=\"text-4xl md:text-5xl font-black text-gray-900 dark:text-white tracking-tight\">\r\n                                Invoice <span className=\"text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-violet-500\">History</span>\r\n                            </h1>\r\n                            <p className=\"text-gray-500 dark:text-gray-400 mt-2 font-medium max-w-md\">\r\n                                Secure ledger of all business transactions with real-time status tracking.\r\n                            </p>\r\n                        </div>\r\n                        <button\r\n                            onClick={() => navigate('/invoice/new')}\r\n                            className=\"flex items-center space-x-2 px-8 py-4 bg-indigo-600 hover:bg-indigo-500 text-white rounded-2xl shadow-[0_20px_40px_rgba(79,70,229,0.2)] hover:shadow-[0_25px_50px_rgba(79,70,229,0.3)] transition-all duration-300 transform hover:-translate-y-1 group\"\r\n                        >\r\n                            <Plus className=\"w-6 h-6 group-hover:rotate-90 transition-transform duration-500\" />\r\n                            <span className=\"font-black tracking-tight text-lg\">Generate Invoice</span>\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Advanced Search & Filter Array */}\r\n                <div className=\"mb-8 relative z-10\">\r\n                    <div className=\"bg-white/80 dark:bg-white/5 backdrop-blur-xl p-6 box-outline shadow-2xl border-b-[2.5px] border-black dark:border-white/90 transition-all duration-300\">\r\n                        <div className=\"flex flex-col md:flex-row gap-4 items-center\">\r\n                            {/* Neural Search */}\r\n                            <div className=\"relative group flex-grow\">\r\n                                <Search className=\"absolute left-6 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 group-focus-within:text-indigo-500 transition-colors\" />\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={searchQuery}\r\n                                    onChange={(e) => setSearchQuery(e.target.value)}\r\n                                    placeholder=\"Search by invoice #, customer name, phone, or IMEI...\"\r\n                                    className=\"w-full pl-14 pr-6 py-4.5 bg-gray-50/50 dark:bg-white/5 border border-transparent focus:border-indigo-500/30 rounded-[22px] text-gray-900 dark:text-white placeholder-gray-400 transition-all outline-none\"\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Status Intel */}\r\n                            <div className=\"relative group w-full md:w-auto\">\r\n                                <Filter className=\"absolute left-6 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 group-focus-within:text-violet-500 transition-colors\" />\r\n                                <select\r\n                                    value={statusFilter}\r\n                                    onChange={(e) => setStatusFilter(e.target.value)}\r\n                                    className=\"w-full pl-14 pr-6 py-4.5 bg-gray-50/50 dark:bg-white/5 border border-transparent focus:border-violet-500/30 rounded-[22px] text-gray-900 dark:text-white transition-all outline-none appearance-none cursor-pointer font-bold\"\r\n                                >\r\n                                    <option className=\"dark:bg-gray-900\">All Transactions</option>\r\n                                    <option className=\"dark:bg-gray-900\">Paid</option>\r\n                                    <option className=\"dark:bg-gray-900\">Partial</option>\r\n                                    <option className=\"dark:bg-gray-900\">Due</option>\r\n                                    <option className=\"dark:bg-gray-900\">Void</option>\r\n                                </select>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* High-Performance Ledger */}\r\n                <div className=\"relative z-10 transition-all duration-500\">\r\n                    {loading ? (\r\n                        <div className=\"bg-white/50 dark:bg-black/20 backdrop-blur-xl rounded-[32px] box-outline p-20 text-center transition-all duration-300\">\r\n                            <div className=\"relative inline-block\">\r\n                                <div className=\"w-16 h-16 border-t-2 border-indigo-500 rounded-full animate-spin mx-auto\"></div>\r\n                                <div className=\"absolute inset-0 bg-indigo-500/20 blur-xl rounded-full\"></div>\r\n                            </div>\r\n                            <p className=\"mt-4 text-indigo-600 dark:text-indigo-400 font-bold tracking-widest uppercase text-xs animate-pulse font-mono\">Accessing Ledger...</p>\r\n                        </div>\r\n                    ) : filteredInvoices.length === 0 ? (\r\n                        <div className=\"bg-white/50 dark:bg-black/20 backdrop-blur-xl rounded-[32px] box-outline p-20 text-center group transition-all duration-300\">\r\n                            <div className=\"relative inline-block mb-6\">\r\n                                <div className=\"absolute inset-0 bg-indigo-500/10 blur-3xl rounded-full group-hover:bg-indigo-500/20 transition-all duration-700\"></div>\r\n                                <FileText className=\"w-20 h-20 text-indigo-500/20 group-hover:text-indigo-500/40 transition-all duration-500 relative z-10 mx-auto\" strokeWidth={1} />\r\n                            </div>\r\n                            <h3 className=\"text-2xl font-black text-gray-900 dark:text-white tracking-tight\">Archive Cleared</h3>\r\n                            <p className=\"text-gray-500 dark:text-gray-400 mt-2 font-medium\">No records matching your search parameters were found.</p>\r\n                            <button onClick={() => navigate('/invoice/new')} className=\"mt-8 px-8 py-3 bg-indigo-500/10 text-indigo-600 dark:text-indigo-400 border border-indigo-500/20 rounded-xl hover:bg-indigo-500 hover:text-white transition-all duration-300 font-bold uppercase tracking-widest text-xs\">\r\n                                Create New Invoice\r\n                            </button>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"bg-white/50 dark:bg-black/20 backdrop-blur-xl rounded-[32px] box-outline overflow-hidden shadow-2xl transition-all duration-300\">\r\n                            {/* Desktop Table View */}\r\n                            <div className=\"hidden md:block overflow-x-auto\">\r\n                                <table className=\"w-full\">\r\n                                    <thead>\r\n                                        <tr className=\"border-b-[2.5px] border-black dark:border-white/90\">\r\n                                            <th className=\"px-8 py-6 text-left text-[10px] font-black text-indigo-600 dark:text-indigo-400 uppercase tracking-[0.2em]\">Reference</th>\r\n                                            <th className=\"px-8 py-6 text-left text-[10px] font-black text-indigo-600 dark:text-indigo-400 uppercase tracking-[0.2em]\">Stakeholder</th>\r\n                                            <th className=\"px-8 py-6 text-left text-[10px] font-black text-indigo-600 dark:text-indigo-400 uppercase tracking-[0.2em]\">Timeline</th>\r\n                                            <th className=\"px-8 py-6 text-right text-[10px] font-black text-indigo-600 dark:text-indigo-400 uppercase tracking-[0.2em]\">Gross Capital</th>\r\n                                            <th className=\"px-8 py-6 text-center text-[10px] font-black text-indigo-600 dark:text-indigo-400 uppercase tracking-[0.2em]\">Verification Status</th>\r\n                                            <th className=\"px-8 py-6 text-right text-[10px] font-black text-indigo-600 dark:text-indigo-400 uppercase tracking-[0.2em]\">System Actions</th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tbody className=\"divide-y divide-gray-100 dark:divide-white/5\">\r\n                                        {filteredInvoices.map((invoice) => (\r\n                                            <tr key={invoice._id} className=\"group hover:bg-indigo-500/[0.02] transition-colors duration-300\">\r\n                                                <td className=\"px-8 py-5\">\r\n                                                    <div>\r\n                                                        <div className=\"text-base font-black text-gray-900 dark:text-white group-hover:text-indigo-600 dark:group-hover:text-indigo-400 transition-colors font-mono\">\r\n                                                            {invoice.invoiceNo}\r\n                                                        </div>\r\n                                                        <div className=\"text-[10px] font-bold text-gray-400 dark:text-gray-500 uppercase tracking-tighter mt-0.5\">\r\n                                                            {invoice.invoiceType} ID\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </td>\r\n                                                <td className=\"px-8 py-5\">\r\n                                                    <div className=\"flex items-center space-x-3\">\r\n                                                        <div className=\"w-9 h-9 rounded-full bg-gradient-to-br from-indigo-500/20 to-violet-500/10 flex items-center justify-center text-indigo-600 dark:text-indigo-400 font-black text-xs border border-indigo-500/10\">\r\n                                                            {(invoice.customer?.name || invoice.customerName || 'W').charAt(0).toUpperCase()}\r\n                                                        </div>\r\n                                                        <div>\r\n                                                            <div className=\"text-sm font-bold text-gray-900 dark:text-white\">\r\n                                                                {invoice.customer?.name || invoice.customerName || 'Walk-in Partner'}\r\n                                                            </div>\r\n                                                            {invoice.customer?.phone && (\r\n                                                                <div className=\"text-[10px] font-medium text-gray-400 dark:text-gray-500 tracking-tight\">\r\n                                                                    +91 {invoice.customer.phone}\r\n                                                                </div>\r\n                                                            )}\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </td>\r\n                                                <td className=\"px-8 py-5\">\r\n                                                    <div className=\"text-sm font-bold text-gray-600 dark:text-gray-300\">\r\n                                                        {formatDate(invoice.invoiceDate || invoice.createdAt)}\r\n                                                    </div>\r\n                                                    <div className=\"text-[10px] font-medium text-gray-400/60 dark:text-gray-500/40 uppercase tracking-tighter\">logged date</div>\r\n                                                </td>\r\n                                                <td className=\"px-8 py-5 text-right\">\r\n                                                    <div className=\"text-base font-black text-gray-900 dark:text-white rupee font-mono tracking-tighter\">\r\n                                                        {formatINR(invoice.grandTotal)}\r\n                                                    </div>\r\n                                                    <div className=\"text-[10px] font-bold text-indigo-600/60 dark:text-indigo-400/40 uppercase tracking-tighter\">\r\n                                                        {formatINR(invoice.paidAmount)} settled\r\n                                                    </div>\r\n                                                </td>\r\n                                                <td className=\"px-8 py-5\">\r\n                                                    <div className=\"flex justify-center\">\r\n                                                        <span className={`px-4 py-1 rounded-[10px] text-[10px] font-black uppercase tracking-widest border transition-all duration-300 ${invoice.status === 'Paid' ? 'bg-emerald-500/10 text-emerald-600 border-emerald-500/20 hover:bg-emerald-500/20' :\r\n                                                            invoice.status === 'Partial' ? 'bg-amber-500/10 text-amber-600 border-amber-500/20 hover:bg-amber-500/20' :\r\n                                                                invoice.status === 'Due' ? 'bg-red-500/10 text-red-600 border-red-500/20 hover:bg-red-500/20' :\r\n                                                                    'bg-gray-500/10 text-gray-400 border-gray-500/20 line-through'\r\n                                                            }`}>\r\n                                                            {invoice.status}\r\n                                                        </span>\r\n                                                    </div>\r\n                                                </td>\r\n                                                <td className=\"px-8 py-5 text-right\">\r\n                                                    <div className=\"flex items-center justify-end space-x-2\">\r\n                                                        <button\r\n                                                            onClick={() => navigate(`/invoice/${invoice._id}`)}\r\n                                                            className=\"p-3 bg-gray-50/50 dark:bg-white/5 text-gray-400 hover:text-indigo-500 hover:bg-indigo-500/5 rounded-xl transition-all duration-300\"\r\n                                                            title=\"Inspect\"\r\n                                                        >\r\n                                                            <Eye className=\"w-4 h-4\" />\r\n                                                        </button>\r\n                                                        <button\r\n                                                            className=\"p-3 bg-gray-50/50 dark:bg-white/5 text-gray-400 hover:text-emerald-500 hover:bg-emerald-500/5 rounded-xl transition-all duration-300\"\r\n                                                            title=\"Reprint\"\r\n                                                        >\r\n                                                            <Download className=\"w-4 h-4\" />\r\n                                                        </button>\r\n                                                        <button\r\n                                                            onClick={() => handleVoidClick(invoice)}\r\n                                                            className=\"p-3 bg-gray-50/50 dark:bg-white/5 text-gray-400 hover:text-red-500 hover:bg-red-500/5 rounded-xl transition-all duration-300\"\r\n                                                            title=\"Liquidate\"\r\n                                                        >\r\n                                                            <Trash2 className=\"w-4 h-4\" />\r\n                                                        </button>\r\n                                                    </div>\r\n                                                </td>\r\n                                            </tr>\r\n                                        ))}\r\n                                    </tbody>\r\n                                </table>\r\n                            </div>\r\n\r\n                            {/* Mobile Card View */}\r\n                            <div className=\"md:hidden space-y-4 p-4\">\r\n                                {filteredInvoices.map((invoice) => (\r\n                                    <div key={invoice._id} className=\"bg-white dark:bg-white/5 rounded-2xl p-5 border border-gray-100 dark:border-white/10 shadow-sm relative overflow-hidden group\">\r\n                                        <div className=\"flex justify-between items-start mb-4\">\r\n                                            <div>\r\n                                                <div className=\"text-xl font-black text-gray-900 dark:text-white font-mono tracking-tight\">\r\n                                                    {invoice.invoiceNo}\r\n                                                </div>\r\n                                                <div className=\"test-xs font-bold text-indigo-500 uppercase tracking-wider mt-1\">\r\n                                                    {formatDate(invoice.invoiceDate || invoice.createdAt)}\r\n                                                </div>\r\n                                            </div>\r\n                                            <span className={`px-3 py-1 rounded-lg text-[10px] font-black uppercase tracking-widest border ${invoice.status === 'Paid' ? 'bg-emerald-500/10 text-emerald-600 border-emerald-500/20' :\r\n                                                invoice.status === 'Partial' ? 'bg-amber-500/10 text-amber-600 border-amber-500/20' :\r\n                                                    invoice.status === 'Due' ? 'bg-red-500/10 text-red-600 border-red-500/20' :\r\n                                                        'bg-gray-500/10 text-gray-400 border-gray-500/20 line-through'\r\n                                                }`}>\r\n                                                {invoice.status}\r\n                                            </span>\r\n                                        </div>\r\n\r\n                                        <div className=\"flex items-center space-x-3 mb-4 p-3 bg-gray-50 dark:bg-black/20 rounded-xl\">\r\n                                            <div className=\"w-8 h-8 rounded-full bg-indigo-100 dark:bg-indigo-500/20 flex items-center justify-center text-indigo-600 dark:text-indigo-400 font-bold text-xs\">\r\n                                                {(invoice.customer?.name || invoice.customerName || 'W').charAt(0).toUpperCase()}\r\n                                            </div>\r\n                                            <div>\r\n                                                <div className=\"text-sm font-bold text-gray-900 dark:text-white\">\r\n                                                    {invoice.customer?.name || invoice.customerName || 'Walk-in Partner'}\r\n                                                </div>\r\n                                                {invoice.customer?.phone && (\r\n                                                    <div className=\"text-[10px] text-gray-500 dark:text-gray-400\">\r\n                                                        +91 {invoice.customer.phone}\r\n                                                    </div>\r\n                                                )}\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        <div className=\"flex justify-between items-end mb-4 border-t border-gray-100 dark:border-white/5 pt-4\">\r\n                                            <div>\r\n                                                <div className=\"text-[10px] uppercase tracking-widest text-gray-500 dark:text-gray-400 font-bold\">Total Amount</div>\r\n                                                <div className=\"text-2xl font-black text-gray-900 dark:text-white rupee font-mono\">\r\n                                                    {formatINR(invoice.grandTotal)}\r\n                                                </div>\r\n                                            </div>\r\n                                            <div className=\"text-right\">\r\n                                                <div className=\"text-[10px] uppercase tracking-widest text-gray-500 dark:text-gray-400 font-bold\">Paid</div>\r\n                                                <div className=\"text-lg font-bold text-emerald-600 dark:text-emerald-400 rupee font-mono\">\r\n                                                    {formatINR(invoice.paidAmount)}\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        <div className=\"grid grid-cols-3 gap-2\">\r\n                                            <button\r\n                                                onClick={() => navigate(`/invoice/${invoice._id}`)}\r\n                                                className=\"flex items-center justify-center py-3 bg-indigo-50 dark:bg-indigo-500/10 text-indigo-600 dark:text-indigo-400 rounded-xl font-bold text-xs uppercase tracking-wider hover:bg-indigo-100 dark:hover:bg-indigo-500/20 transition-colors\"\r\n                                            >\r\n                                                <Eye className=\"w-4 h-4 mr-2\" /> View\r\n                                            </button>\r\n                                            <button\r\n                                                className=\"flex items-center justify-center py-3 bg-emerald-50 dark:bg-emerald-500/10 text-emerald-600 dark:text-emerald-400 rounded-xl font-bold text-xs uppercase tracking-wider hover:bg-emerald-100 dark:hover:bg-emerald-500/20 transition-colors\"\r\n                                            >\r\n                                                <Download className=\"w-4 h-4 mr-2\" /> PDF\r\n                                            </button>\r\n                                            <button\r\n                                                onClick={() => handleVoidClick(invoice)}\r\n                                                className=\"flex items-center justify-center py-3 bg-red-50 dark:bg-red-500/10 text-red-600 dark:text-red-400 rounded-xl font-bold text-xs uppercase tracking-wider hover:bg-red-100 dark:hover:bg-red-500/20 transition-colors\"\r\n                                            >\r\n                                                <Trash2 className=\"w-4 h-4 mr-2\" /> Void\r\n                                            </button>\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Intelligent Analytics Dashboard */}\r\n                {!loading && filteredInvoices.length > 0 && (\r\n                    <div className=\"mt-10 grid grid-cols-2 md:grid-cols-4 gap-4 relative z-10\">\r\n                        <div className=\"bg-gradient-to-br from-indigo-100 via-indigo-50 to-white dark:bg-gradient-to-br dark:from-indigo-950 dark:via-black dark:to-black backdrop-blur-xl rounded-[28px] p-6 box-outline shadow-lg shadow-indigo-200/50 dark:shadow-[0_0_15px_rgba(99,102,241,0.15)] group transition-all duration-300\">\r\n                            <p className=\"text-[10px] font-black text-indigo-800/60 dark:text-indigo-300 uppercase tracking-[0.2em] mb-3\">Volume Trace</p>\r\n                            <div className=\"flex items-end justify-between\">\r\n                                <p className=\"text-3xl font-black text-indigo-600 dark:text-transparent dark:bg-clip-text dark:bg-gradient-to-r dark:from-indigo-100 dark:via-indigo-300 dark:to-indigo-500 font-mono\">{filteredInvoices.length}</p>\r\n                                <div className=\"p-2 bg-indigo-500/10 rounded-lg group-hover:bg-indigo-500/20 transition-colors\">\r\n                                    <FileText className=\"w-4 h-4 text-indigo-600 dark:text-indigo-400\" />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"bg-gradient-to-br from-emerald-100 via-emerald-50 to-white dark:bg-gradient-to-br dark:from-emerald-950 dark:via-black dark:to-black backdrop-blur-xl rounded-[28px] p-6 box-outline shadow-lg shadow-emerald-200/50 dark:shadow-[0_0_15px_rgba(16,185,129,0.15)] group transition-all duration-300\">\r\n                            <p className=\"text-[10px] font-black text-emerald-800/60 dark:text-emerald-300 uppercase tracking-[0.2em] mb-3\">Gross Liquidity</p>\r\n                            <div className=\"flex items-end justify-between\">\r\n                                <p className=\"text-2xl font-black text-emerald-600 dark:text-transparent dark:bg-clip-text dark:bg-gradient-to-r dark:from-emerald-100 dark:via-emerald-300 dark:to-emerald-500 rupee font-mono tracking-tighter\">\r\n                                    {formatINR(filteredInvoices.reduce((sum, inv) => sum + inv.grandTotal, 0))}\r\n                                </p>\r\n                                <div className=\"p-2 bg-white/80 dark:bg-emerald-500/20 rounded-lg border border-emerald-100 dark:border-emerald-500/30 group-hover:bg-emerald-600 dark:group-hover:bg-emerald-500 transition-colors\">\r\n                                    <Plus className=\"w-4 h-4 text-emerald-600 dark:text-emerald-300\" />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"bg-gradient-to-br from-cyan-100 via-cyan-50 to-white dark:bg-gradient-to-br dark:from-cyan-950 dark:via-black dark:to-black backdrop-blur-xl rounded-[28px] p-6 box-outline shadow-lg shadow-cyan-200/50 dark:shadow-[0_0_15px_rgba(6,182,212,0.15)] group transition-all duration-300\">\r\n                            <p className=\"text-[10px] font-black text-cyan-800/60 dark:text-cyan-300 uppercase tracking-[0.2em] mb-3\">Settled Flow</p>\r\n                            <div className=\"flex items-end justify-between\">\r\n                                <p className=\"text-2xl font-black text-cyan-600 dark:text-transparent dark:bg-clip-text dark:bg-gradient-to-r dark:from-cyan-100 dark:via-cyan-300 dark:to-cyan-500 rupee font-mono tracking-tighter\">\r\n                                    {formatINR(filteredInvoices.reduce((sum, inv) => sum + inv.paidAmount, 0))}\r\n                                </p>\r\n                                <div className=\"p-2 bg-white/80 dark:bg-cyan-500/20 rounded-lg border border-cyan-100 dark:border-cyan-500/30 group-hover:bg-cyan-600 dark:group-hover:bg-cyan-500 transition-colors\">\r\n                                    <div className=\"w-4 h-4 bg-cyan-500 rounded-full animate-pulse shadow-[0_0_10px_rgba(6,182,212,0.5)]\"></div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"bg-gradient-to-br from-red-100 via-red-50 to-white dark:bg-gradient-to-br dark:from-red-950 dark:via-black dark:to-black backdrop-blur-xl rounded-[28px] p-6 box-outline shadow-lg shadow-red-200/50 dark:shadow-[0_0_15px_rgba(239,68,68,0.15)] group transition-all duration-300\">\r\n                            <p className=\"text-[10px] font-black text-red-800/60 dark:text-red-300 uppercase tracking-[0.2em] mb-3\">Deficit Ratio</p>\r\n                            <div className=\"flex items-end justify-between\">\r\n                                <p className=\"text-2xl font-black text-red-600 dark:text-red-400 rupee font-mono tracking-tighter\">\r\n                                    {formatINR(filteredInvoices.reduce((sum, inv) => sum + (inv.grandTotal - inv.paidAmount), 0))}\r\n                                </p>\r\n                                <div className=\"p-2 bg-red-500/10 rounded-lg group-hover:bg-red-500/20 transition-colors\">\r\n                                    <Trash2 className=\"w-4 h-4 text-red-600 dark:text-red-400\" />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Delete Confirmation Modal */}\r\n            {showVoidModal && (\r\n                <div className=\"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50 animate-in fade-in duration-300\">\r\n                    <div className=\"bg-white dark:bg-[#0A0A0A] rounded-[32px] max-w-md w-full p-8 box-outline shadow-2xl animate-in zoom-in duration-300 overflow-hidden relative\">\r\n                        <div className=\"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-red-500 to-rose-600\"></div>\r\n\r\n                        <div className=\"flex items-center gap-4 mb-6\">\r\n                            <div className=\"p-3 bg-red-500/10 rounded-2xl\">\r\n                                <Trash2 className=\"w-6 h-6 text-red-500\" />\r\n                            </div>\r\n                            <h3 className=\"text-2xl font-black text-gray-900 dark:text-white tracking-tight\">Liquidate Invoice</h3>\r\n                        </div>\r\n\r\n                        <div className=\"p-6 bg-red-50 dark:bg-red-900/10 rounded-2xl border border-red-100 dark:border-red-500/20 mb-8\">\r\n                            <p className=\"text-sm text-red-800 dark:text-red-300 font-bold mb-4 uppercase tracking-widest\">Permanent Removal Protocol</p>\r\n                            <ul className=\"space-y-3\">\r\n                                {[\r\n                                    'Restores items to primary inventory',\r\n                                    'Reverts customer balance liability',\r\n                                    'Purges transaction from official ledger'\r\n                                ].map((item, i) => (\r\n                                    <li key={i} className=\"flex items-start gap-3 text-sm text-red-700 dark:text-red-400/80\">\r\n                                        <div className=\"w-1.5 h-1.5 rounded-full bg-red-500 mt-1.5 flex-shrink-0\"></div>\r\n                                        {item}\r\n                                    </li>\r\n                                ))}\r\n                            </ul>\r\n                        </div>\r\n\r\n                        <div className=\"flex gap-4\">\r\n                            <button\r\n                                onClick={() => setShowVoidModal(false)}\r\n                                className=\"flex-1 px-6 py-4 bg-gray-100 dark:bg-white/5 text-gray-600 dark:text-gray-400 rounded-2xl font-black uppercase tracking-widest text-xs hover:bg-gray-200 dark:hover:bg-white/10 transition-all\"\r\n                            >\r\n                                Abort\r\n                            </button>\r\n                            <button\r\n                                onClick={confirmDelete}\r\n                                className=\"flex-1 px-6 py-4 bg-red-600 text-white rounded-2xl font-black uppercase tracking-widest text-xs shadow-xl shadow-red-600/20 hover:bg-red-500 transition-all transform hover:-translate-y-1\"\r\n                            >\r\n                                Confirm\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </Layout>\r\n    );\r\n};\r\n\r\nexport default InvoiceHistory;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\pages\\InvoiceView.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'formatINR' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"formatINR"},"fix":{"range":[222,268],"text":""},"desc":"Remove unused variable 'formatINR'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'formatDate' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"formatDate"},"fix":{"range":[270,313],"text":""},"desc":"Remove unused variable 'formatDate'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport api, { BACKEND_URL } from '../utils/api';\r\nimport { useSettings } from '../context/SettingsContext';\r\nimport { formatINR } from '../utils/currency';\r\nimport { formatDate } from '../utils/date';\r\nimport { Printer, ArrowLeft, Download, Share2, Mail, FileText, MessageCircle } from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\nimport { QRCodeSVG } from 'qrcode.react';\r\nimport { useReactToPrint } from 'react-to-print';\r\nimport ShareInvoiceModal from '../components/Invoice/ShareInvoiceModal';\r\nimport { sharePdf } from '../utils/pdfShare';\r\nimport { InvoiceRenderer } from '../components/Invoice/InvoiceTemplates';\r\n\r\nconst InvoiceView = ({ isPublic = false }) => {\r\n    const { id } = useParams();\r\n    const navigate = useNavigate();\r\n    const { settings } = useSettings();\r\n    const [invoice, setInvoice] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [isShareModalOpen, setIsShareModalOpen] = useState(false);\r\n    const componentRef = React.useRef();\r\n\r\n    const handlePrint = useReactToPrint({\r\n        content: () => componentRef.current,\r\n        documentTitle: invoice ? `Invoice_${invoice.invoiceNo}` : 'Invoice',\r\n    });\r\n\r\n    useEffect(() => {\r\n        const fetchInvoice = async () => {\r\n            try {\r\n                const endpoint = isPublic ? `/public/invoices/${id}` : `/invoices/${id}`;\r\n                const { data } = await api.get(endpoint);\r\n                setInvoice(data);\r\n                setLoading(false);\r\n            } catch (error) {\r\n                console.error('Error fetching invoice:', error);\r\n                if (!isPublic) toast.error('Failed to load invoice');\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        if (id) {\r\n            fetchInvoice();\r\n        }\r\n    }, [id, isPublic]);\r\n\r\n    const handleShare = async (platform) => {\r\n        if (!invoice) return;\r\n        const fileName = `Invoice_${invoice.invoiceNo}.pdf`;\r\n        const title = `Invoice ${invoice.invoiceNo}`;\r\n        const text = `Please find attached invoice ${invoice.invoiceNo} from ${seller.storeName}`;\r\n\r\n        // Using \"Download\" button -> Force download, High Quality\r\n        if (platform === 'download') {\r\n            await sharePdf('invoice-content', fileName, title, text, { scale: 2, forceDownload: true });\r\n        }\r\n        // Using \"Share\" button -> Use standard share (mostly mobile), Standard Quality (Speed)\r\n        else {\r\n            await sharePdf('invoice-content', fileName, title, text, { scale: 2, forceDownload: false });\r\n        }\r\n    };\r\n\r\n    const handleWhatsAppShare = () => {\r\n        setIsShareModalOpen(true);\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\r\n                <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (!invoice) return null;\r\n\r\n    // Use invoice-specific seller details if available (Snapshot), otherwise fallback to global settings\r\n    const seller = invoice.sellerDetails || {\r\n        storeName: settings?.storeName || settings?.shopName,\r\n        tagline: settings?.tagline,\r\n        address: settings?.address,\r\n        phone: settings?.phone,\r\n        email: settings?.email,\r\n        gstin: settings?.gstin || settings?.gstNumber,\r\n        website: settings?.website,\r\n        bankDetails: (settings?.bankName && settings?.accountNumber)\r\n            ? `${settings.bankName}, A/c: ${settings.accountNumber}, IFSC: ${settings.ifscCode}`\r\n            : '',\r\n        upiId: settings?.upi || settings?.upiId,\r\n        footerFontSize: settings?.footerFontSize || 12,\r\n        footerFontFamily: settings?.footerFontFamily || 'sans-serif',\r\n        footerAlignment: settings?.footerAlignment || 'center',\r\n        invoiceFooterText: settings?.invoiceFooterText || ''\r\n    };\r\n\r\n    // Prepare data for InvoiceRenderer\r\n    const rendererData = {\r\n        invoiceNo: invoice.invoiceNo,\r\n        date: invoice.invoiceDate || invoice.createdAt,\r\n        dueDate: invoice.dueDate,\r\n        customerName: (invoice.customer && invoice.customer.name) ? invoice.customer.name : (invoice.customerName || 'Walk-in Customer'),\r\n        customerPhone: invoice.customerPhone || invoice.customer?.phone,\r\n        customerAddress: invoice.customerAddress || invoice.customer?.address,\r\n        customerGstin: invoice.customerGstin || invoice.customer?.gstin,\r\n        items: invoice.items.map(item => ({\r\n            ...item,\r\n            price: item.pricePerUnit,\r\n            total: item.totalAmount\r\n        })),\r\n        subtotal: invoice.totalTaxable,\r\n        tax: invoice.totalGST,\r\n        total: invoice.grandTotal,\r\n        amountPaid: invoice.amountPaid || 0,\r\n        balanceDue: invoice.balanceDue || 0,\r\n        terms: invoice.notes || seller.termsAndConditions,\r\n        upiId: seller.upiId,\r\n        digitalSignature: settings?.digitalSignature,\r\n        authSignLabel: seller.authSignLabel\r\n    };\r\n\r\n    const rendererSettings = {\r\n        ...settings,\r\n        shopName: seller.storeName,\r\n        address: seller.address,\r\n        phone: seller.phone,\r\n        email: seller.email,\r\n        gstin: seller.gstin,\r\n        invoiceFooterText: seller.invoiceFooterText,\r\n        bankDetails: seller.bankDetails,\r\n        brandColor: settings?.brandColor,\r\n        primaryTextColor: settings?.primaryTextColor,\r\n        logo: settings?.logo,\r\n        // Use invoice-specific settings if available, otherwise global defaults\r\n        showWatermark: settings?.invoiceTemplate?.showWatermark ?? true,\r\n        fieldVisibility: settings?.invoiceTemplate?.fieldVisibility || {\r\n            shippingAddress: false,\r\n            taxBreakdown: true,\r\n            signature: true,\r\n            footer: true,\r\n            bankDetails: true,\r\n            qrCode: true,\r\n            terms: true\r\n        }\r\n    };\r\n\r\n    const templateId = invoice.templateId || settings?.invoiceTemplate?.templateId || 'modern';\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 p-6 print:p-0 print:bg-white transition-all duration-300\">\r\n            {/* Toolbar - Hidden in Print */}\r\n            <div className=\"max-w-4xl mx-auto mb-6 flex items-center justify-between print:hidden\">\r\n                <div>\r\n                    {!isPublic && (\r\n                        <button\r\n                            onClick={() => navigate('/invoices')}\r\n                            className=\"flex items-center gap-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors\"\r\n                        >\r\n                            <ArrowLeft className=\"w-5 h-5\" />\r\n                            Back to History\r\n                        </button>\r\n                    )}\r\n                </div>\r\n                <div className=\"flex items-center gap-3\">\r\n                    <button\r\n                        onClick={() => handleShare('download')}\r\n                        className=\"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm\"\r\n                    >\r\n                        <Download className=\"w-4 h-4\" />\r\n                        Download PDF\r\n                    </button>\r\n                    {!isPublic && (\r\n                        <button\r\n                            onClick={handleWhatsAppShare}\r\n                            className=\"flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors shadow-sm\"\r\n                        >\r\n                            <MessageCircle className=\"w-4 h-4\" />\r\n                            WhatsApp\r\n                        </button>\r\n                    )}\r\n                    <button\r\n                        onClick={handlePrint}\r\n                        className=\"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm\"\r\n                    >\r\n                        <Printer className=\"w-4 h-4\" />\r\n                        Print Invoice\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Invoice Paper */}\r\n            <div ref={componentRef} id=\"invoice-content\" className=\"max-w-4xl mx-auto bg-white shadow-xl rounded-xl overflow-hidden print:shadow-none print:rounded-none print:a4-page-container transition-all duration-300 text-gray-900\">\r\n                <InvoiceRenderer\r\n                    templateId={templateId}\r\n                    data={rendererData}\r\n                    settings={rendererSettings}\r\n                />\r\n            </div>\r\n\r\n            <ShareInvoiceModal\r\n                isOpen={isShareModalOpen}\r\n                onClose={() => setIsShareModalOpen(false)}\r\n                invoice={invoice}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default InvoiceView;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\pages\\LetterheadCreator.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'useRef' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":1,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":44,"suggestions":[{"messageId":"removeVar","data":{"varName":"useRef"},"fix":{"range":[35,43],"text":""},"desc":"Remove unused variable 'useRef'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { useNavigate, useParams, useLocation } from 'react-router-dom';\r\nimport Layout from '../components/Layout/Layout';\r\nimport api from '../utils/api';\r\nimport { useSettings } from '../context/SettingsContext';\r\nimport { ArrowLeft, Save, Printer, Type, Layout as LayoutIcon } from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst LetterheadCreator = () => {\r\n    const navigate = useNavigate();\r\n    const { id } = useParams();\r\n    const location = useLocation();\r\n    const isViewMode = location.pathname.includes('/view/');\r\n    const { settings } = useSettings();\r\n    const [loading, setLoading] = useState(false);\r\n    const [previewScale, setPreviewScale] = useState(0.65);\r\n\r\n    // Document Content\r\n    const [recipient, setRecipient] = useState({ name: '', address: '', email: '' });\r\n    const [subject, setSubject] = useState('');\r\n    const [content, setContent] = useState('');\r\n\r\n    // Copy Global Config to Local State (for potential overrides, though we stick to Global for now)\r\n    const [config, setConfig] = useState(null);\r\n\r\n    useEffect(() => {\r\n        if (settings?.letterheadConfig && !id) {\r\n            setConfig(settings.letterheadConfig);\r\n        }\r\n    }, [settings, id]);\r\n\r\n    const loadLetterhead = useCallback(async () => {\r\n        try {\r\n            setLoading(true);\r\n            const { data } = await api.get(`/letterheads/${id}`);\r\n            setRecipient(data.recipient || { name: '', address: '', email: '' });\r\n            setSubject(data.subject);\r\n            setContent(data.content);\r\n            if (data.configSnapshot) {\r\n                setConfig(data.configSnapshot);\r\n            } else if (settings?.letterheadConfig) {\r\n                setConfig(settings.letterheadConfig);\r\n            }\r\n        } catch (error) {\r\n            console.error('Failed to load', error);\r\n            toast.error('Failed to load letterhead');\r\n            navigate('/letterheads');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }, [id, settings, navigate]);\r\n\r\n    useEffect(() => {\r\n        if (id) {\r\n            loadLetterhead();\r\n        }\r\n    }, [id, loadLetterhead]);\r\n\r\n\r\n\r\n    const handleSave = async (status = 'Draft') => {\r\n        if (!subject || !content) {\r\n            toast.error('Subject and Content are required');\r\n            return;\r\n        }\r\n        try {\r\n            setLoading(true);\r\n            const data = {\r\n                recipient,\r\n                subject,\r\n                content,\r\n                status\r\n            };\r\n\r\n            if (id) {\r\n                await api.put(`/letterheads/${id}`, data);\r\n                toast.success('Letterhead updated');\r\n            } else {\r\n                await api.post('/letterheads', data);\r\n                toast.success('Letterhead created');\r\n            }\r\n            navigate('/letterheads');\r\n        } catch (error) {\r\n            console.error(error);\r\n            toast.error('Failed to save letterhead');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handlePrint = () => {\r\n        window.print();\r\n    };\r\n\r\n    if (!config) return <Layout><div className=\"p-6\">Loading config...</div></Layout>;\r\n\r\n    return (\r\n        <Layout>\r\n            <div className=\"p-6 h-[calc(100vh-64px)] overflow-hidden flex flex-col no-print bg-gray-50 dark:bg-gray-900\">\r\n                {/* Header */}\r\n                <div className=\"flex justify-between items-center mb-6\">\r\n                    <div className=\"flex items-center space-x-4\">\r\n                        <button onClick={() => navigate('/letterheads')} className=\"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors\">\r\n                            <ArrowLeft className=\"w-5 h-5 text-gray-600 dark:text-gray-400\" />\r\n                        </button>\r\n                        <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white\">Create Letter</h1>\r\n                    </div>\r\n                    <div className=\"flex space-x-3\">\r\n                        <button onClick={handlePrint} className=\"flex items-center space-x-2 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition\">\r\n                            <Printer className=\"w-4 h-4\" />\r\n                            <span>Print / PDF</span>\r\n                        </button>\r\n                        {!isViewMode && (\r\n                            <button onClick={() => handleSave('Final')} disabled={loading} className=\"flex items-center space-x-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors\">\r\n                                <Save className=\"w-4 h-4\" />\r\n                                <span>{loading ? 'Saving...' : id ? 'Update' : 'Save Document'}</span>\r\n                            </button>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"flex-1 flex gap-6 overflow-hidden\">\r\n                    {/* Editor Panel */}\r\n                    <div className=\"w-1/3 flex flex-col bg-white dark:bg-gray-800 rounded-[28px] shadow-xl border-[2.5px] border-amber-500/30 overflow-hidden relative\">\r\n                        {/* Soft Gold Glow */}\r\n                        <div className=\"absolute top-0 right-0 w-32 h-32 bg-amber-500/5 blur-[50px] pointer-events-none\"></div>\r\n\r\n                        <div className=\"p-4 bg-amber-50/50 dark:bg-amber-900/10 border-b-[2.5px] border-amber-500/20 flex items-center justify-between\">\r\n                            <h3 className=\"font-black text-amber-800 dark:text-amber-500 flex items-center uppercase tracking-widest text-xs\">\r\n                                <Type className=\"w-4 h-4 mr-2\" /> Content Editor\r\n                            </h3>\r\n                        </div>\r\n                        <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\r\n                            {/* Recipient */}\r\n                            <div className=\"space-y-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg\">\r\n                                <span className=\"text-xs font-bold text-gray-500 dark:text-gray-400 uppercase\">Recipient Details</span>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    placeholder=\"Recipient Name\"\r\n                                    value={recipient.name}\r\n                                    onChange={(e) => setRecipient({ ...recipient, name: e.target.value })}\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400\"\r\n                                />\r\n                                <textarea\r\n                                    placeholder=\"Address / Designation\"\r\n                                    value={recipient.address}\r\n                                    onChange={(e) => setRecipient({ ...recipient, address: e.target.value })}\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded text-sm h-16 resize-none bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400\"\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Subject */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Subject</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    placeholder=\"Subject of the letter...\"\r\n                                    value={subject}\r\n                                    onChange={(e) => setSubject(e.target.value)}\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg font-medium bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400\"\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Body */}\r\n                            <div className=\"flex-1 flex flex-col\">\r\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Body Content</label>\r\n                                <textarea\r\n                                    placeholder=\"Type your letter content here...\"\r\n                                    value={content}\r\n                                    onChange={(e) => setContent(e.target.value)}\r\n                                    className=\"w-full flex-1 p-3 border border-gray-300 dark:border-gray-600 rounded-lg text-sm leading-relaxed resize-none min-h-[300px] bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400\"\r\n                                    style={{ fontFamily: config.fontFamily }}\r\n                                />\r\n                                <p className=\"text-xs text-gray-400 mt-2\">\r\n                                    HTML or Markdown not supported in this version. Plain text only.\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Preview Panel (A4) */}\r\n                    <div className=\"flex-1 bg-slate-100 dark:bg-[#0F172A] rounded-2xl overflow-hidden flex flex-col border border-gray-200 dark:border-gray-800 relative shadow-inner\">\r\n                        {/* Background Grid Pattern */}\r\n                        <div className=\"absolute inset-0 opacity-[0.03] dark:opacity-[0.05] pointer-events-none\"\r\n                            style={{ backgroundImage: 'radial-gradient(#64748b 1px, transparent 1px)', backgroundSize: '24px 24px' }}>\r\n                        </div>\r\n                        {/* Zoom Control Overlay */}\r\n                        <div className=\"absolute top-4 right-4 z-50 flex items-center space-x-2 bg-white dark:bg-gray-800 p-2 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 opacity-80 hover:opacity-100 transition-opacity\">\r\n                            <span className=\"text-[10px] uppercase font-bold text-gray-500\">Zoom</span>\r\n                            <input\r\n                                type=\"range\"\r\n                                min=\"0.3\"\r\n                                max=\"1.2\"\r\n                                step=\"0.05\"\r\n                                value={previewScale}\r\n                                onChange={(e) => setPreviewScale(parseFloat(e.target.value))}\r\n                                className=\"w-20 accent-blue-600 h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer\"\r\n                            />\r\n                            <span className=\"w-8 text-center text-xs font-mono font-bold text-gray-600 dark:text-gray-300\">{Math.round(previewScale * 100)}%</span>\r\n                        </div>\r\n\r\n                        <div className=\"overflow-auto flex-1 flex justify-center p-8 relative z-10\">\r\n                            <div className=\"printable-content bg-white shadow-[0_35px_60px_-15px_rgba(0,0,0,0.3)] dark:shadow-[0_35px_60px_-15px_rgba(0,0,0,0.5)] relative transition-all duration-300 origin-top border-t border-gray-100\"\r\n                                style={{\r\n                                    width: '210mm',\r\n                                    minHeight: '297mm',\r\n                                    transform: `scale(${previewScale})`,\r\n                                    marginBottom: `-${(1 - previewScale) * 297}mm`,\r\n                                    paddingTop: `${config.marginTop}mm`,\r\n                                    paddingBottom: `${config.marginBottom}mm`,\r\n                                    paddingLeft: `${config.marginLeft}mm`,\r\n                                    paddingRight: `${config.marginRight}mm`,\r\n                                    fontFamily: config.fontFamily || 'Inter',\r\n                                    position: 'relative'\r\n                                }}\r\n                            >\r\n                                {/* Watermark */}\r\n                                {config.watermarkText && (\r\n                                    <div className=\"absolute inset-0 flex items-center justify-center z-0 pointer-events-none overflow-hidden\">\r\n                                        <div\r\n                                            className=\"font-bold text-gray-900 transform -rotate-45 whitespace-nowrap select-none\"\r\n                                            style={{\r\n                                                opacity: config.watermarkOpacity,\r\n                                                fontSize: `${config.watermarkSize || 100}px`\r\n                                            }}\r\n                                        >\r\n                                            {config.watermarkText}\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n\r\n                                {/* Header - Liceria Style */}\r\n                                <div className=\"relative z-10 flex justify-between items-start mb-4\">\r\n                                    {/* Branding (Left) */}\r\n                                    <div className=\"flex flex-col items-start\">\r\n                                        <div className=\"flex items-center gap-3 mb-2\">\r\n                                            {settings?.logo && (\r\n                                                <img src={settings.logo} className=\"h-16 w-auto object-contain\" alt=\"Logo\" />\r\n                                            )}\r\n                                            <div>\r\n                                                <h1 className=\"text-3xl font-bold text-gray-800 uppercase tracking-wide leading-none\">{settings.shopName || ''}</h1>\r\n                                                <p className=\"text-sm text-gray-500 tracking-[0.2em]\">{settings.tagline || ''}</p>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Contact Info (Right) */}\r\n                                    <div className=\"text-right text-xs text-gray-600 leading-tight\">\r\n                                        <p className=\"font-semibold text-gray-800\">{settings.address?.split('\\n')[0]}</p>\r\n                                        <p>{settings.address?.split('\\n')[1]}</p>\r\n                                        {settings.phone && (\r\n                                            <p className=\"mt-2 flex items-center justify-end gap-2\">\r\n                                                {settings.phone} <span className=\"text-[10px] bg-red-500 text-white rounded-full p-1 w-5 h-5 flex items-center justify-center\"></span>\r\n                                            </p>\r\n                                        )}\r\n                                        {settings.email && (\r\n                                            <p className=\"flex items-center justify-end gap-2 mt-1\">\r\n                                                {settings.email} <span className=\"text-[10px] bg-red-500 text-white rounded-full p-1 w-5 h-5 flex items-center justify-center\"></span>\r\n                                            </p>\r\n                                        )}\r\n                                        {settings.website && (\r\n                                            <p className=\"flex items-center justify-end gap-2 mt-1\">\r\n                                                {settings.website} <span className=\"text-[10px] bg-red-500 text-white rounded-full p-1 w-5 h-5 flex items-center justify-center\"></span>\r\n                                            </p>\r\n                                        )}\r\n                                        {settings.gstNumber && (\r\n                                            <p className=\"flex items-center justify-end gap-2 mt-1 font-semibold\">\r\n                                                GSTIN: {settings.gstNumber}\r\n                                            </p>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Graphical Separator - Red/Black Line */}\r\n                                <div className=\"relative z-10 w-full flex h-3 mb-10\">\r\n                                    <div className=\"w-1/3\" style={{ backgroundColor: settings.brandColor || '#EF4444' }}></div>\r\n                                    <div className=\"flex-1 bg-black\"></div>\r\n                                </div>\r\n\r\n                                {/* Letter Content */}\r\n                                <div className=\"relative z-10 text-gray-900 leading-relaxed whitespace-pre-wrap\">\r\n                                    {/* Date */}\r\n                                    <div className=\"mb-8 text-right font-medium\">\r\n                                        {new Date().toLocaleDateString('en-IN', { year: 'numeric', month: 'long', day: 'numeric' })}\r\n                                    </div>\r\n\r\n                                    {/* Recipient Block */}\r\n                                    {(recipient.name || recipient.address) && (\r\n                                        <div className=\"mb-12\">\r\n                                            <p className=\"font-bold text-lg\">{recipient.name}</p>\r\n                                            <p className=\"whitespace-pre-line text-gray-600\">{recipient.address}</p>\r\n                                        </div>\r\n                                    )}\r\n\r\n                                    {/* Subject */}\r\n                                    {subject && (\r\n                                        <div className=\"mb-8 font-bold text-lg underline decoration-2 underline-offset-4 decoration-gray-400\">\r\n                                            Subject: {subject}\r\n                                        </div>\r\n                                    )}\r\n\r\n                                    {/* Body */}\r\n                                    <div className=\"min-h-[300px] text-justify text-base\">\r\n                                        {content || <span className=\"text-gray-300 italic\">Start typing content...</span>}\r\n                                    </div>\r\n\r\n                                    {/* Signature Block */}\r\n                                    <div className=\"mt-20 text-right\">\r\n                                        <p className=\"font-bold text-lg\">{settings.shopName}</p>\r\n                                        <div className=\"h-24\"></div>\r\n                                        <p className=\"text-sm text-gray-600 border-t inline-block pt-2 px-8 border-gray-400\">Authorized Signatory</p>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Footer - 4 Color Blocks */}\r\n                                <div className=\"absolute bottom-0 left-0 right-0 h-12 flex\">\r\n                                    <div className=\"flex-1\" style={{ backgroundColor: settings.brandColor || '#EF4444' }}></div>\r\n                                    <div className=\"flex-1\" style={{ backgroundColor: settings.brandColor || '#EF4444', filter: 'brightness(0.9)' }}></div>\r\n                                    <div className=\"flex-1\" style={{ backgroundColor: settings.brandColor || '#EF4444', filter: 'brightness(0.8)' }}></div>\r\n                                    <div className=\"flex-1\" style={{ backgroundColor: settings.brandColor || '#EF4444', filter: 'brightness(0.7)' }}></div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Print Styles */}\r\n            <style>{`\r\n                @media print {\r\n                    @page { size: A4; margin: 0; }\r\n                    body { margin: 0; background: white; }\r\n                    .no-print { display: none !important; }\r\n                    .printable-content {\r\n                        box-shadow: none !important;\r\n                        margin: 0 !important;\r\n                        width: 210mm !important;\r\n                        height: 297mm !important;\r\n                        position: absolute !important;\r\n                        top: 0 !important;\r\n                        left: 0 !important;\r\n                        overflow: hidden !important;\r\n                    }\r\n                }\r\n            `}</style>\r\n        </Layout>\r\n    );\r\n};\r\n\r\nexport default LetterheadCreator;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\pages\\LetterheadList.jsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n  27 |\n  28 |     useEffect(() => {\n> 29 |         loadLetterheads();\n     |         ^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  30 |     }, [loadLetterheads]);\n  31 |\n  32 |","line":29,"column":9,"nodeType":null,"endLine":29,"endColumn":24},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":40,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":23}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport Layout from '../components/Layout/Layout';\r\nimport api from '../utils/api';\r\nimport { Plus, Search, FileText, Trash2, Printer, Edit } from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\nimport { formatDate } from '../utils/date';\r\n\r\nconst LetterheadList = () => {\r\n    const navigate = useNavigate();\r\n    const [letterheads, setLetterheads] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n\r\n    const loadLetterheads = useCallback(async () => {\r\n        try {\r\n            setLoading(true);\r\n            const { data } = await api.get(`/letterheads?search=${searchTerm}`);\r\n            setLetterheads(data);\r\n            setLoading(false);\r\n        } catch (error) {\r\n            console.error('Failed to load letterheads', error);\r\n            toast.error('Failed to load letterheads');\r\n            setLoading(false);\r\n        }\r\n    }, [searchTerm]);\r\n\r\n    useEffect(() => {\r\n        loadLetterheads();\r\n    }, [loadLetterheads]);\r\n\r\n\r\n\r\n    const handleDelete = async (id) => {\r\n        if (!window.confirm('Delete this letterhead document? This cannot be undone.')) return;\r\n        try {\r\n            await api.delete(`/letterheads/${id}`);\r\n            toast.success('Deleted successfully');\r\n            loadLetterheads();\r\n        } catch (error) {\r\n            toast.error('Failed to delete');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Layout>\r\n            <div className=\"p-6 md:p-8 min-h-screen bg-gray-50/50 dark:bg-[#050505] transition-colors duration-500\">\r\n                {/* Header Section */}\r\n                <div className=\"mb-10 relative\">\r\n                    <div className=\"absolute -top-24 -left-24 w-96 h-96 bg-amber-500/10 blur-[120px] rounded-full pointer-events-none\"></div>\r\n                    <div className=\"flex flex-col md:flex-row md:items-end justify-between gap-6 relative z-10\">\r\n                        <div>\r\n                            <div className=\"flex items-center space-x-3 mb-2\">\r\n                                <div className=\"p-2 bg-amber-500/10 rounded-lg\">\r\n                                    <FileText className=\"w-5 h-5 text-amber-500\" />\r\n                                </div>\r\n                                <span className=\"text-amber-600 dark:text-amber-400 text-xs font-black uppercase tracking-[0.3em]\">Official Docs</span>\r\n                            </div>\r\n                            <h1 className=\"text-4xl md:text-5xl font-black text-gray-900 dark:text-white tracking-tight\">\r\n                                <span className=\"text-transparent bg-clip-text bg-gradient-to-r from-amber-600 to-yellow-500\">Letterheads</span>\r\n                            </h1>\r\n                            <p className=\"text-gray-500 dark:text-gray-400 mt-2 font-medium max-w-md\">\r\n                                Manage your official correspondence and templates\r\n                            </p>\r\n                        </div>\r\n                        <button\r\n                            onClick={() => navigate('/letterheads/create')}\r\n                            className=\"flex items-center space-x-2 px-8 py-4 bg-amber-600 hover:bg-amber-500 text-white rounded-2xl shadow-[0_20px_40px_rgba(217,119,6,0.2)] hover:shadow-[0_25px_50px_rgba(217,119,6,0.3)] transition-all duration-300 transform hover:-translate-y-1 group\"\r\n                        >\r\n                            <Plus className=\"w-6 h-6 group-hover:rotate-90 transition-transform duration-500\" />\r\n                            <span className=\"font-black tracking-tight text-lg\">Create New</span>\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* High-Fidelity Search Hub */}\r\n                <div className=\"bg-white/80 dark:bg-white/5 backdrop-blur-xl p-6 border-[2.5px] border-amber-500/30 shadow-[0_4px_20px_-8px_rgba(245,158,11,0.3)] mb-8 relative z-10 transition-all duration-300 rounded-[24px]\">\r\n                    <div className=\"relative group\">\r\n                        <Search className=\"absolute left-6 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 group-focus-within:text-amber-500 transition-colors\" />\r\n                        <input\r\n                            type=\"text\"\r\n                            placeholder=\"Universal Search Letterheads...\"\r\n                            value={searchTerm}\r\n                            onChange={(e) => setSearchTerm(e.target.value)}\r\n                            className=\"w-full pl-14 pr-6 py-4 border border-transparent bg-gray-50/50 dark:bg-white/5 rounded-[22px] text-sm font-bold focus:ring-2 focus:ring-amber-500/20 focus:bg-white dark:focus:bg-black transition-all placeholder-gray-400 text-gray-900 dark:text-white\"\r\n                        />\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Table */}\r\n                <div className=\"bg-white/80 dark:bg-white/5 backdrop-blur-xl border-[2.5px] border-amber-500/30 shadow-2xl mb-8 relative z-10 transition-all duration-300 rounded-[32px] overflow-hidden\">\r\n                    {loading ? (\r\n                        <div className=\"p-20 text-center\">\r\n                            <div className=\"relative inline-block\">\r\n                                <div className=\"w-12 h-12 border-t-2 border-amber-500 rounded-full animate-spin mx-auto\"></div>\r\n                            </div>\r\n                            <p className=\"mt-4 text-amber-600 dark:text-amber-400 font-bold tracking-widest uppercase text-xs animate-pulse font-mono\">Loading Docs...</p>\r\n                        </div>\r\n                    ) : letterheads.length === 0 ? (\r\n                        <div className=\"text-center py-20\">\r\n                            <div className=\"bg-amber-500/10 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6\">\r\n                                <FileText className=\"w-10 h-10 text-amber-500/50\" />\r\n                            </div>\r\n                            <h3 className=\"text-xl font-bold text-gray-900 dark:text-white\">No Letterheads Found</h3>\r\n                            <p className=\"text-gray-500 dark:text-gray-400 mt-2\">Create your first official document to get started.</p>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"overflow-x-auto\">\r\n                            <table className=\"w-full\">\r\n                                <thead className=\"bg-amber-50/50 dark:bg-amber-900/10 border-b-[2.5px] border-black dark:border-white/90\">\r\n                                    <tr>\r\n                                        <th className=\"px-8 py-5 text-left text-xs font-black text-amber-600 dark:text-amber-500 uppercase tracking-widest\">Number</th>\r\n                                        <th className=\"px-8 py-5 text-left text-xs font-black text-amber-600 dark:text-amber-500 uppercase tracking-widest\">Date</th>\r\n                                        <th className=\"px-8 py-5 text-left text-xs font-black text-amber-600 dark:text-amber-500 uppercase tracking-widest\">Recipient</th>\r\n                                        <th className=\"px-8 py-5 text-left text-xs font-black text-amber-600 dark:text-amber-500 uppercase tracking-widest\">Subject</th>\r\n                                        <th className=\"px-8 py-5 text-left text-xs font-black text-amber-600 dark:text-amber-500 uppercase tracking-widest\">Actions</th>\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody className=\"divide-y divide-gray-100 dark:divide-gray-800\">\r\n                                    {letterheads.map((doc) => (\r\n                                        <tr key={doc._id} className=\"hover:bg-amber-50/30 dark:hover:bg-amber-900/5 transition duration-300 group\">\r\n                                            <td className=\"px-8 py-6 font-bold text-gray-900 dark:text-white group-hover:text-amber-600 dark:group-hover:text-amber-400 transition-colors\">\r\n                                                {doc.letterheadNo}\r\n                                            </td>\r\n                                            <td className=\"px-8 py-6 text-gray-500 dark:text-gray-400 font-medium\">{formatDate(doc.date)}</td>\r\n                                            <td className=\"px-8 py-6\">\r\n                                                <span className=\"font-bold text-gray-900 dark:text-white bg-gray-100 dark:bg-white/10 px-3 py-1 rounded-full text-xs\">\r\n                                                    {doc.recipient?.name || 'Unknown'}\r\n                                                </span>\r\n                                            </td>\r\n                                            <td className=\"px-8 py-6 text-gray-600 dark:text-gray-300 truncate max-w-xs font-medium\">{doc.subject}</td>\r\n                                            <td className=\"px-8 py-6 flex items-center space-x-2\">\r\n                                                <button\r\n                                                    onClick={() => navigate(`/letterheads/edit/${doc._id}`)}\r\n                                                    className=\"p-2 text-gray-400 hover:text-amber-600 dark:hover:text-amber-400 hover:bg-amber-100 dark:hover:bg-amber-900/30 rounded-lg transition-all\"\r\n                                                    title=\"Edit\"\r\n                                                >\r\n                                                    <Edit className=\"w-4 h-4\" />\r\n                                                </button>\r\n                                                <button\r\n                                                    onClick={() => navigate(`/letterheads/view/${doc._id}`)}\r\n                                                    className=\"p-2 text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded-lg transition-all\"\r\n                                                    title=\"Print\"\r\n                                                >\r\n                                                    <Printer className=\"w-4 h-4\" />\r\n                                                </button>\r\n                                                <button\r\n                                                    onClick={() => handleDelete(doc._id)}\r\n                                                    className=\"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg transition-all\"\r\n                                                    title=\"Delete\"\r\n                                                >\r\n                                                    <Trash2 className=\"w-4 h-4\" />\r\n                                                </button>\r\n                                            </td>\r\n                                        </tr>\r\n                                    ))}\r\n                                </tbody>\r\n                            </table>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </Layout>\r\n    );\r\n};\r\n\r\nexport default LetterheadList;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\pages\\Login.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\pages\\PurchaseEntry.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'useParams' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":32,"suggestions":[{"messageId":"removeVar","data":{"varName":"useParams"},"fix":{"range":[88,99],"text":""},"desc":"Remove unused variable 'useParams'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'useAuth' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"useAuth"},"fix":{"range":[229,278],"text":""},"desc":"Remove unused variable 'useAuth'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'isSearching' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":27,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"isSearching"},"fix":{"range":[1173,1184],"text":""},"desc":"Remove unused variable 'isSearching'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback received a function whose dependencies are unknown. Pass an inline function instead.","line":47,"column":28,"nodeType":"Identifier","endLine":47,"endColumn":39}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState, useEffect, useCallback } from 'react';\r\nimport { useNavigate, useParams, useSearchParams } from 'react-router-dom';\r\nimport Layout from '../components/Layout/Layout';\r\nimport api from '../utils/api';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport { ArrowLeft, Plus, Trash2, Save, Calendar, Search } from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\nimport { formatINR } from '../utils/currency';\r\nimport { debounce } from '../utils/debounce';\r\n\r\nconst PurchaseEntry = () => {\r\n    const navigate = useNavigate();\r\n    const [searchParams] = useSearchParams();\r\n    const supplierIdParam = searchParams.get('supplierId');\r\n\r\n    const [suppliers, setSuppliers] = useState([]);\r\n    const [selectedSupplier, setSelectedSupplier] = useState('');\r\n    const [billNo, setBillNo] = useState('');\r\n    const [billDate, setBillDate] = useState(new Date().toISOString().split('T')[0]);\r\n    const [notes, setNotes] = useState('');\r\n\r\n    // Items State\r\n    const [items, setItems] = useState([]);\r\n    const [productSearch, setProductSearch] = useState('');\r\n    const [searchResults, setSearchResults] = useState([]);\r\n    const [isSearching, setIsSearching] = useState(false);\r\n\r\n    // Current editing item (for search selection)\r\n    const [currentItemIndex, setCurrentItemIndex] = useState(null);\r\n\r\n    // Load Suppliers\r\n    useEffect(() => {\r\n        const fetchSuppliers = async () => {\r\n            try {\r\n                const { data } = await api.get('/suppliers');\r\n                setSuppliers(data);\r\n                if (supplierIdParam) setSelectedSupplier(supplierIdParam);\r\n            } catch (error) {\r\n                console.error('Failed to load suppliers', error);\r\n            }\r\n        };\r\n        fetchSuppliers();\r\n    }, [supplierIdParam]);\r\n\r\n    // Product Search\r\n    const searchProducts = useCallback(\r\n        debounce(async (query) => {\r\n            if (!query) {\r\n                setSearchResults([]);\r\n                return;\r\n            }\r\n            setIsSearching(true);\r\n            try {\r\n                const { data } = await api.get(`/products?search=${encodeURIComponent(query)}&limit=10`);\r\n                setSearchResults(data.products || []);\r\n            } catch (error) {\r\n                console.error(error);\r\n            } finally {\r\n                setIsSearching(false);\r\n            }\r\n        }, 500),\r\n        []\r\n    );\r\n\r\n    useEffect(() => {\r\n        searchProducts(productSearch);\r\n    }, [productSearch, searchProducts]);\r\n\r\n    const addItem = () => {\r\n        setItems([...items, {\r\n            productId: '',\r\n            productName: '',\r\n            isBatchTracked: false,\r\n            batchNumber: '',\r\n            expiryDate: '',\r\n            quantity: 1,\r\n            costPrice: 0,\r\n            sellingPrice: 0,\r\n            mrp: 0,\r\n            total: 0\r\n        }]);\r\n    };\r\n\r\n    const removeItem = (index) => {\r\n        const newItems = items.filter((_, i) => i !== index);\r\n        setItems(newItems);\r\n    };\r\n\r\n    const updateItem = (index, field, value) => {\r\n        const newItems = [...items];\r\n        const item = { ...newItems[index], [field]: value };\r\n\r\n        // Recalculate total if qty or cost changes\r\n        if (field === 'quantity' || field === 'costPrice') {\r\n            item.total = (parseFloat(item.quantity) || 0) * (parseFloat(item.costPrice) || 0);\r\n        }\r\n\r\n        newItems[index] = item;\r\n        setItems(newItems);\r\n    };\r\n\r\n    const handleProductSelect = (product, index) => {\r\n        const newItems = [...items];\r\n        newItems[index] = {\r\n            ...newItems[index],\r\n            productId: product._id,\r\n            productName: product.name,\r\n            isBatchTracked: product.isBatchTracked,\r\n            costPrice: product.costPrice || 0,\r\n            sellingPrice: product.sellingPrice || 0,\r\n            mrp: product.mrp || 0,\r\n            // Reset batch info if product changes\r\n            batchNumber: '',\r\n            expiryDate: ''\r\n        };\r\n        setItems(newItems);\r\n        setProductSearch('');\r\n        setSearchResults([]);\r\n        setCurrentItemIndex(null);\r\n    };\r\n\r\n    const calculateGrandTotal = () => {\r\n        return items.reduce((sum, item) => sum + (item.total || 0), 0);\r\n    };\r\n\r\n    const handleSubmit = async () => {\r\n        if (!selectedSupplier) return toast.error('Select a Supplier');\r\n        if (items.length === 0) return toast.error('Add at least one item');\r\n\r\n        // Validate Batches\r\n        for (const item of items) {\r\n            if (item.isBatchTracked && (!item.batchNumber || !item.expiryDate)) {\r\n                return toast.error(`Batch & Expiry required for ${item.productName}`);\r\n            }\r\n        }\r\n\r\n        try {\r\n            const payload = {\r\n                supplierId: selectedSupplier,\r\n                billNo,\r\n                billDate,\r\n                items,\r\n                totalAmount: calculateGrandTotal(),\r\n                notes\r\n            };\r\n\r\n            await api.post('/purchases', payload);\r\n            toast.success('Purchase Recorded Successfully');\r\n            navigate('/suppliers/' + selectedSupplier);\r\n        } catch (error) {\r\n            toast.error(error.response?.data?.message || 'Failed to record purchase');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Layout>\r\n            <div className=\"p-6 max-w-7xl mx-auto\">\r\n                <div className=\"flex items-center justify-between mb-8\">\r\n                    <div className=\"flex items-center gap-4\">\r\n                        <button onClick={() => navigate(-1)} className=\"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg\">\r\n                            <ArrowLeft className=\"w-6 h-6 dark:text-gray-200\" />\r\n                        </button>\r\n                        <div>\r\n                            <h1 className=\"text-3xl font-bold dark:text-white\">New Stock Inward</h1>\r\n                            <p className=\"text-gray-500 text-sm\">Record items, batches, and prices</p>\r\n                        </div>\r\n                    </div>\r\n                    <button\r\n                        onClick={handleSubmit}\r\n                        className=\"px-6 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-bold flex items-center gap-2 shadow-lg hover:shadow-emerald-500/20 transition-all\"\r\n                    >\r\n                        <Save className=\"w-5 h-5\" />\r\n                        Save Purchase\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Header Inputs */}\r\n                <div className=\"bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 mb-6 grid grid-cols-1 md:grid-cols-4 gap-6\">\r\n                    <div className=\"md:col-span-1\">\r\n                        <label className=\"block text-sm font-semibold mb-2 dark:text-gray-300\">Supplier</label>\r\n                        <select\r\n                            value={selectedSupplier}\r\n                            onChange={(e) => setSelectedSupplier(e.target.value)}\r\n                            className=\"w-full p-3 rounded-lg border dark:bg-gray-700 dark:border-gray-600 dark:text-white outline-none focus:ring-2 focus:ring-emerald-500\"\r\n                        >\r\n                            <option value=\"\">Select Supplier</option>\r\n                            {suppliers.map(s => (\r\n                                <option key={s._id} value={s._id}>{s.name}</option>\r\n                            ))}\r\n                        </select>\r\n                    </div>\r\n                    <div>\r\n                        <label className=\"block text-sm font-semibold mb-2 dark:text-gray-300\">Bill No</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={billNo}\r\n                            onChange={(e) => setBillNo(e.target.value)}\r\n                            className=\"w-full p-3 rounded-lg border dark:bg-gray-700 dark:border-gray-600 dark:text-white outline-none focus:ring-2 focus:ring-emerald-500\"\r\n                            placeholder=\"e.g. INV-001\"\r\n                        />\r\n                    </div>\r\n                    <div>\r\n                        <label className=\"block text-sm font-semibold mb-2 dark:text-gray-300\">Bill Date</label>\r\n                        <input\r\n                            type=\"date\"\r\n                            value={billDate}\r\n                            onChange={(e) => setBillDate(e.target.value)}\r\n                            className=\"w-full p-3 rounded-lg border dark:bg-gray-700 dark:border-gray-600 dark:text-white outline-none focus:ring-2 focus:ring-emerald-500\"\r\n                        />\r\n                    </div>\r\n                    <div>\r\n                        <label className=\"block text-sm font-semibold mb-2 dark:text-gray-300\">Notes</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={notes}\r\n                            onChange={(e) => setNotes(e.target.value)}\r\n                            className=\"w-full p-3 rounded-lg border dark:bg-gray-700 dark:border-gray-600 dark:text-white outline-none focus:ring-2 focus:ring-emerald-500\"\r\n                            placeholder=\"Optional remarks\"\r\n                        />\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Items Table */}\r\n                <div className=\"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden\">\r\n                    <table className=\"w-full text-left\">\r\n                        <thead className=\"bg-gray-50 dark:bg-gray-700/50 text-gray-500 dark:text-gray-400 text-xs uppercase font-bold\">\r\n                            <tr>\r\n                                <th className=\"p-4 w-1/4\">Product</th>\r\n                                <th className=\"p-4\">Batch Info</th>\r\n                                <th className=\"p-4 w-24\">Qty</th>\r\n                                <th className=\"p-4 w-24\">Cost</th>\r\n                                <th className=\"p-4 w-24\">Selling</th>\r\n                                <th className=\"p-4 w-24\">Total</th>\r\n                                <th className=\"p-4 w-12\"></th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody className=\"divide-y divide-gray-100 dark:divide-gray-700\">\r\n                            {items.map((item, index) => (\r\n                                <tr key={index} className=\"hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors\">\r\n                                    <td className=\"p-4 relative\">\r\n                                        {/* Product Search Input */}\r\n                                        <div className=\"relative\">\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                value={item.productId ? item.productName : (currentItemIndex === index ? productSearch : '')}\r\n                                                onFocus={() => {\r\n                                                    setCurrentItemIndex(index);\r\n                                                    setProductSearch('');\r\n                                                }}\r\n                                                onChange={(e) => {\r\n                                                    setProductSearch(e.target.value);\r\n                                                    if (item.productId) updateItem(index, 'productId', ''); // Clear selection on edit\r\n                                                }}\r\n                                                className=\"w-full p-2 rounded border dark:bg-gray-700 dark:border-gray-600 dark:text-white outline-none focus:border-emerald-500\"\r\n                                                placeholder=\"Search Product...\"\r\n                                            />\r\n                                            {item.isBatchTracked && (\r\n                                                <span className=\"text-[10px] text-emerald-600 font-bold bg-emerald-50 px-1 rounded absolute right-2 top-2.5\">BATCH</span>\r\n                                            )}\r\n\r\n                                            {/* Dropdown Results */}\r\n                                            {currentItemIndex === index && searchResults.length > 0 && (\r\n                                                <div className=\"absolute z-50 top-full left-0 w-full bg-white dark:bg-gray-800 shadow-xl rounded-lg border mt-1 max-h-48 overflow-y-auto\">\r\n                                                    {searchResults.map(p => (\r\n                                                        <div\r\n                                                            key={p._id}\r\n                                                            onClick={() => handleProductSelect(p, index)}\r\n                                                            className=\"p-3 hover:bg-emerald-50 dark:hover:bg-emerald-900/20 cursor-pointer border-b last:border-0 dark:border-gray-700\"\r\n                                                        >\r\n                                                            <div className=\"font-bold dark:text-white\">{p.name}</div>\r\n                                                            <div className=\"text-xs text-gray-500\">Stock: {p.stock} | SKU: {p.sku}</div>\r\n                                                        </div>\r\n                                                    ))}\r\n                                                </div>\r\n                                            )}\r\n                                        </div>\r\n                                    </td>\r\n                                    <td className=\"p-4\">\r\n                                        {item.isBatchTracked ? (\r\n                                            <div className=\"flex flex-col gap-2\">\r\n                                                <input\r\n                                                    type=\"text\"\r\n                                                    value={item.batchNumber}\r\n                                                    onChange={(e) => updateItem(index, 'batchNumber', e.target.value)}\r\n                                                    placeholder=\"Batch No\"\r\n                                                    className=\"w-full p-2 text-sm rounded border dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n                                                />\r\n                                                <input\r\n                                                    type=\"date\"\r\n                                                    value={item.expiryDate ? item.expiryDate.split('T')[0] : ''}\r\n                                                    onChange={(e) => updateItem(index, 'expiryDate', e.target.value)}\r\n                                                    className=\"w-full p-2 text-sm rounded border dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n                                                />\r\n                                            </div>\r\n                                        ) : (\r\n                                            <span className=\"text-gray-400 text-sm\">-</span>\r\n                                        )}\r\n                                    </td>\r\n                                    <td className=\"p-4\">\r\n                                        <input\r\n                                            type=\"number\"\r\n                                            value={item.quantity}\r\n                                            onChange={(e) => updateItem(index, 'quantity', e.target.value)}\r\n                                            className=\"w-20 p-2 text-right rounded border dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n                                            min=\"1\"\r\n                                        />\r\n                                    </td>\r\n                                    <td className=\"p-4\">\r\n                                        <input\r\n                                            type=\"number\"\r\n                                            value={item.costPrice}\r\n                                            onChange={(e) => updateItem(index, 'costPrice', e.target.value)}\r\n                                            className=\"w-24 p-2 text-right rounded border dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n                                            min=\"0\"\r\n                                            step=\"0.01\"\r\n                                        />\r\n                                    </td>\r\n                                    <td className=\"p-4\">\r\n                                        <input\r\n                                            type=\"number\"\r\n                                            value={item.sellingPrice}\r\n                                            onChange={(e) => updateItem(index, 'sellingPrice', e.target.value)}\r\n                                            className=\"w-24 p-2 text-right rounded border dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n                                            min=\"0\"\r\n                                            step=\"0.01\"\r\n                                        />\r\n                                    </td>\r\n                                    <td className=\"p-4 font-bold text-right dark:text-white\">\r\n                                        {formatINR(item.total)}\r\n                                    </td>\r\n                                    <td className=\"p-4 text-center\">\r\n                                        <button onClick={() => removeItem(index)} className=\"text-gray-400 hover:text-red-500 transition-colors\">\r\n                                            <Trash2 className=\"w-5 h-5\" />\r\n                                        </button>\r\n                                    </td>\r\n                                </tr>\r\n                            ))}\r\n                        </tbody>\r\n                        <tfoot className=\"bg-gray-50 dark:bg-gray-800 border-t dark:border-gray-700\">\r\n                            <tr>\r\n                                <td colSpan=\"7\" className=\"p-4\">\r\n                                    <button\r\n                                        onClick={addItem}\r\n                                        className=\"flex items-center gap-2 text-emerald-600 font-bold hover:text-emerald-700\"\r\n                                    >\r\n                                        <Plus className=\"w-5 h-5\" />\r\n                                        Add Item\r\n                                    </button>\r\n                                </td>\r\n                            </tr>\r\n                        </tfoot>\r\n                    </table>\r\n                </div>\r\n\r\n                <div className=\"flex justify-end mt-8\">\r\n                    <div className=\"text-right p-6 bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 w-full md:w-1/3\">\r\n                        <p className=\"text-gray-500 text-sm uppercase font-bold tracking-widest mb-1\">Grand Total</p>\r\n                        <p className=\"text-4xl font-black text-gray-900 dark:text-white\">{formatINR(calculateGrandTotal())}</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </Layout>\r\n    );\r\n};\r\n\r\nexport default PurchaseEntry;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\pages\\Register.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\pages\\Settings.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\pages\\SupplierLedger.jsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`loadData` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\n  38 |\n  39 |     useEffect(() => {\n> 40 |         loadData();\n     |         ^^^^^^^^ `loadData` accessed before it is declared\n  41 |     }, [id, isPublic]);\n  42 |\n  43 |     const loadData = async () => {\n\n  41 |     }, [id, isPublic]);\n  42 |\n> 43 |     const loadData = async () => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 44 |         try {\n     | ^^^^^^^^^^^^^\n> 45 |             setLoading(true);\n     \n     | ^^^^^^^^^^^^^\n> 63 |         }\n     | ^^^^^^^^^^^^^\n> 64 |     };\n     | ^^^^^^^ `loadData` is declared here\n  65 |\n  66 |     const handleRecalculate = async () => {\n  67 |         try {","line":40,"column":9,"nodeType":null,"endLine":40,"endColumn":17},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadData'. Either include it or remove the dependency array.","line":41,"column":8,"nodeType":"ArrayExpression","endLine":41,"endColumn":22,"suggestions":[{"desc":"Update the dependencies array to be: [id, isPublic, loadData]","fix":{"range":[1702,1716],"text":"[id, isPublic, loadData]"}}]},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":71,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":71,"endColumn":23},{"ruleId":"no-undef","severity":2,"message":"'settings' is not defined.","line":199,"column":32,"nodeType":"Identifier","messageId":"undef","endLine":199,"endColumn":40}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport Layout from '../components/Layout/Layout';\r\nimport api from '../utils/api';\r\nimport { formatINR } from '../utils/currency';\r\nimport { formatDate } from '../utils/date';\r\nimport { ArrowLeft, RefreshCw, Printer, Plus, X, Edit2, Paperclip, Trash2, Share2, Mail, MessageCircle, Download } from 'lucide-react';\r\nimport ConfirmationModal from '../components/ConfirmationModal';\r\nimport toast from 'react-hot-toast';\r\nimport { sharePdf } from '../utils/pdfShare';\r\n\r\nconst SupplierLedger = ({ isPublic = false }) => {\r\n    const { id } = useParams();\r\n    const navigate = useNavigate();\r\n    const [supplier, setSupplier] = useState(null);\r\n    const [ledger, setLedger] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [showPaymentModal, setShowPaymentModal] = useState(false);\r\n    const [showPurchaseModal, setShowPurchaseModal] = useState(false);\r\n    const [payment, setPayment] = useState({\r\n        amount: '',\r\n        method: 'Cash',\r\n        date: new Date().toISOString().split('T')[0],\r\n        notes: '',\r\n        billFile: null\r\n    });\r\n    const [purchase, setPurchase] = useState({\r\n        amount: '',\r\n        billNo: '',\r\n        date: new Date().toISOString().split('T')[0],\r\n        notes: '',\r\n        billFile: null\r\n    });\r\n    const [showEditModal, setShowEditModal] = useState(false);\r\n    const [editingEntry, setEditingEntry] = useState(null);\r\n    const [showDeleteModal, setShowDeleteModal] = useState(false);\r\n    const [entryToDelete, setEntryToDelete] = useState(null);\r\n\r\n    useEffect(() => {\r\n        loadData();\r\n    }, [id, isPublic]);\r\n\r\n    const loadData = async () => {\r\n        try {\r\n            setLoading(true);\r\n            if (isPublic) {\r\n                const res = await api.get(`/public/suppliers/${id}/ledger`);\r\n                setSupplier(res.data.supplier);\r\n                setLedger(res.data.ledger);\r\n            } else {\r\n                const [supplierRes, ledgerRes] = await Promise.all([\r\n                    api.get(`/suppliers/${id}`),\r\n                    api.get(`/supplier-ledger/${id}`)\r\n                ]);\r\n                setSupplier(supplierRes.data);\r\n                setLedger(ledgerRes.data);\r\n            }\r\n            setLoading(false);\r\n        } catch (error) {\r\n            console.error('Error loading supplier ledger:', error);\r\n            if (!isPublic) toast.error('Failed to load supplier ledger');\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleRecalculate = async () => {\r\n        try {\r\n            await api.post(`/supplier-ledger/recalculate/${id}`);\r\n            toast.success('Ledger recalculated');\r\n            loadData();\r\n        } catch (error) {\r\n            toast.error('Recalculation failed');\r\n        }\r\n    };\r\n\r\n    const handleRecordPayment = async () => {\r\n        if (!payment.amount || payment.amount <= 0) {\r\n            return toast.error('Please enter a valid amount');\r\n        }\r\n\r\n        try {\r\n            const formData = new FormData();\r\n            formData.append('supplierId', id);\r\n            formData.append('amount', parseFloat(payment.amount));\r\n            formData.append('method', payment.method);\r\n            formData.append('date', payment.date);\r\n            formData.append('notes', payment.notes || 'Payment to supplier');\r\n            if (payment.billFile) {\r\n                formData.append('billFile', payment.billFile);\r\n            }\r\n\r\n            await api.post('/payments/supplier', formData);\r\n\r\n            toast.success('Payment recorded successfully');\r\n            setShowPaymentModal(false);\r\n            setPayment({ amount: '', method: 'Cash', date: new Date().toISOString().split('T')[0], notes: '', billFile: null });\r\n            loadData();\r\n        } catch (error) {\r\n            console.error('Payment error:', error);\r\n            toast.error(error.response?.data?.message || 'Failed to record payment');\r\n        }\r\n    };\r\n\r\n    const handleRecordPurchase = async () => {\r\n        if (!purchase.amount || purchase.amount <= 0) {\r\n            return toast.error('Please enter a valid amount');\r\n        }\r\n\r\n        try {\r\n            const formData = new FormData();\r\n            formData.append('supplierId', id);\r\n            formData.append('amount', parseFloat(purchase.amount));\r\n            formData.append('billNo', purchase.billNo || '');\r\n            formData.append('date', purchase.date);\r\n            formData.append('notes', purchase.notes || 'Purchase recorded');\r\n            if (purchase.billFile) {\r\n                formData.append('billFile', purchase.billFile);\r\n            }\r\n\r\n            await api.post('/supplier-ledger/record-purchase', formData);\r\n\r\n            toast.success('Purchase recorded successfully');\r\n            setShowPurchaseModal(false);\r\n            setPurchase({ amount: '', billNo: '', date: new Date().toISOString().split('T')[0], notes: '', billFile: null });\r\n            loadData();\r\n        } catch (error) {\r\n            console.error('Purchase error:', error);\r\n            toast.error(error.response?.data?.message || 'Failed to record purchase');\r\n        }\r\n    };\r\n\r\n    const handleEditClick = (entry) => {\r\n        setEditingEntry({ ...entry, deleteAttachment: false });\r\n        setShowEditModal(true);\r\n    };\r\n\r\n    const handleUpdateEntry = async (e) => {\r\n        e.preventDefault();\r\n        try {\r\n            const formData = new FormData();\r\n            formData.append('date', editingEntry.date);\r\n            formData.append('description', editingEntry.description);\r\n            formData.append('refNo', editingEntry.refNo || '');\r\n            formData.append('debit', editingEntry.debit || 0);\r\n            formData.append('credit', editingEntry.credit || 0);\r\n            if (editingEntry.billFile) {\r\n                formData.append('billFile', editingEntry.billFile);\r\n            }\r\n            if (editingEntry.deleteAttachment) {\r\n                formData.append('deleteAttachment', 'true');\r\n            }\r\n\r\n            await api.put(`/supplier-ledger/${editingEntry._id}`, formData);\r\n            toast.success('Entry updated successfully');\r\n            setShowEditModal(false);\r\n            setEditingEntry(null);\r\n            loadData();\r\n        } catch (error) {\r\n            console.error('Update error:', error);\r\n            toast.error('Failed to update entry');\r\n        }\r\n    };\r\n\r\n\r\n\r\n    const handleDeleteClick = (entry) => {\r\n        setEntryToDelete(entry);\r\n        setShowDeleteModal(true);\r\n    };\r\n\r\n    const confirmDelete = async () => {\r\n        if (!entryToDelete) return;\r\n\r\n        try {\r\n            await api.delete(`/supplier-ledger/${entryToDelete._id}`);\r\n            toast.success('Entry deleted successfully');\r\n            setShowDeleteModal(false);\r\n            setEntryToDelete(null);\r\n            loadData();\r\n        } catch (error) {\r\n            console.error('Delete error:', error);\r\n            toast.error('Failed to delete entry');\r\n        }\r\n    };\r\n\r\n    const handleShare = async () => {\r\n        const fileName = `Supplier_Ledger_${supplier?.name || 'Report'}.pdf`;\r\n        const title = `Ledger Statement - ${supplier?.name}`;\r\n        const text = `Please find attached the ledger statement for ${supplier?.name}.`;\r\n\r\n        await sharePdf('ledger-content', fileName, title, text);\r\n    };\r\n\r\n    const handleWhatsAppShare = () => {\r\n        const shareUrl = `${window.location.origin}/share/supplier/${id}/ledger`;\r\n        const text = `Here is the ledger statement for ${supplier?.name || 'Supplier'}: ${shareUrl}`;\r\n\r\n        // Use whatsappNumber from settings if available, otherwise open WhatsApp without recipient\r\n        const whatsappNumber = settings?.whatsappNumber || '';\r\n        const waLink = whatsappNumber\r\n            ? `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(text)}`\r\n            : `https://wa.me/?text=${encodeURIComponent(text)}`;\r\n\r\n        window.open(waLink, '_blank');\r\n    };\r\n\r\n    return (\r\n        <Layout>\r\n            <div className=\"p-6\">\r\n                {/* Header */}\r\n                <div className=\"flex items-center justify-between mb-6\">\r\n                    <div className=\"flex items-center space-x-4\">\r\n                        {!isPublic && (\r\n                            <button\r\n                                onClick={() => navigate('/suppliers')}\r\n                                className=\"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors\"\r\n                            >\r\n                                <ArrowLeft className=\"w-6 h-6 text-gray-600 dark:text-gray-400\" />\r\n                            </button>\r\n                        )}\r\n                        <div>\r\n                            <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\r\n                                {loading ? 'Loading...' : `${supplier?.name} - Purchase Ledger`}\r\n                            </h1>\r\n                            <p className=\"text-gray-600 dark:text-gray-400\">\r\n                                {supplier?.phone} | {supplier?.address}\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center space-x-3\">\r\n                        {isPublic ? (\r\n                            <>\r\n                                <button\r\n                                    onClick={handleShare}\r\n                                    className=\"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\r\n                                >\r\n                                    <Download className=\"w-4 h-4\" />\r\n                                    <span>Download PDF</span>\r\n                                </button>\r\n                                <button\r\n                                    onClick={handleWhatsAppShare}\r\n                                    className=\"flex items-center space-x-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors\"\r\n                                >\r\n                                    <MessageCircle className=\"w-4 h-4\" />\r\n                                    <span>WhatsApp</span>\r\n                                </button>\r\n                            </>\r\n                        ) : (\r\n                            <>\r\n                                <button\r\n                                    onClick={handleShare}\r\n                                    className=\"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\r\n                                    title=\"Download as PDF\"\r\n                                >\r\n                                    <Download className=\"w-4 h-4\" />\r\n                                    <span>Download PDF</span>\r\n                                </button>\r\n                                <button\r\n                                    onClick={handleWhatsAppShare}\r\n                                    className=\"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors border border-green-200\"\r\n                                    title=\"Share on WhatsApp\"\r\n                                >\r\n                                    <MessageCircle className=\"w-5 h-5\" />\r\n                                </button>\r\n                                <button\r\n                                    onClick={() => setShowPurchaseModal(true)}\r\n                                    className=\"flex items-center space-x-2 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors\"\r\n                                >\r\n                                    <Plus className=\"w-4 h-4\" />\r\n                                    <span>Record Purchase (Quick)</span>\r\n                                </button>\r\n                                <button\r\n                                    onClick={() => navigate(`/purchase-entry?supplierId=${id}`)}\r\n                                    className=\"flex items-center space-x-2 px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors\"\r\n                                >\r\n                                    <Plus className=\"w-4 h-4\" />\r\n                                    <span>Stock Inward</span>\r\n                                </button>\r\n                                <button\r\n                                    onClick={() => setShowPaymentModal(true)}\r\n                                    className=\"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors\"\r\n                                >\r\n                                    <Plus className=\"w-4 h-4\" />\r\n                                    <span>Record Payment</span>\r\n                                </button>\r\n                                <button\r\n                                    onClick={handleRecalculate}\r\n                                    className=\"flex items-center space-x-2 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 transition-colors\"\r\n                                >\r\n                                    <RefreshCw className=\"w-4 h-4\" />\r\n                                    <span>Recalculate</span>\r\n                                </button>\r\n                            </>\r\n                        )}\r\n                        <button className=\"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\">\r\n                            <Printer className=\"w-4 h-4\" />\r\n                            <span>Print</span>\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n\r\n            {/* Gold Standard Ledger Content */}\r\n            <div id=\"ledger-content\" className=\"bg-white/80 dark:bg-black/40 backdrop-blur-xl p-4 rounded-[32px] border-[2.5px] border-amber-500/30 shadow-2xl transition-all duration-300\">\r\n                {/* Summary Cards */}\r\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\r\n                    <div className=\"bg-white/50 dark:bg-black/20 p-6 rounded-[24px] border border-red-500/20 box-shadow-sm hover:border-red-500/40 transition-all\">\r\n                        <p className=\"text-[10px] uppercase tracking-widest font-black text-gray-500 dark:text-gray-400 mb-2\">Total Credit (Purchases)</p>\r\n                        <p className=\"text-3xl font-black text-red-600 dark:text-red-400 rupee\">\r\n                            {formatINR(ledger.reduce((sum, entry) => sum + (entry.credit || 0), 0))}\r\n                        </p>\r\n                    </div>\r\n                    <div className=\"bg-white/50 dark:bg-black/20 p-6 rounded-[24px] border border-green-500/20 box-shadow-sm hover:border-green-500/40 transition-all\">\r\n                        <p className=\"text-[10px] uppercase tracking-widest font-black text-gray-500 dark:text-gray-400 mb-2\">Total Debit (Paid)</p>\r\n                        <p className=\"text-3xl font-black text-green-600 dark:text-green-400 rupee\">\r\n                            {formatINR(ledger.reduce((sum, entry) => sum + (entry.debit || 0), 0))}\r\n                        </p>\r\n                    </div>\r\n                    <div className=\"bg-amber-500/10 dark:bg-amber-500/5 p-6 rounded-[24px] border border-amber-500/30 box-shadow-lg shadow-amber-500/10\">\r\n                        <p className=\"text-[10px] uppercase tracking-widest font-black text-amber-800 dark:text-amber-400 mb-2\">Net Amount Owed</p>\r\n                        <p className=\"text-4xl font-black text-amber-700 dark:text-amber-500 rupee tracking-tight\">\r\n                            {formatINR(supplier?.balance || 0)}\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Ledger Table */}\r\n                <div className=\"bg-white/50 dark:bg-black/20 rounded-[24px] overflow-hidden border border-gray-100 dark:border-white/5 transition-colors\">\r\n                    <div className=\"overflow-x-auto\">\r\n                        <table className=\"w-full\">\r\n                            <thead>\r\n                                <tr className=\"bg-gray-50 dark:bg-gray-700/50 border-b-[2.5px] border-black dark:border-white/90\">\r\n                                    <th className=\"px-6 py-4 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider\">Date</th>\r\n                                    <th className=\"px-6 py-4 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider\">Particulars</th>\r\n                                    <th className=\"px-6 py-4 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider\">Ref No</th>\r\n                                    <th className=\"px-6 py-4 text-center text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider\">Bill</th>\r\n                                    <th className=\"px-6 py-4 text-right text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider text-green-600 dark:text-green-400\">Debit (Dr)</th>\r\n                                    <th className=\"px-6 py-4 text-right text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider text-red-600 dark:text-red-400\">Credit (Cr)</th>\r\n                                    <th className=\"px-6 py-4 text-right text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider\">Balance</th>\r\n                                    {!isPublic && <th className=\"px-6 py-4 text-center text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider\">Actions</th>}\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody className=\"divide-y divide-gray-200 dark:divide-gray-700\">\r\n                                {loading ? (\r\n                                    <tr>\r\n                                        <td colSpan=\"6\" className=\"text-center py-8\">Loading ledger...</td>\r\n                                    </tr>\r\n                                ) : ledger.length === 0 ? (\r\n                                    <tr>\r\n                                        <td colSpan=\"6\" className=\"text-center py-8 text-gray-500\">No transactions found</td>\r\n                                    </tr>\r\n                                ) : (\r\n                                    ledger.map((entry) => (\r\n                                        <tr key={entry._id} className=\"hover:bg-amber-500/5 dark:hover:bg-amber-500/10 transition-colors group\">\r\n                                            <td className=\"px-6 py-5 text-xs font-bold text-gray-900 dark:text-gray-100 whitespace-nowrap\">\r\n                                                {formatDate(entry.date)}\r\n                                            </td>\r\n                                            <td className=\"px-6 py-5 text-sm text-gray-900 dark:text-gray-100\">\r\n                                                <div className=\"font-black text-xs uppercase tracking-wide\">{entry.refType}</div>\r\n                                                <div className=\"text-gray-500 dark:text-gray-400 text-[10px] font-medium mt-0.5\">{entry.description}</div>\r\n                                            </td>\r\n                                            <td className=\"px-6 py-4 text-sm text-gray-500 dark:text-gray-400 font-mono\">\r\n                                                {entry.refNo || '-'}\r\n                                            </td>\r\n                                            <td className=\"px-6 py-4 text-sm text-center\">\r\n                                                {entry.billAttachment ? (\r\n                                                    <a\r\n                                                        href={`${api.defaults.baseURL}${entry.billAttachment}`}\r\n                                                        target=\"_blank\"\r\n                                                        rel=\"noopener noreferrer\"\r\n                                                        className=\"inline-flex items-center justify-center p-1.5 bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 rounded-lg hover:bg-blue-100 dark:hover:bg-blue-900/50 transition-colors\"\r\n                                                        title=\"View Attachment\"\r\n                                                    >\r\n                                                        <Paperclip className=\"w-4 h-4\" />\r\n                                                    </a>\r\n                                                ) : (\r\n                                                    <span className=\"text-gray-300 dark:text-gray-600\">-</span>\r\n                                                )}\r\n                                            </td>\r\n                                            <td className=\"px-6 py-4 text-sm text-right font-medium text-green-600 dark:text-green-400\">\r\n                                                {entry.debit > 0 ? formatINR(entry.debit) : '-'}\r\n                                            </td>\r\n                                            <td className=\"px-6 py-4 text-sm text-right font-medium text-red-600 dark:text-red-400\">\r\n                                                {entry.credit > 0 ? formatINR(entry.credit) : '-'}\r\n                                            </td>\r\n                                            <td className=\"px-6 py-5 text-sm text-right font-black text-gray-900 dark:text-white rupee bg-gray-50/50 dark:bg-white/5 rounded-lg m-1\">\r\n                                                {formatINR(entry.balance)}\r\n                                            </td>\r\n                                            {!isPublic && (\r\n                                                <td className=\"px-6 py-4 text-sm text-center\">\r\n                                                    <button\r\n                                                        onClick={() => handleEditClick(entry)}\r\n                                                        className=\"p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-full transition-colors text-gray-500 hover:text-blue-600\"\r\n                                                        title=\"Edit Entry\"\r\n                                                    >\r\n                                                        <Edit2 className=\"w-4 h-4\" />\r\n                                                    </button>\r\n                                                    <button\r\n                                                        onClick={() => handleDeleteClick(entry)}\r\n                                                        className=\"p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-full transition-colors text-red-500 hover:text-red-700 ml-1\"\r\n                                                        title=\"Delete Entry\"\r\n                                                    >\r\n                                                        <Trash2 className=\"w-4 h-4\" />\r\n                                                    </button>\r\n                                                </td>\r\n                                            )}\r\n                                        </tr>\r\n                                    ))\r\n                                )}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                </div>\r\n            </div> {/* End of ledger-content */}\r\n\r\n            {/* Payment Recording Modal */}\r\n            {\r\n                showPaymentModal && (\r\n                    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 backdrop-blur-sm\">\r\n                        <div className=\"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full p-6 shadow-2xl transition-colors\">\r\n                            <h3 className=\"text-xl font-bold text-gray-900 dark:text-white mb-4 border-b-[2.5px] border-black dark:border-white/90 pb-2\">Record Payment to Supplier</h3>\r\n\r\n                            <div className=\"space-y-4\">\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                                        Date *\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"date\"\r\n                                        value={payment.date}\r\n                                        onChange={(e) => setPayment({ ...payment, date: e.target.value })}\r\n                                        className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors\"\r\n                                    />\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                                        Amount *\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        value={payment.amount}\r\n                                        onChange={(e) => setPayment({ ...payment, amount: e.target.value })}\r\n                                        className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors\"\r\n                                        placeholder=\"Enter amount paid\"\r\n                                        min=\"0\"\r\n                                        step=\"0.01\"\r\n                                    />\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                                        Payment Method *\r\n                                    </label>\r\n                                    <select\r\n                                        value={payment.method}\r\n                                        onChange={(e) => setPayment({ ...payment, method: e.target.value })}\r\n                                        className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors\"\r\n                                    >\r\n                                        <option value=\"Cash\">Cash</option>\r\n                                        <option value=\"Credit\">Credit</option>\r\n                                        <option value=\"UPI\">UPI</option>\r\n                                        <option value=\"Card\">Card</option>\r\n                                        <option value=\"Bank Transfer\">Bank Transfer</option>\r\n                                        <option value=\"Cheque\">Cheque</option>\r\n                                    </select>\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                                        Notes (Optional)\r\n                                    </label>\r\n                                    <textarea\r\n                                        value={payment.notes}\r\n                                        onChange={(e) => setPayment({ ...payment, notes: e.target.value })}\r\n                                        className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors\"\r\n                                        rows=\"3\"\r\n                                        placeholder=\"e.g., Payment for Bill #123\"\r\n                                    ></textarea>\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                                        Bill Attachment (Optional)\r\n                                    </label>\r\n                                    <label className=\"flex flex-col items-center justify-center w-full h-32 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors\">\r\n                                        <div className=\"flex flex-col items-center justify-center pt-5 pb-6\">\r\n                                            <Paperclip className=\"w-8 h-8 text-gray-400 mb-2\" />\r\n                                            <p className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                                                {payment.billFile ? payment.billFile.name : 'Click to upload bill image/PDF'}\r\n                                            </p>\r\n                                        </div>\r\n                                        <input\r\n                                            type=\"file\"\r\n                                            className=\"hidden\"\r\n                                            accept=\"image/*,.pdf\"\r\n                                            onChange={(e) => setPayment({ ...payment, billFile: e.target.files[0] })}\r\n                                        />\r\n                                    </label>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"flex justify-end space-x-3 mt-6 pt-4 border-t-[2.5px] border-black dark:border-white/90\">\r\n                                <button\r\n                                    onClick={() => setShowPaymentModal(false)}\r\n                                    className=\"px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors\"\r\n                                >\r\n                                    Cancel\r\n                                </button>\r\n                                <button\r\n                                    onClick={handleRecordPayment}\r\n                                    className=\"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium\"\r\n                                >\r\n                                    Record Payment\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )\r\n            }\r\n\r\n            {/* Purchase Recording Modal */}\r\n            {\r\n                showPurchaseModal && (\r\n                    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 backdrop-blur-sm\">\r\n                        <div className=\"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full p-6 shadow-2xl transition-colors\">\r\n                            <h3 className=\"text-xl font-bold text-gray-900 dark:text-white mb-4 border-b-[2.5px] border-black dark:border-white/90 pb-2\">Record Purchase</h3>\r\n\r\n                            <div className=\"space-y-4\">\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                                        Date *\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"date\"\r\n                                        value={purchase.date}\r\n                                        onChange={(e) => setPurchase({ ...purchase, date: e.target.value })}\r\n                                        className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors\"\r\n                                    />\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                                        Amount *\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        value={purchase.amount}\r\n                                        onChange={(e) => setPurchase({ ...purchase, amount: e.target.value })}\r\n                                        className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors\"\r\n                                        placeholder=\"Enter purchase amount\"\r\n                                        min=\"0\"\r\n                                        step=\"0.01\"\r\n                                    />\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                                        Bill Number (Optional)\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={purchase.billNo}\r\n                                        onChange={(e) => setPurchase({ ...purchase, billNo: e.target.value })}\r\n                                        className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors\"\r\n                                        placeholder=\"e.g., BILL-123\"\r\n                                    />\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                                        Notes (Optional)\r\n                                    </label>\r\n                                    <textarea\r\n                                        value={purchase.notes}\r\n                                        onChange={(e) => setPurchase({ ...purchase, notes: e.target.value })}\r\n                                        className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors\"\r\n                                        rows=\"3\"\r\n                                        placeholder=\"e.g., 10 boxes of LED bulbs\"\r\n                                    ></textarea>\r\n                                    <div>\r\n                                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                                            Bill Attachment (Optional)\r\n                                        </label>\r\n                                        {!purchase.billFile ? (\r\n                                            <>\r\n                                                <input\r\n                                                    type=\"file\"\r\n                                                    accept=\"image/*,.pdf\"\r\n                                                    onChange={(e) => setPurchase({ ...purchase, billFile: e.target.files[0] })}\r\n                                                    className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 bg-white dark:bg-gray-700 transition-colors\"\r\n                                                />\r\n                                                <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">Upload bill image or PDF (max 5MB)</p>\r\n                                            </>\r\n                                        ) : (\r\n                                            <div className=\"flex items-center justify-between p-2 border border-orange-200 bg-orange-50 rounded-lg\">\r\n                                                <div className=\"flex items-center space-x-2 overflow-hidden\">\r\n                                                    <span className=\"text-sm font-medium text-orange-800\">File selected:</span>\r\n                                                    <span className=\"text-sm text-gray-700 truncate\">{purchase.billFile.name}</span>\r\n                                                </div>\r\n                                                <button\r\n                                                    type=\"button\"\r\n                                                    onClick={() => setPurchase({ ...purchase, billFile: null })}\r\n                                                    className=\"text-red-500 hover:bg-red-50 p-1 rounded-full transition-colors\"\r\n                                                    title=\"Remove File\"\r\n                                                >\r\n                                                    <X className=\"w-5 h-5\" />\r\n                                                </button>\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"flex justify-end space-x-3 mt-6\">\r\n                                <button\r\n                                    onClick={() => setShowPurchaseModal(false)}\r\n                                    className=\"px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors\"\r\n                                >\r\n                                    Cancel\r\n                                </button>\r\n                                <button\r\n                                    onClick={handleRecordPurchase}\r\n                                    className=\"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 font-medium\"\r\n                                >\r\n                                    Record Purchase\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )\r\n            }\r\n\r\n\r\n            {/* Edit Entry Modal */}\r\n            {\r\n                showEditModal && editingEntry && (\r\n                    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 backdrop-blur-sm\">\r\n                        <div className=\"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full p-6 shadow-2xl transition-colors\">\r\n                            <h3 className=\"text-xl font-bold text-gray-900 dark:text-white mb-4\">Edit Ledger Entry</h3>\r\n\r\n                            <form onSubmit={handleUpdateEntry} className=\"space-y-4\">\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Date</label>\r\n                                    <input\r\n                                        type=\"date\"\r\n                                        value={editingEntry.date ? new Date(editingEntry.date).toLocaleDateString('en-CA') : ''}\r\n                                        onChange={(e) => setEditingEntry({ ...editingEntry, date: e.target.value })}\r\n                                        className=\"w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n                                        required\r\n                                    />\r\n                                </div>\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Description</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={editingEntry.description || ''}\r\n                                        onChange={(e) => setEditingEntry({ ...editingEntry, description: e.target.value })}\r\n                                        className=\"w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n                                        required\r\n                                    />\r\n                                </div>\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Reference No</label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={editingEntry.refNo || ''}\r\n                                        onChange={(e) => setEditingEntry({ ...editingEntry, refNo: e.target.value })}\r\n                                        className=\"w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n                                    />\r\n                                </div>\r\n                                <div className=\"grid grid-cols-2 gap-4\">\r\n                                    <div>\r\n                                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 text-green-600\">Debit</label>\r\n                                        <input\r\n                                            type=\"number\"\r\n                                            step=\"0.01\"\r\n                                            value={editingEntry.debit || 0}\r\n                                            onChange={(e) => setEditingEntry({ ...editingEntry, debit: parseFloat(e.target.value) || 0 })}\r\n                                            className=\"w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n                                        />\r\n                                    </div>\r\n                                    <div>\r\n                                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 text-red-600\">Credit</label>\r\n                                        <input\r\n                                            type=\"number\"\r\n                                            step=\"0.01\"\r\n                                            value={editingEntry.credit || 0}\r\n                                            onChange={(e) => setEditingEntry({ ...editingEntry, credit: parseFloat(e.target.value) || 0 })}\r\n                                            className=\"w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"flex\">\r\n                                    <div className=\"w-full\">\r\n                                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Bill Attachment</label>\r\n                                        {!editingEntry.billFile && !editingEntry.billAttachment ? (\r\n                                            <input\r\n                                                type=\"file\"\r\n                                                accept=\"image/*,.pdf\"\r\n                                                onChange={(e) => setEditingEntry({ ...editingEntry, billFile: e.target.files[0] })}\r\n                                                className=\"w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm\"\r\n                                            />\r\n                                        ) : (\r\n                                            <div className=\"flex items-center justify-between p-2 border border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-700/50 rounded-lg\">\r\n                                                <div className=\"flex items-center space-x-2 overflow-hidden\">\r\n                                                    <Paperclip className=\"w-4 h-4 text-gray-500\" />\r\n                                                    <span className=\"text-sm text-gray-700 dark:text-gray-300 truncate\">\r\n                                                        {editingEntry.billFile ? editingEntry.billFile.name : 'Existing Attachment'}\r\n                                                    </span>\r\n                                                    {!editingEntry.billFile && editingEntry.billAttachment && !editingEntry.deleteAttachment && (\r\n                                                        <a href={`${api.defaults.baseURL}${editingEntry.billAttachment}`} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-xs text-blue-600 hover:underline\">\r\n                                                            (View)\r\n                                                        </a>\r\n                                                    )}\r\n                                                </div>\r\n                                                <div className=\"flex items-center\">\r\n                                                    {editingEntry.deleteAttachment ? (\r\n                                                        <span className=\"text-xs text-red-500 font-medium mr-2\">Deleted</span>\r\n                                                    ) : null}\r\n                                                    <button\r\n                                                        type=\"button\"\r\n                                                        onClick={() => {\r\n                                                            if (editingEntry.billFile) {\r\n                                                                setEditingEntry({ ...editingEntry, billFile: null });\r\n                                                            } else {\r\n                                                                // Toggle deletion for existing\r\n                                                                if (editingEntry.deleteAttachment) {\r\n                                                                    setEditingEntry({ ...editingEntry, deleteAttachment: false });\r\n                                                                } else {\r\n                                                                    setEditingEntry({ ...editingEntry, deleteAttachment: true });\r\n                                                                }\r\n                                                            }\r\n                                                        }}\r\n                                                        className=\"text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 p-1 rounded-full transition-colors\"\r\n                                                        title=\"Remove/Delete File\"\r\n                                                    >\r\n                                                        <X className=\"w-4 h-4\" />\r\n                                                    </button>\r\n                                                </div>\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n\r\n\r\n                                <div className=\"flex justify-end space-x-3 mt-6\">\r\n                                    <button\r\n                                        type=\"button\"\r\n                                        onClick={() => {\r\n                                            setShowEditModal(false);\r\n                                            setEditingEntry(null);\r\n                                        }}\r\n                                        className=\"px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors\"\r\n                                    >\r\n                                        Cancel\r\n                                    </button>\r\n                                    <button\r\n                                        type=\"submit\"\r\n                                        className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium\"\r\n                                    >\r\n                                        Update Entry\r\n                                    </button>\r\n                                </div>\r\n                            </form>\r\n                        </div >\r\n                    </div >\r\n                )\r\n            }\r\n\r\n\r\n            <ConfirmationModal\r\n                isOpen={showDeleteModal}\r\n                onClose={() => {\r\n                    setShowDeleteModal(false);\r\n                    setEntryToDelete(null);\r\n                }}\r\n                onConfirm={confirmDelete}\r\n                title=\"Delete Ledger Entry\"\r\n                message=\"Are you sure you want to delete this transaction? This action cannot be undone and will affect the supplier balance.\"\r\n                confirmText=\"Delete Entry\"\r\n                isDangerous={true}\r\n            />\r\n        </Layout >\r\n    );\r\n};\r\n\r\nexport default SupplierLedger;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\pages\\Suppliers.jsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n  52 |             return;\n  53 |         }\n> 54 |         loadSuppliers();\n     |         ^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  55 |     }, [isAdmin, navigate, loadSuppliers]);\n  56 |\n  57 |     useEffect(() => {","line":54,"column":9,"nodeType":null,"endLine":54,"endColumn":22},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n  62 |                 s.email?.toLowerCase().includes(searchQuery.toLowerCase())\n  63 |             );\n> 64 |             setFilteredSuppliers(filtered);\n     |             ^^^^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  65 |         } else {\n  66 |             setFilteredSuppliers(suppliers);\n  67 |         }","line":64,"column":13,"nodeType":null,"endLine":64,"endColumn":33},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":85,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":85,"endColumn":23}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport ConfirmationModal from '../components/ConfirmationModal';\r\nimport Layout from '../components/Layout/Layout';\r\nimport api from '../utils/api';\r\nimport { formatINR } from '../utils/currency';\r\nimport {\r\n    TruckIcon,\r\n    Search,\r\n    Plus,\r\n    Edit2,\r\n    Trash2,\r\n    X,\r\n    Phone,\r\n    Mail,\r\n    IndianRupee,\r\n    BookOpen\r\n} from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst Suppliers = () => {\r\n    const navigate = useNavigate();\r\n    const { isAdmin } = useAuth();\r\n    const [suppliers, setSuppliers] = useState([]);\r\n    const [filteredSuppliers, setFilteredSuppliers] = useState([]);\r\n    const [searchQuery, setSearchQuery] = useState('');\r\n    const [loading, setLoading] = useState(true);\r\n    const [showModal, setShowModal] = useState(false);\r\n    const [editingSupplier, setEditingSupplier] = useState(null);\r\n    const [showDeleteModal, setShowDeleteModal] = useState(false);\r\n    const [supplierToDelete, setSupplierToDelete] = useState(null);\r\n\r\n    const loadSuppliers = useCallback(async () => {\r\n        try {\r\n            setLoading(true);\r\n            const { data } = await api.get('/suppliers');\r\n            setSuppliers(data);\r\n            setFilteredSuppliers(data);\r\n            setLoading(false);\r\n        } catch (error) {\r\n            console.error('Failed to load suppliers:', error);\r\n            toast.error('Failed to load suppliers');\r\n            setLoading(false);\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (!isAdmin()) {\r\n            navigate('/dashboard');\r\n            toast.error('Access denied. Admin only.');\r\n            return;\r\n        }\r\n        loadSuppliers();\r\n    }, [isAdmin, navigate, loadSuppliers]);\r\n\r\n    useEffect(() => {\r\n        if (searchQuery) {\r\n            const filtered = suppliers.filter(s =>\r\n                s.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n                s.phone.includes(searchQuery) ||\r\n                s.email?.toLowerCase().includes(searchQuery.toLowerCase())\r\n            );\r\n            setFilteredSuppliers(filtered);\r\n        } else {\r\n            setFilteredSuppliers(suppliers);\r\n        }\r\n    }, [searchQuery, suppliers]);\r\n\r\n\r\n\r\n    const handleDeleteClick = (supplier) => {\r\n        setSupplierToDelete(supplier);\r\n        setShowDeleteModal(true);\r\n    };\r\n\r\n    const confirmDelete = async () => {\r\n        if (!supplierToDelete) return;\r\n\r\n        try {\r\n            await api.delete(`/suppliers/${supplierToDelete._id}`);\r\n            toast.success('Supplier deleted successfully');\r\n            loadSuppliers();\r\n            setSupplierToDelete(null);\r\n        } catch (error) {\r\n            toast.error('Failed to delete supplier');\r\n        }\r\n    };\r\n\r\n    const handleEdit = (supplier) => {\r\n        setEditingSupplier(supplier);\r\n        setShowModal(true);\r\n    };\r\n\r\n    const handleAdd = () => {\r\n        setEditingSupplier(null);\r\n        setShowModal(true);\r\n    };\r\n\r\n    return (\r\n        <Layout>\r\n            <div className=\"p-4 md:p-8 min-h-screen bg-gray-50/50 dark:bg-[#050505] transition-colors duration-500\">\r\n                {/* Header Section */}\r\n                <div className=\"mb-10 relative\">\r\n                    <div className=\"absolute -top-24 -left-24 w-96 h-96 bg-amber-500/10 blur-[120px] rounded-full pointer-events-none\"></div>\r\n                    <div className=\"flex flex-col md:flex-row md:items-end justify-between gap-6 relative z-10\">\r\n                        <div>\r\n                            <div className=\"flex items-center space-x-3 mb-2\">\r\n                                <div className=\"p-2 bg-amber-500/10 rounded-lg\">\r\n                                    <TruckIcon className=\"w-5 h-5 text-amber-500\" />\r\n                                </div>\r\n                                <span className=\"text-amber-600 dark:text-amber-400 text-xs font-black uppercase tracking-[0.3em]\">Supply Network</span>\r\n                            </div>\r\n                            <h1 className=\"text-4xl md:text-5xl font-black text-gray-900 dark:text-white tracking-tight\">\r\n                                <span className=\"text-transparent bg-clip-text bg-gradient-to-r from-amber-600 to-orange-500\">Suppliers</span>\r\n                            </h1>\r\n                            <p className=\"text-gray-500 dark:text-gray-400 mt-2 font-medium max-w-md\">\r\n                                Manage supplier information and payments\r\n                            </p>\r\n                        </div>\r\n                        <button\r\n                            onClick={handleAdd}\r\n                            className=\"flex items-center space-x-2 px-8 py-4 bg-amber-600 hover:bg-amber-500 text-white rounded-2xl shadow-[0_20px_40px_rgba(217,119,6,0.2)] hover:shadow-[0_25px_50px_rgba(217,119,6,0.3)] transition-all duration-300 transform hover:-translate-y-1 group\"\r\n                        >\r\n                            <Plus className=\"w-6 h-6 group-hover:rotate-90 transition-transform duration-500\" />\r\n                            <span className=\"font-black tracking-tight text-lg\">Add Supplier</span>\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Logistics Search Array */}\r\n                <div className=\"mb-8 relative z-10 max-w-4xl mx-auto\">\r\n                    <div className=\"bg-white dark:bg-[#0a0a0a] p-2 rounded-2xl border border-amber-500/30 shadow-[0_4px_20px_-8px_rgba(245,158,11,0.3)] transition-all duration-300\">\r\n                        <div className=\"flex items-center px-4\">\r\n                            <Search className=\"w-5 h-5 text-gray-400\" />\r\n                            <input\r\n                                type=\"text\"\r\n                                value={searchQuery}\r\n                                onChange={(e) => setSearchQuery(e.target.value)}\r\n                                placeholder=\"Search by channel name, contact, or logistics ID...\"\r\n                                className=\"w-full pl-4 pr-4 py-3 bg-transparent border-none text-gray-900 dark:text-white placeholder-gray-400 focus:ring-0 text-sm font-medium\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Acquisition Grid */}\r\n                {loading ? (\r\n                    <div className=\"bg-white/50 dark:bg-black/20 backdrop-blur-xl rounded-[32px] border border-white dark:border-white/5 p-20 text-center\">\r\n                        <div className=\"relative inline-block\">\r\n                            <div className=\"w-16 h-16 border-t-2 border-amber-500 rounded-full animate-spin mx-auto\"></div>\r\n                            <div className=\"absolute inset-0 bg-amber-500/20 blur-xl rounded-full\"></div>\r\n                        </div>\r\n                        <p className=\"mt-4 text-amber-600 dark:text-amber-400 font-bold tracking-widest uppercase text-xs animate-pulse font-mono\">Loading Channels...</p>\r\n                    </div>\r\n                ) : filteredSuppliers.length === 0 ? (\r\n                    <div className=\"bg-white/50 dark:bg-black/20 backdrop-blur-xl rounded-[32px] border border-white dark:border-white/5 p-20 text-center group\">\r\n                        <div className=\"relative inline-block mb-6\">\r\n                            <div className=\"absolute inset-0 bg-amber-500/10 blur-3xl rounded-full group-hover:bg-amber-500/20 transition-all duration-700\"></div>\r\n                            <TruckIcon className=\"w-20 h-20 text-amber-500/20 group-hover:text-amber-500/40 transition-all duration-500 relative z-10 mx-auto\" strokeWidth={1} />\r\n                        </div>\r\n                        <h3 className=\"text-2xl font-black text-gray-900 dark:text-white tracking-tight\">Channels Isolated</h3>\r\n                        <p className=\"text-gray-500 dark:text-gray-400 mt-2 font-medium\">No procurement sources detected in the current sector.</p>\r\n                        <button onClick={handleAdd} className=\"mt-8 px-8 py-3 bg-amber-500/10 text-amber-600 dark:text-amber-400 border border-amber-500/20 rounded-xl hover:bg-amber-500 hover:text-white transition-all duration-300 font-bold uppercase tracking-widest text-xs\">\r\n                            Add Supplier\r\n                        </button>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 relative z-10\">\r\n                        {filteredSuppliers.map((supplier) => (\r\n                            <div\r\n                                key={supplier._id}\r\n                                className=\"bg-[#FFFDF5] dark:bg-[#0a0a0a] rounded-[32px] border-[1.5px] border-amber-400/40 p-6 shadow-sm hover:shadow-[0_8px_30px_-10px_rgba(245,158,11,0.2)] transition-all duration-300 group\"\r\n                            >\r\n                                {/* Header Pill */}\r\n                                <div className=\"border border-black/80 dark:border-white/80 rounded-full p-2 flex items-center gap-4 mb-4 bg-white dark:bg-black/40\">\r\n                                    <div className=\"relative\">\r\n                                        <div className=\"w-10 h-10 rounded-full bg-orange-100 dark:bg-orange-500/20 flex items-center justify-center text-orange-600 dark:text-orange-400 font-bold text-lg border border-orange-200 dark:border-orange-500/30\">\r\n                                            {supplier.name.charAt(0).toUpperCase()}\r\n                                        </div>\r\n                                        <div className=\"absolute -top-0.5 -right-0.5 w-3 h-3 bg-orange-500 rounded-full border-2 border-white dark:border-black\"></div>\r\n                                    </div>\r\n                                    <div className=\"flex flex-col\">\r\n                                        <span className=\"text-base font-bold text-gray-900 dark:text-white leading-tight\">\r\n                                            {supplier.name}\r\n                                        </span>\r\n                                        <span className=\"text-[9px] font-bold text-gray-400 dark:text-gray-500 uppercase tracking-widest\">\r\n                                            Source Code: {supplier._id.slice(-6).toUpperCase()}\r\n                                        </span>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Contact Pill */}\r\n                                <div className=\"border border-black/80 dark:border-white/80 rounded-full px-5 py-3 mb-6 bg-white dark:bg-black/40 flex items-center gap-3\">\r\n                                    <div className=\"w-6 h-6 rounded-md bg-amber-500/10 flex items-center justify-center\">\r\n                                        <Phone className=\"w-3.5 h-3.5 text-amber-600 dark:text-amber-400\" />\r\n                                    </div>\r\n                                    <span className=\"text-sm font-bold text-gray-700 dark:text-gray-300 tracking-wide\">\r\n                                        +91 {supplier.phone}\r\n                                    </span>\r\n                                </div>\r\n\r\n                                {/* Liability/Actions Container */}\r\n                                <div className=\"border border-black/80 dark:border-white/80 rounded-2xl p-4 bg-gray-50/50 dark:bg-white/5 relative overflow-hidden\">\r\n                                    {/* Background/Texture could go here */}\r\n\r\n                                    <div className=\"flex justify-between items-start mb-1\">\r\n                                        <span className=\"text-[10px] font-black text-gray-400 dark:text-gray-500 uppercase tracking-widest\">Liability Index</span>\r\n                                        <IndianRupee className=\"w-3 h-3 text-gray-300\" />\r\n                                    </div>\r\n\r\n                                    <div className={`text-xl font-bold font-mono tracking-tighter mb-3 ${supplier.balance > 0 ? 'text-emerald-600 dark:text-emerald-400' : supplier.balance < 0 ? 'text-red-600 dark:text-red-400' : 'text-gray-900 dark:text-white'}`}>\r\n                                        {formatINR(Math.abs(supplier.balance))}\r\n                                    </div>\r\n\r\n                                    <div className=\"flex items-center space-x-2 mb-2\">\r\n                                        <div className=\"h-1 flex-1 bg-gray-200 dark:bg-white/10 rounded-full overflow-hidden\">\r\n                                            <div\r\n                                                className={`h-full rounded-full transition-all duration-1000 ${supplier.balance > 0 ? 'bg-emerald-500' : supplier.balance < 0 ? 'bg-red-500' : 'bg-gray-400'}`}\r\n                                                style={{ width: supplier.balance === 0 ? '0%' : '65%' }}\r\n                                            ></div>\r\n                                        </div>\r\n                                        <span className={`text-[9px] font-bold ${supplier.balance > 0 ? 'text-emerald-500' : supplier.balance < 0 ? 'text-red-500' : 'text-gray-400'} uppercase`}>\r\n                                            {supplier.balance > 0 ? 'PAY' : supplier.balance < 0 ? 'REC' : 'NIL'}\r\n                                        </span>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Hover Actions (Absolute positioned or appearing below) - Keeping cleaner for this design, \r\n                                    let's make the whole card clickable or add specific icon buttons in a subtle way \r\n                                    Actually, the user asked for this specific card look. I'll add the actions as a row below the box but minimal.\r\n                                */}\r\n                                <div className=\"flex items-center justify-end space-x-2 mt-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300\">\r\n                                    <button\r\n                                        onClick={() => navigate(`/suppliers/${supplier._id}/ledger`)}\r\n                                        className=\"p-2 text-gray-400 hover:text-indigo-500 transition-colors\"\r\n                                        title=\"Ledger\"\r\n                                    >\r\n                                        <BookOpen className=\"w-4 h-4\" />\r\n                                    </button>\r\n                                    <button\r\n                                        onClick={() => handleEdit(supplier)}\r\n                                        className=\"p-2 text-gray-400 hover:text-amber-500 transition-colors\"\r\n                                        title=\"Edit\"\r\n                                    >\r\n                                        <Edit2 className=\"w-4 h-4\" />\r\n                                    </button>\r\n                                    <button\r\n                                        onClick={() => handleDeleteClick(supplier)}\r\n                                        className=\"p-2 text-gray-400 hover:text-red-500 transition-colors\"\r\n                                        title=\"Delete\"\r\n                                    >\r\n                                        <Trash2 className=\"w-4 h-4\" />\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Add/Edit Supplier Modal */}\r\n            {showModal && (\r\n                <SupplierModal\r\n                    supplier={editingSupplier}\r\n                    onClose={() => {\r\n                        setShowModal(false);\r\n                        setEditingSupplier(null);\r\n                    }}\r\n                    onSuccess={() => {\r\n                        setShowModal(false);\r\n                        setEditingSupplier(null);\r\n                        loadSuppliers();\r\n                    }}\r\n                />\r\n            )}\r\n\r\n            <ConfirmationModal\r\n                isOpen={showDeleteModal}\r\n                onClose={() => {\r\n                    setShowDeleteModal(false);\r\n                    setSupplierToDelete(null);\r\n                }}\r\n                onConfirm={confirmDelete}\r\n                title=\"Delete Supplier\"\r\n                message={`Are you sure you want to delete \"${supplierToDelete?.name}\"? This action cannot be undone.`}\r\n                confirmText=\"Delete Supplier\"\r\n                isDangerous={true}\r\n            />\r\n        </Layout>\r\n    );\r\n};\r\n\r\n// Supplier Modal Component\r\nconst SupplierModal = ({ supplier, onClose, onSuccess }) => {\r\n    const [formData, setFormData] = useState({\r\n        name: supplier?.name || '',\r\n        phone: supplier?.phone || '',\r\n        email: supplier?.email || '',\r\n        address: supplier?.address || '',\r\n        gstNumber: supplier?.gstNumber || '',\r\n    });\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        setLoading(true);\r\n\r\n        try {\r\n            if (supplier) {\r\n                await api.put(`/suppliers/${supplier._id}`, formData);\r\n                toast.success('Supplier updated successfully');\r\n            } else {\r\n                await api.post('/suppliers', formData);\r\n                toast.success('Supplier added successfully');\r\n            }\r\n            onSuccess();\r\n        } catch (error) {\r\n            toast.error(error.response?.data?.message || 'Failed to save supplier');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 backdrop-blur-sm\">\r\n            <div className=\"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full border border-gray-100 dark:border-gray-700\">\r\n                <div className=\"p-6 border-b-[2.5px] border-black dark:border-white/90 flex items-center justify-between\">\r\n                    <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\r\n                        {supplier ? 'Edit Supplier' : 'Add New Supplier'}\r\n                    </h2>\r\n                    <button\r\n                        onClick={onClose}\r\n                        className=\"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors text-gray-500 dark:text-gray-400\"\r\n                    >\r\n                        <X className=\"w-6 h-6\" />\r\n                    </button>\r\n                </div>\r\n\r\n                <form onSubmit={handleSubmit} className=\"p-6 space-y-4\">\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                            Supplier Name *\r\n                        </label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={formData.name}\r\n                            onChange={(e) => setFormData({ ...formData, name: e.target.value })}\r\n                            className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400\"\r\n                            required\r\n                        />\r\n                    </div>\r\n\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                            Phone *\r\n                        </label>\r\n                        <input\r\n                            type=\"tel\"\r\n                            value={formData.phone}\r\n                            onChange={(e) => setFormData({ ...formData, phone: e.target.value })}\r\n                            className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400\"\r\n                            required\r\n                        />\r\n                    </div>\r\n\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                            Email\r\n                        </label>\r\n                        <input\r\n                            type=\"email\"\r\n                            value={formData.email}\r\n                            onChange={(e) => setFormData({ ...formData, email: e.target.value })}\r\n                            className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400\"\r\n                        />\r\n                    </div>\r\n\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                            Address\r\n                        </label>\r\n                        <textarea\r\n                            value={formData.address}\r\n                            onChange={(e) => setFormData({ ...formData, address: e.target.value })}\r\n                            className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400\"\r\n                            rows={3}\r\n                        />\r\n                    </div>\r\n\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                            GSTIN (Optional)\r\n                        </label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={formData.gstNumber}\r\n                            onChange={(e) => setFormData({ ...formData, gstNumber: e.target.value })}\r\n                            className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400\"\r\n                            placeholder=\"22AAAAA0000A1Z5\"\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center justify-end space-x-3 pt-4 border-t-[2.5px] border-black dark:border-white/90\">\r\n                        <button\r\n                            type=\"button\"\r\n                            onClick={onClose}\r\n                            className=\"px-6 py-2 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-gray-700 dark:text-gray-300\"\r\n                        >\r\n                            Cancel\r\n                        </button>\r\n                        <button\r\n                            type=\"submit\"\r\n                            disabled={loading}\r\n                            className=\"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50\"\r\n                        >\r\n                            {loading ? 'Saving...' : supplier ? 'Update Supplier' : 'Add Supplier'}\r\n                        </button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Suppliers;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\utils\\api.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\utils\\currency.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\utils\\date.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\utils\\debounce.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\utils\\gstCalculator.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\utils\\pdfShare.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\src\\utils\\whatsapp.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\tailwind.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Software\\Create\\Shop\\frontend\\vite.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]